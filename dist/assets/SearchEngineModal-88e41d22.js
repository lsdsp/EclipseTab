import{m as U,j as o,M as E,G}from"./main-9239952f.js";import{r as n}from"./vendor-react-3d7076e0.js";import{n as S,i as $}from"./url-4932f2a9.js";import"./vendor-utils-654bd828.js";const g="_list_zjoau_3",L="_optionsContainer_zjoau_17",M="_emptyHint_zjoau_24",R="_optionRow_zjoau_34",F="_option_zjoau_17",H="_selected_zjoau_85",B="_engineName_zjoau_97",K="_deleteButton_zjoau_101",T="_customToggle_zjoau_123",A="_customForm_zjoau_128",P="_formGroup_zjoau_136",q="_formLabel_zjoau_142",V="_formInput_zjoau_151",J="_customSubmit_zjoau_167",e={list:g,optionsContainer:L,emptyHint:M,optionRow:R,option:F,selected:H,engineName:B,deleteButton:K,customToggle:T,customForm:A,formGroup:P,formLabel:q,formInput:V,customSubmit:J},Y=({isOpen:c,isEditMode:w,selectedEngine:i,engines:s,onClose:l,onSelect:N,onAddCustomEngine:b,onDeleteEngine:y,anchorRect:z})=>{const{t:r}=U(),[f,m]=n.useState(()=>{const t=s.findIndex(a=>a.id===i.id);return t>=0?t:s.length>0?0:-1}),[k,h]=n.useState(!1),[u,_]=n.useState(""),[d,j]=n.useState(""),C=n.useRef(null);n.useEffect(()=>{if(!c)return;const t=s.findIndex(a=>a.id===i.id);m(t>=0?t:s.length>0?0:-1),h(!1),_(""),j("")},[c,s,i]);const x=n.useCallback(t=>{N(t),l()},[N,l]),I=n.useCallback(t=>{if(c){if(s.length===0){t.key==="Escape"&&l();return}if(t.key==="ArrowDown")t.preventDefault(),m(a=>Math.min(s.length-1,a+1));else if(t.key==="ArrowUp")t.preventDefault(),m(a=>Math.max(0,a-1));else if(t.key==="Enter"){t.preventDefault();const a=s[f]??s[0];a&&x(a)}else t.key==="Escape"&&l()}},[f,s,c,x,l]),v=n.useCallback(()=>{const t=u.trim(),a=d.trim();if(!t||!a)return;const p=S(a);if(!$(p)){window.alert(r.search.invalidUrl);return}b({name:t,url:p}),_(""),j(""),h(!1),l()},[u,d,b,l,r.search.invalidUrl]),D=n.useCallback(t=>{const a=r.search.deleteConfirm.replace("{name}",t.name);window.confirm(a)&&y(t.id)},[y,r.search.deleteConfirm]);return o.jsx(E,{isOpen:c,onClose:l,title:void 0,hideHeader:!0,anchorRect:z,offset:12,children:o.jsx("div",{ref:C,className:e.list,role:"listbox","aria-activedescendant":s[f]?.id,tabIndex:0,onKeyDown:I,children:o.jsxs("div",{className:e.optionsContainer,children:[s.length===0&&o.jsx("div",{className:e.emptyHint,children:r.search.noEngine}),s.map((t,a)=>o.jsxs("div",{className:e.optionRow,children:[o.jsx("button",{id:t.id,role:"option","aria-selected":i.id===t.id,className:`${e.option} ${i.id===t.id?e.selected:""}`,style:{transitionDelay:`${a*40}ms`},onMouseEnter:()=>m(a),onClick:()=>x(t),children:o.jsx("span",{className:e.engineName,children:t.name})}),w&&t.id!==G.id&&o.jsx("button",{type:"button",className:e.deleteButton,"aria-label":`${r.contextMenu.delete} ${t.name}`,onClick:p=>{p.stopPropagation(),D(t)},children:"Ã—"})]},t.id)),o.jsx("button",{type:"button",className:`${e.option} ${e.customToggle}`,onClick:()=>h(t=>!t),children:o.jsx("span",{className:e.engineName,children:r.search.custom})}),k&&o.jsxs("div",{className:e.customForm,children:[o.jsxs("div",{className:e.formGroup,children:[o.jsx("label",{className:e.formLabel,children:r.search.customName}),o.jsx("input",{type:"text",className:e.formInput,value:u,onChange:t=>_(t.target.value),onKeyDown:t=>t.stopPropagation()})]}),o.jsxs("div",{className:e.formGroup,children:[o.jsx("label",{className:e.formLabel,children:r.search.customUrl}),o.jsx("input",{type:"text",className:e.formInput,placeholder:"https://example.com/search?q={query}",value:d,onChange:t=>j(t.target.value),onKeyDown:t=>{t.stopPropagation(),t.key==="Enter"&&(t.preventDefault(),v())}})]}),o.jsx("button",{type:"button",className:`${e.option} ${e.customSubmit}`,onClick:v,disabled:!u.trim()||!d.trim(),children:o.jsx("span",{className:e.engineName,children:r.search.addCustom})})]})]})})})};export{Y as SearchEngineModal};
