import{r,a as Ye,R as Ne}from"./vendor-react-d96b9a5d.js";import{k as Fn,w as Bn}from"./vendor-utils-654bd828.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var Dn={exports:{}},xt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wn=r,Gn=Symbol.for("react.element"),Zn=Symbol.for("react.fragment"),Hn=Object.prototype.hasOwnProperty,Vn=Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xn={key:!0,ref:!0,__self:!0,__source:!0};function pn(e,t,n){var s,o={},i=null,c=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(c=t.ref);for(s in t)Hn.call(t,s)&&!Xn.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:Gn,type:e,key:i,ref:c,props:o,_owner:Vn.current}}xt.Fragment=Zn;xt.jsx=pn;xt.jsxs=pn;Dn.exports=xt;var a=Dn.exports,bt={},Bt=Ye;bt.createRoot=Bt.createRoot,bt.hydrateRoot=Bt.hydrateRoot;const qn="modulepreload",Jn=function(e,t){return new URL(e,t).href},Wt={},yt=function(t,n,s){if(!n||n.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=Jn(i,s),i in Wt)return;Wt[i]=!0;const c=i.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(!!s)for(let M=o.length-1;M>=0;M--){const m=o[M];if(m.href===i&&(!c||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${u}`))return;const l=document.createElement("link");if(l.rel=c?"stylesheet":qn,c||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),c)return new Promise((M,m)=>{l.addEventListener("load",M),l.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i})},xn=[{id:"default",name:"系统默认",url:""},{id:"google",name:"Google",url:"https://www.google.com/search?q="},{id:"bing",name:"Bing",url:"https://www.bing.com/search?q="},{id:"baidu",name:"Baidu",url:"https://www.baidu.com/s?wd="},{id:"duckduckgo",name:"DuckDuckGo",url:"https://duckduckgo.com/?q="}],Kn=xn[0];function Lt(e="Main",t=[]){return{id:crypto.randomUUID(),name:e,iconType:"text",apps:t,createdAt:Date.now()}}function Nt(e=[]){const t=Lt("Main",e),n=Lt("Google",er());return{spaces:[t,n],activeSpaceId:t.id,version:1}}function er(){return[{id:crypto.randomUUID(),name:"Gmail",url:"https://mail.google.com",icon:"https://www.google.com/gmail/about/static-2.0/images/logo-gmail.png",type:"app"},{id:crypto.randomUUID(),name:"Drive",url:"https://drive.google.com",icon:"https://ssl.gstatic.com/images/branding/product/2x/drive_2020q4_48dp.png",type:"app"},{id:crypto.randomUUID(),name:"Calendar",url:"https://calendar.google.com",icon:"https://ssl.gstatic.com/calendar/images/dynamiclogo_2020q4/calendar_31_2x.png",type:"app"},{id:crypto.randomUUID(),name:"Maps",url:"https://maps.google.com",icon:"https://www.google.com/images/branding/product/2x/maps_96dp.png",type:"app"},{id:crypto.randomUUID(),name:"YouTube",url:"https://www.youtube.com",icon:"https://www.youtube.com/s/desktop/f506bd45/img/favicon_144x144.png",type:"app"},{id:crypto.randomUUID(),name:"Photos",url:"https://photos.google.com",icon:"https://ssl.gstatic.com/social/photosui/images/logo/favicon_96.png",type:"app"}]}const tr={color:"#1C1C1E",textAlign:"left",fontSize:40},nt=400,ce={DOCK_ITEMS:"EclipseTab_dockItems",SEARCH_ENGINE:"EclipseTab_searchEngine",CONFIG:"EclipseTab_config",WALLPAPER:"EclipseTab_wallpaper",LAST_WALLPAPER:"EclipseTab_lastWallpaper",WALLPAPER_ID:"EclipseTab_wallpaperId",SPACES:"EclipseTab_spaces",STICKERS:"EclipseTab_stickers"},jt={theme:"light",followSystem:!0,dockPosition:"bottom",iconSize:"large",texture:"point",gradient:null},Se={spaces:null,stickers:null,config:null};function Tt(e,t){if(!t)return null;try{if(localStorage.getItem(e)===t.raw)return t.data}catch{}return null}const ie={getConfig(){try{const e=Tt(ce.CONFIG,Se.config);if(e)return e;const t=localStorage.getItem(ce.CONFIG);if(t){const M=JSON.parse(t),m={...jt,...M};return Se.config={data:m,raw:t},m}const n={...jt},s=localStorage.getItem("EclipseTab_theme");s&&(n.theme=s);const o=localStorage.getItem("EclipseTab_followSystem");o!==null&&(n.followSystem=o==="true");const i=localStorage.getItem("EclipseTab_dockPosition");(i==="center"||i==="bottom")&&(n.dockPosition=i);const c=localStorage.getItem("EclipseTab_iconSize");(c==="small"||c==="large")&&(n.iconSize=c);const u=localStorage.getItem("EclipseTab_texture");u&&(n.texture=u);const I=localStorage.getItem("EclipseTab_gradient");I&&(n.gradient=I);const l=JSON.stringify(n);return localStorage.setItem(ce.CONFIG,l),Se.config={data:n,raw:l},n}catch{return jt}},saveConfig(e){try{const t=JSON.stringify(e);localStorage.setItem(ce.CONFIG,t),Se.config={data:e,raw:t}}catch{}},updateConfig(e){const n={...this.getConfig(),...e};this.saveConfig(n)},getTheme(){return this.getConfig().theme},saveTheme(e){this.updateConfig({theme:e})},getFollowSystem(){return this.getConfig().followSystem},saveFollowSystem(e){this.updateConfig({followSystem:e})},getDockPosition(){return this.getConfig().dockPosition},saveDockPosition(e){this.updateConfig({dockPosition:e})},getIconSize(){return this.getConfig().iconSize},saveIconSize(e){this.updateConfig({iconSize:e})},getTexture(){return this.getConfig().texture},saveTexture(e){this.updateConfig({texture:e})},getGradient(){return this.getConfig().gradient},saveGradient(e){this.updateConfig({gradient:e})},getDockItems(){try{const e=localStorage.getItem(ce.DOCK_ITEMS);return e?JSON.parse(e):[]}catch{return[]}},saveDockItems(e){try{localStorage.setItem(ce.DOCK_ITEMS,JSON.stringify(e))}catch{}},getSearchEngine(){try{const e=localStorage.getItem(ce.SEARCH_ENGINE);return e?JSON.parse(e):null}catch{return null}},saveSearchEngine(e){try{localStorage.setItem(ce.SEARCH_ENGINE,JSON.stringify(e))}catch{}},getWallpaper(){try{return localStorage.getItem(ce.WALLPAPER)}catch{return null}},saveWallpaper(e){try{e?(localStorage.setItem(ce.WALLPAPER,e),localStorage.setItem(ce.LAST_WALLPAPER,e)):localStorage.removeItem(ce.WALLPAPER)}catch{}},getWallpaperId(){try{return localStorage.getItem(ce.WALLPAPER_ID)}catch{return null}},saveWallpaperId(e){try{e?localStorage.setItem(ce.WALLPAPER_ID,e):localStorage.removeItem(ce.WALLPAPER_ID)}catch{}},getLastWallpaper(){try{return localStorage.getItem(ce.LAST_WALLPAPER)}catch{return null}},saveLastWallpaper(e){try{e?localStorage.setItem(ce.LAST_WALLPAPER,e):localStorage.removeItem(ce.LAST_WALLPAPER)}catch{}},getSpaces(){try{const e=Tt(ce.SPACES,Se.spaces);if(e)return e;const t=localStorage.getItem(ce.SPACES);if(t){const o=JSON.parse(t);if(o&&o.spaces&&o.spaces.length>0)return Se.spaces={data:o,raw:t},o}const n=this.getDockItems();if(n.length>0){const o=Nt(n);return this.saveSpaces(o),o}const s=Nt();return this.saveSpaces(s),s}catch{const t=Nt();return this.saveSpaces(t),t}},saveSpaces(e){try{const t=JSON.stringify(e);localStorage.setItem(ce.SPACES,t),Se.spaces={data:e,raw:t}}catch{}},clearSpaces(){try{localStorage.removeItem(ce.SPACES)}catch{}},getStickers(){try{const e=Tt(ce.STICKERS,Se.stickers);if(e)return e;const t=localStorage.getItem(ce.STICKERS);if(t){const n=JSON.parse(t);return Se.stickers={data:n,raw:t},n}return[]}catch{return[]}},saveStickers(e){try{const t=JSON.stringify(e);localStorage.setItem(ce.STICKERS,t),Se.stickers={data:e,raw:t}}catch{}}},nr=100,_e=new Map,rr=e=>{const t=_e.get(e);return t&&(_e.delete(e),_e.set(e,t)),t},sr=(e,t)=>{if(_e.has(e)&&_e.delete(e),_e.size>=nr){const n=_e.keys().next().value;n&&_e.delete(n)}_e.set(e,t)},Fe=192,At=800,Gt=.6,Zt=.85;let Te=null,et=null;function yn(e,t){try{return Te||(typeof OffscreenCanvas<"u"?(Te=new OffscreenCanvas(e,t),et=Te.getContext("2d")):(Te=document.createElement("canvas"),Te.width=e,Te.height=t,et=Te.getContext("2d"))),et?((Te.width!==e||Te.height!==t)&&(Te.width=e,Te.height=t),et.clearRect(0,0,e,t),{canvas:Te,ctx:et}):null}catch{return null}}async function zt(e){return e?.startsWith("data:image")?new Promise((t,n)=>{const s=new Image;s.onload=()=>{try{let{width:o,height:i}=s;(o>Fe||i>Fe)&&(o>i?(i=Math.round(i*Fe/o),o=Fe):(o=Math.round(o*Fe/i),i=Fe));const c=yn(o,i);if(!c){t(e);return}const{canvas:u,ctx:I}=c;I.drawImage(s,0,0,o,i);let l;if(u instanceof OffscreenCanvas){const M=document.createElement("canvas");M.width=o,M.height=i;const m=M.getContext("2d");if(m)m.drawImage(u,0,0),l=M.toDataURL("image/webp",Gt);else{t(e);return}}else l=u.toDataURL("image/webp",Gt);l.length>e.length?t(e):t(l)}catch{t(e)}},s.onerror=()=>{t(e)},s.src=e}):e}async function Ht(e){return e?.startsWith("data:image")?new Promise(t=>{const n=new Image;n.onload=()=>{try{let{width:s,height:o}=n;s>At&&(o=Math.round(o*At/s),s=At);const i=yn(s,o);if(!i){t(e);return}const{canvas:c,ctx:u}=i;u.drawImage(n,0,0,s,o);let I;if(c instanceof OffscreenCanvas){const l=document.createElement("canvas");l.width=s,l.height=o;const M=l.getContext("2d");if(M)M.drawImage(c,0,0),I=l.toDataURL("image/webp",Zt);else{t(e);return}}else I=c.toDataURL("image/webp",Zt);I.length>e.length?t(e):t(I)}catch{t(e)}},n.onerror=()=>{t(e)},n.src=e}):e}async function vt(e){return Promise.all(e.map(async t=>{const n={...t};return n.icon&&(n.icon=await zt(n.icon)),n.type==="folder"&&n.items&&(n.items=await vt(n.items)),n}))}const Et=new Map,Ot=async(e,t=100)=>{try{const s=new URL(e).hostname,o=rr(s);if(o)return o;const i=`${s}:${t}`,c=Et.get(i);if(c)return c;const u=or(e,s,t);Et.set(i,u);try{return await u}finally{Et.delete(i)}}catch{return{url:st(e),isFallback:!0}}},Ji=async(e,t=100)=>{try{const n=await Ot(e,t);return n.isFallback?n:{url:await zt(n.url),isFallback:!1}}catch{return{url:st(e),isFallback:!0}}},or=async(e,t,n)=>{try{const i=`${new URL(e).protocol}//${t}`,c=[`${i}/apple-touch-icon.png`,`${i}/apple-touch-icon-180x180.png`,`${i}/apple-touch-icon-precomposed.png`,`${i}/icon-192x192.png`,`${i}/favicon.ico`],u=[`https://icons.duckduckgo.com/ip3/${t}.ico`,`https://www.google.com/s2/favicons?domain=${t}&sz=256`],I=m=>new Promise((f,g)=>{const d=new Image;let D=!1;const y=()=>{d.onload=null,d.onerror=null,D||(d.src="")};d.onload=()=>{if(D=!0,d.naturalWidth>=n&&d.naturalHeight>=n)f({url:m,width:d.naturalWidth,height:d.naturalHeight});else if(d.naturalWidth>1){if(n===0){f({url:m,width:d.naturalWidth,height:d.naturalHeight});return}g(`Image too small (< ${n}x${n})`)}else g("Image invalid")},d.onerror=()=>{D=!0,g("Failed to load")},d.src=m,setTimeout(()=>{D||(y(),g("Timeout"))},5e3)}),l=async m=>{const g=(await Promise.allSettled(m.map(d=>I(d)))).filter(d=>d.status==="fulfilled").map(d=>d.value).sort((d,D)=>D.width-d.width);return g.length>0?g[0]:null};let M=await l(c);if(M||(M=await l(u)),M){const m={url:M.url,isFallback:!1};return sr(t,m),m}throw new Error("未找到高分辨率图标")}catch{return{url:st(e),isFallback:!0}}},He=576;let Be=null,ct=null;function ar(){return Be||(Be=document.createElement("canvas"),Be.width=He,Be.height=He,ct=Be.getContext("2d")),ct?(ct.clearRect(0,0,He,He),{canvas:Be,ctx:ct}):null}const st=e=>{try{const t=ar();if(!t)return"";const{canvas:n,ctx:s}=t;let o=e;try{if(e.startsWith("http")||e.includes(".")){let d=e;try{d=new URL(e.startsWith("http")?e:`https://${e}`).hostname}catch{d=e}d=d.replace(/^www\./,"");const D=d.split(".")[0];D&&(o=D)}}catch{}const i=/[\u4e00-\u9fa5]/.test(o);if(i){const g=o.match(/[\u4e00-\u9fa5]/);o=g?g[0]:o.charAt(0)}else{const g=o.substring(0,2).toLowerCase();o=g.charAt(0).toUpperCase()+g.slice(1)}const c=Math.floor(Math.random()*360),u=40+Math.floor(Math.random()*40),I=20+Math.floor(Math.random()*15);s.fillStyle=`hsl(${c}, ${u}%, ${I}%)`,s.fillRect(0,0,576,576);const l=Math.floor(Math.random()*360),M=50+Math.floor(Math.random()*40),m=80+Math.floor(Math.random()*15);s.fillStyle=`hsl(${l}, ${M}%, ${m}%)`,s.font='900 360px "Bricolage Grotesque", sans-serif',s.textBaseline="middle",s.textAlign="center";const f=i?40:20;return s.fillText(o,He/2,He/2+f),n.toDataURL("image/png")}catch{return""}},be=e=>{if(e.length===0)return st("");const n=`
    <svg width="64" height="64" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <clipPath id="clip-0">
          <rect x="0" y="0" width="32" height="32" rx="8"/>
        </clipPath>
        <clipPath id="clip-1">
          <rect x="32" y="0" width="32" height="32" rx="8"/>
        </clipPath>
        <clipPath id="clip-2">
          <rect x="0" y="32" width="32" height="32" rx="8"/>
        </clipPath>
        <clipPath id="clip-3">
          <rect x="32" y="32" width="32" height="32" rx="8"/>
        </clipPath>
      </defs>
      ${e.slice(0,4).map(s=>s.icon||st("")).map((s,o)=>{const i=o%2*32,c=Math.floor(o/2)*32;return`
          <g clip-path="url(#clip-${o})">
            <image href="${s}" x="${i}" y="${c}" width="32" height="32" preserveAspectRatio="xMidYMid slice"/>
          </g>
        `}).join("")}
    </svg>
  `;return`data:image/svg+xml;base64,${btoa(n)}`};async function _t(e){const t={title:e.name,type:e.type};return e.url&&(t.url=e.url),e.icon&&(t.icon=await zt(e.icon)),e.type==="folder"&&e.items&&(t.children=await Promise.all(e.items.map(_t))),t}async function ir(e){const t=await Promise.all(e.apps.map(_t)),n={version:"1.0",type:"eclipse-space-export",data:{name:e.name,iconType:e.iconType,iconValue:e.iconValue,apps:t}},s=JSON.stringify(n,null,2),o=new Blob([s],{type:"application/json"}),i=new Date().toISOString().slice(0,10).replace(/-/g,""),u=`eclipse-space-${e.name.toLowerCase().replace(/[^a-z0-9]/g,"-")}-${i}.json`,I=URL.createObjectURL(o),l=document.createElement("a");l.href=I,l.download=u,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(I)}async function cr(e){const n={version:"1.0",type:"eclipse-multi-space-export",data:{spaces:await Promise.all(e.map(async l=>{const M=await Promise.all(l.apps.map(_t));return{name:l.name,iconType:l.iconType,iconValue:l.iconValue,apps:M}}))}},s=JSON.stringify(n,null,2),o=new Blob([s],{type:"application/json"}),c=`eclipse-all-spaces-${new Date().toISOString().slice(0,10).replace(/-/g,"")}.json`,u=URL.createObjectURL(o),I=document.createElement("a");I.href=u,I.download=c,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(u)}function lr(e){if(!e||typeof e!="object")return!1;const t=e;if(t.type!=="eclipse-space-export"||!t.data||typeof t.data!="object")return!1;const n=t.data;return!(typeof n.name!="string"||!n.name||!Array.isArray(n.apps))}function ur(e){if(!e||typeof e!="object")return!1;const t=e;if(t.type!=="eclipse-multi-space-export"||!t.data||typeof t.data!="object")return!1;const n=t.data;if(!Array.isArray(n.spaces)||n.spaces.length===0)return!1;for(const s of n.spaces){if(!s||typeof s!="object")return!1;const o=s;if(typeof o.name!="string"||!o.name||!Array.isArray(o.apps))return!1}return!0}async function dr(e){return new Promise((t,n)=>{const s=new FileReader;s.onload=o=>{try{const i=o.target?.result,c=JSON.parse(i);if(ur(c)){t({type:"multi",data:c});return}if(lr(c)){t({type:"single",data:c});return}n(new Error("Invalid file format: missing required fields"))}catch{n(new Error("Invalid JSON file"))}},s.onerror=()=>{n(new Error("Failed to read file"))},s.readAsText(e)})}function Rt(e){const t={id:crypto.randomUUID(),name:e.title,type:e.type};return e.url&&(t.url=e.url),e.icon&&(t.icon=e.icon),e.type==="folder"&&e.children&&(t.items=e.children.map(Rt)),t}function hn(e,t){if(!t.includes(e))return e;let n=1,s=`${e} (${n})`;for(;t.includes(s);)n++,s=`${e} (${n})`;return s}async function gr(e,t){const n=t.map(c=>c.name),s=hn(e.data.name,n),o=e.data.apps.map(Rt),i=await vt(o);return{id:crypto.randomUUID(),name:s,iconType:e.data.iconType||"text",iconValue:e.data.iconValue,apps:i,createdAt:Date.now()}}async function Mr(e,t){const n=t.map(o=>o.name),s=[];for(const o of e.data.spaces){const i=[...n,...s.map(l=>l.name)],c=hn(o.name,i),u=o.apps.map(Rt),I=await vt(u);s.push({id:crypto.randomUUID(),name:c,iconType:o.iconType||"text",iconValue:o.iconValue,apps:I,createdAt:Date.now()})}return s}const Nn=r.createContext(void 0),jn=r.createContext(void 0);function Ir({children:e}){const[t,n]=r.useState(()=>ie.getSpaces()),[s,o]=r.useState(!1),i=r.useRef(!0),{spaces:c,activeSpaceId:u}=t,I=r.useMemo(()=>c.find(E=>E.id===u)||c[0],[c,u]),l=r.useMemo(()=>c.findIndex(E=>E.id===u),[c,u]),M=r.useRef();r.useEffect(()=>{if(i.current){i.current=!1;return}return M.current&&clearTimeout(M.current),M.current=window.setTimeout(()=>{ie.saveSpaces(t)},500),()=>{M.current&&clearTimeout(M.current)}},[t]);const m=r.useCallback(()=>{if(s||c.length<=1)return;const E=(l+1)%c.length,k=c[E];n(T=>({...T,activeSpaceId:k.id}))},[s,c,l]),f=r.useCallback(E=>{s||!c.find(T=>T.id===E)||n(T=>({...T,activeSpaceId:E}))},[s,c]),g=r.useCallback(E=>{const k=Lt(E||`Space ${c.length+1}`);n(T=>({...T,spaces:[...T.spaces,k],activeSpaceId:k.id}))},[c.length]),d=r.useCallback(E=>{if(c.length<=1)return;const k=c.findIndex(U=>U.id===E);if(k===-1)return;let T=u;if(E===u){const U=k===0?1:k-1;T=c[U].id}n(U=>({...U,spaces:U.spaces.filter(p=>p.id!==E),activeSpaceId:T}))},[c,u]),D=r.useCallback((E,k)=>{k.trim()&&n(T=>({...T,spaces:T.spaces.map(U=>U.id===E?{...U,name:k.trim()}:U)}))},[]),y=r.useCallback(async E=>{const k=await gr(E,c);return n(T=>({...T,spaces:[...T.spaces,k],activeSpaceId:k.id})),k},[c]),x=r.useCallback(async E=>{const k=await Mr(E,c);return k.length>0&&n(T=>({...T,spaces:[...T.spaces,...k],activeSpaceId:k[0].id})),k},[c]),Y=r.useCallback(E=>{n(k=>{const T=k.spaces.findIndex(N=>N.id===E);if(T<=0)return k;const p=[k.spaces[T],...k.spaces.slice(0,T),...k.spaces.slice(T+1)];return{...k,spaces:p}})},[]),O=r.useCallback(E=>{n(k=>({...k,spaces:k.spaces.map(T=>T.id===k.activeSpaceId?{...T,apps:E}:T)}))},[]),P=r.useMemo(()=>({spaces:c,activeSpaceId:u,isSwitching:s,currentSpace:I,currentIndex:l}),[c,u,s,I,l]),F=r.useMemo(()=>({switchToNextSpace:m,switchToSpace:f,addSpace:g,deleteSpace:d,renameSpace:D,updateCurrentSpaceApps:O,importSpace:y,importMultipleSpaces:x,pinSpace:Y,setIsSwitching:o}),[m,f,g,d,D,O,y,x,Y]);return a.jsx(Nn.Provider,{value:P,children:a.jsx(jn.Provider,{value:F,children:e})})}function Tn(){const e=r.useContext(Nn),t=r.useContext(jn);if(!e||!t)throw new Error("useSpaces must be used within a SpacesProvider");return{...e,...t}}const An=r.createContext(void 0),En=r.createContext(void 0),Cn=r.createContext(void 0),fr=({children:e})=>{const{currentSpace:t,updateCurrentSpaceApps:n}=Tn(),[s,o]=r.useState(t.apps),[i,c]=r.useState(Kn),[u,I]=r.useState(!1),[l,M]=r.useState(null),[m,f]=r.useState(null),[g,d]=r.useState(null),[D,y]=r.useState(!1);r.useEffect(()=>{o(t.apps)},[t.id,t.apps]);const x=r.useCallback(L=>{o(R=>{const B=typeof L=="function"?L(R):L;return setTimeout(()=>n(B),0),B})},[n]),Y=Ne.useRef(!1);r.useEffect(()=>{if(!Y.current&&t.apps.length===0&&s.length===0&&t.name==="Main"){Y.current=!0;const R=[{id:"bilibili",name:"Bilibili",url:"https://www.bilibili.com/",type:"app"},{id:"notion",name:"Notion",url:"https://www.notion.so/",type:"app"},{id:"notion-calendar",name:"NotionCalendar",url:"https://calendar.notion.so/",type:"app"},{id:"gemini",name:"Gemini",url:"https://gemini.google.com/app",type:"app"},{id:"jike",name:"即刻",url:"https://web.okjike.com",type:"app"},{id:"behance",name:"Behance",url:"https://www.behance.net/",type:"app"},{id:"x",name:"X",url:"https://x.com/",type:"app"},{id:"chatgpt",name:"ChatGPT",url:"https://chatgpt.com/",type:"app"},{id:"claude",name:"Claude",url:"https://claude.ai/new",type:"app"}];R.forEach(j=>{j.type==="folder"&&j.items&&(j.icon=be(j.items))}),x(R),(async()=>{let j=!0;const K=(await Promise.all(R.map(async A=>{if(A.type==="folder"&&A.items){const W=(await Promise.all(A.items.map(async H=>{if(H.url)try{const{url:se}=await Ot(H.url);return{id:H.id,icon:se}}catch{return null}return null}))).filter(H=>H!==null);if(W.length>0)return{id:A.id,isFolder:!0,subItems:W}}else if(A.url)try{const{url:v}=await Ot(A.url);return{id:A.id,icon:v}}catch{}return null}))).filter(A=>A!==null);if(j)return x(A=>A.map(v=>{const W=K.find(H=>H&&H.id===v.id);if(!W)return v;if(W.isFolder&&v.type==="folder"&&v.items){const H=v.items.map(se=>{const te=W.subItems?.find(X=>X.id===se.id);return te?{...se,icon:te.icon}:se});return{...v,items:H,icon:be(H)}}else if(!W.isFolder&&W.icon)return{...v,icon:W.icon};return v})),()=>{j=!1}})()}const L=ie.getSearchEngine();L&&c(L)},[]),r.useEffect(()=>{ie.saveSearchEngine(i)},[i]);const O=r.useCallback((L,R)=>{const B=R.find(Q=>Q.id===L);if(!B||B.type!=="folder"||!B.items)return R;const j=R.findIndex(Q=>Q.id===L);if(j===-1)return R;if(B.items.length===0)return R.filter(Q=>Q.id!==L);if(B.items.length===1){const Q=B.items[0],K=[...R];return K[j]=Q,K}return R},[]),P=r.useCallback(L=>{I(L)},[]),F=r.useCallback(L=>{c(L)},[]),E=r.useCallback(L=>{M(L),L||f(null)},[]),k=r.useCallback(L=>{window.confirm(`确定要删除 "${L.name}" 吗？${L.type==="folder"?"文件夹内的所有内容也将被删除。":""}`)&&(x(R=>R.filter(j=>j.id!==L.id)),l===L.id&&M(null))},[l]),T=r.useCallback((L,R)=>{if(R){const B=j=>j.map(Q=>Q.id===R.id?{...Q,...L}:Q.type==="folder"&&Q.items?{...Q,items:B(Q.items)}:Q);x(j=>B(j))}else{const B={id:`item-${Date.now()}`,name:L.name||"",url:L.url,icon:L.icon,type:"app"};x(j=>[...j,B])}},[]),U=r.useCallback(L=>{const R=L.map(B=>B.type==="folder"&&B.items&&B.items.length>0?{...B,icon:be(B.items)}:B);x(R)},[]),p=r.useCallback((L,R)=>{x(B=>B.map(j=>j.id===L&&j.type==="folder"?{...j,items:R,icon:be(R)}:j))},[]),N=r.useCallback((L,R)=>{x(B=>{const j=B.find(Q=>Q.id===L);if(j&&j.type==="folder"&&j.items){const Q=j.items.filter(v=>v.id!==R.id);let K=B.map(v=>v.id===L?{...v,items:Q,icon:be(Q)}:v);K=O(L,K);const A=K.find(v=>v.id===L);return(!A||A.type!=="folder")&&M(null),K}return B})},[O]),w=r.useCallback((L,R)=>{l&&x(B=>{const j=B.find(X=>X.id===l);if(!j||j.type!=="folder"||!j.items)return B;const Q=j.items.filter(X=>X.id!==L.id);let K=B.map(X=>X.id===l?{...X,items:Q,icon:Q.length>0?be(Q):void 0}:X);const A=O(l,K),v=A.find(X=>X.id===l);(!v||v.type!=="folder")&&M(null);const W=document.querySelector('[data-dock-container="true"]');if(!W){const X=[...A],le=X.findIndex(Me=>Me.id===L.id);return le!==-1&&X.splice(le,1),X.push(L),X}const H=Array.from(W.querySelectorAll('[data-dock-item-wrapper="true"]'));let se=A.length;for(let X=0;X<H.length;X++){const le=H[X].getBoundingClientRect(),Me=le.left+le.width/2;if(R.x<Me){se=X;break}}let te=A.filter(X=>X.id!==L.id);return se=Math.max(0,Math.min(se,te.length)),te.splice(se,0,L),te})},[l,O]),_=r.useCallback(L=>{!l||L.type==="folder"||x(R=>{const B=R.find(Q=>Q.id===l);if(!B||B.type!=="folder")return R;const j=[...B.items||[],L];return R.map(Q=>Q.id===l?{...Q,items:j,icon:be(j)}:Q).filter(Q=>Q.id!==L.id)})},[l]),G=r.useCallback((L,R)=>{if(R.type!=="folder")return;let B=[];L.type==="folder"&&L.items?B=L.items:B=[L],x(j=>j.map(Q=>{if(Q.id===R.id){const K=new Set((Q.items||[]).map(W=>W.id)),A=B.filter(W=>!K.has(W.id)),v=[...Q.items||[],...A];return{...Q,items:v,icon:be(v)}}return Q}).filter(Q=>Q.id!==L.id))},[]),S=r.useMemo(()=>({dockItems:s,selectedSearchEngine:i,setDockItems:x,setSelectedSearchEngine:F,handleItemSave:T,handleItemsReorder:U,handleItemDelete:k,handleFolderItemsReorder:p,handleFolderItemDelete:N,handleDragFromFolder:w,handleDragToFolder:_,handleDropOnFolder:G}),[s,i,T,U,k,p,N,w,_,G]),z=r.useMemo(()=>({isEditMode:u,openFolderId:l,folderAnchor:m,setIsEditMode:P,setOpenFolderId:E,setFolderAnchor:f}),[u,l,m,P,E]),re=r.useMemo(()=>({draggingItem:g,setDraggingItem:d,folderPlaceholderActive:D,setFolderPlaceholderActive:y}),[g,D]);return a.jsx(An.Provider,{value:S,children:a.jsx(En.Provider,{value:z,children:a.jsx(Cn.Provider,{value:re,children:e})})})},mr=()=>{const e=r.useContext(An);if(e===void 0)throw new Error("useDockData must be used within a DockProvider");return e},Ut=()=>{const e=r.useContext(En);if(e===void 0)throw new Error("useDockUI must be used within a DockProvider");return e},kn=()=>{const e=r.useContext(Cn);if(e===void 0)throw new Error("useDockDrag must be used within a DockProvider");return e},Dr=()=>{const e=()=>typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[t,n]=r.useState(e);return r.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)"),o=i=>{n(i.matches?"dark":"light")};return s.addEventListener?(s.addEventListener("change",o),()=>s.removeEventListener("change",o)):(s.addListener(o),()=>s.removeListener(o))},[]),t},pr="EclipseTabDB",fe="wallpapers",xr=1;class yr{dbPromise=null;getDB(){return this.dbPromise||(this.dbPromise=new Promise((t,n)=>{if(typeof window>"u"||!window.indexedDB){n(new Error("IndexedDB is not supported"));return}try{const s=window.indexedDB.open(pr,xr);s.onerror=o=>{this.dbPromise=null;const i=o.target.error;n(i||new Error("Failed to open IndexedDB"))},s.onsuccess=()=>t(s.result),s.onupgradeneeded=o=>{const i=o.target.result;i.objectStoreNames.contains(fe)||i.createObjectStore(fe,{keyPath:"id"})}}catch(s){this.dbPromise=null,n(s)}})),this.dbPromise}async save(t){try{const n=await this.getDB();return new Promise((s,o)=>{const u=n.transaction(fe,"readwrite").objectStore(fe).put(t);u.onsuccess=()=>s(t.id),u.onerror=()=>o(u.error)})}catch(n){throw n}}async saveMultiple(t){if(t.length===0)return[];try{const n=await this.getDB();return new Promise((s,o)=>{const i=n.transaction(fe,"readwrite"),c=i.objectStore(fe),u=[];t.forEach(I=>{c.put(I),u.push(I.id)}),i.oncomplete=()=>s(u),i.onerror=()=>o(i.error)})}catch(n){throw n}}async get(t){try{const n=await this.getDB();return new Promise((s,o)=>{const u=n.transaction(fe,"readonly").objectStore(fe).get(t);u.onsuccess=()=>s(u.result||null),u.onerror=()=>o(u.error)})}catch{return null}}async remove(t){try{const n=await this.getDB();return new Promise((s,o)=>{const u=n.transaction(fe,"readwrite").objectStore(fe).delete(t);u.onsuccess=()=>s(),u.onerror=()=>o(u.error)})}catch(n){throw n}}async removeMultiple(t){if(t.length!==0)try{const n=await this.getDB();return new Promise((s,o)=>{const i=n.transaction(fe,"readwrite"),c=i.objectStore(fe);t.forEach(u=>{c.delete(u)}),i.oncomplete=()=>s(),i.onerror=()=>o(i.error)})}catch(n){throw n}}async getAll(){try{const t=await this.getDB();return new Promise((n,s)=>{const c=t.transaction(fe,"readonly").objectStore(fe).getAll();c.onsuccess=()=>n(c.result||[]),c.onerror=()=>s(c.error)})}catch{return[]}}}const lt=new yr,hr=15*1024*1024,Nr=async e=>e.size<=hr?e:new Promise((t,n)=>{const s=new Image,o=URL.createObjectURL(e);s.onload=()=>{URL.revokeObjectURL(o);const i=document.createElement("canvas");i.width=s.width,i.height=s.height;const c=i.getContext("2d");if(!c){t(e);return}c.drawImage(s,0,0),i.toBlob(u=>{u&&u.size<e.size?t(u):t(e)},"image/webp",.8)},s.onerror=()=>{URL.revokeObjectURL(o),n(new Error("Failed to load image for compression"))},s.src=o}),jr=async e=>new Promise((t,n)=>{const s=new Image,o=URL.createObjectURL(e);s.onload=()=>{URL.revokeObjectURL(o);const i=document.createElement("canvas"),c=200;i.width=c,i.height=c;const u=i.getContext("2d");if(!u){n(new Error("Failed to get canvas context"));return}const I=Math.min(s.width,s.height),l=(s.width-I)/2,M=(s.height-I)/2,m=I,f=I;u.drawImage(s,l,M,m,f,0,0,c,c),i.toBlob(g=>{g?t(g):n(new Error("Failed to generate thumbnail blob"))},"image/webp",.6)},s.onerror=()=>{URL.revokeObjectURL(o),n(new Error("Failed to load image for thumbnail"))},s.src=o}),Tr=()=>{const[e,t]=r.useState(!0),[n,s]=r.useState(!1),[o,i]=r.useState(null),c=r.useRef(new Set);r.useEffect(()=>{(typeof window>"u"||!window.indexedDB)&&(t(!1),i(new Error("IndexedDB is not supported in this browser")))},[]),r.useEffect(()=>{const f=c;return()=>{f.current.forEach(g=>URL.revokeObjectURL(g))}},[]);const u=r.useCallback(f=>{const g=URL.createObjectURL(f);return c.current.add(g),g},[]),I=r.useCallback(async f=>{if(!e)throw new Error("Storage not supported");s(!0);try{const[g,d]=await Promise.all([Nr(f),jr(f).catch(x=>{})]),D=`wallpaper_${Date.now()}`,y={id:D,data:g,thumbnail:d,createdAt:Date.now()};return await lt.save(y),D}catch(g){const d=g instanceof Error?g:new Error("Failed to save wallpaper");throw i(d),d}finally{s(!1)}},[e]),l=r.useCallback(async f=>{if(!e)return null;try{const g=await lt.get(f);return g?g.data:null}catch(g){const d=g instanceof Error?g:new Error("Failed to get wallpaper");return i(d),null}},[e]),M=r.useCallback(async f=>{if(e)try{await lt.remove(f)}catch(g){const d=g instanceof Error?g:new Error("Failed to delete wallpaper");throw i(d),d}},[e]),m=r.useCallback(async()=>{if(!e)return[];try{return(await lt.getAll()).sort((g,d)=>d.createdAt-g.createdAt)}catch(f){const g=f instanceof Error?f:new Error("Failed to get recent wallpapers");return i(g),[]}},[e]);return{saveWallpaper:I,getWallpaper:l,deleteWallpaper:M,getRecentWallpapers:m,createWallpaperUrl:u,isSupported:e,isProcessing:n,error:o}},Ar=[{id:"theme-default",name:"默认",gradient:"#F3F3F3",solid:"#F3F3F3"},{id:"gradient-1",name:"紫粉",gradient:"linear-gradient(to top, #a18cd1 0%, #fbc2eb 100%)",solid:"#FEFAEF",solidDark:"#8B7A5E"},{id:"gradient-2",name:"粉蓝",gradient:"linear-gradient(to top, #fbc2eb 0%, #a6c1ee 100%)",solid:"#E9EDF6",solidDark:"#6B7B9B"},{id:"gradient-3",name:"紫白",gradient:"linear-gradient(to top, #cd9cf2 0%, #f6f3ff 100%)",solid:"#E8E6F1",solidDark:"#6E6B7C"},{id:"gradient-4",name:"蓝灰",gradient:"linear-gradient(to top, #6a85b6 0%, #bac8e0 100%)",solid:"#E3F8FD",solidDark:"#6A8FA1"},{id:"gradient-5",name:"蓝紫",gradient:"linear-gradient(to top, #505285 0%, #585e92 12%, #65689f 25%, #7474b0 37%, #7e7ebb 50%, #8389c7 62%, #9795d4 75%, #a2a1dc 87%, #b5aee4 100%)",solid:"#F1F6EF",solidDark:"#7C8A77"},{id:"gradient-6",name:"灰紫",gradient:"linear-gradient(to top, #bdc2e8 0%, #bdc2e8 1%, #e6dee9 100%)",solid:"#F2EADD",solidDark:"#847B6F"},{id:"gradient-7",name:"微光",gradient:"linear-gradient(to bottom, #323232 0%, #3F3F3F 40%, #1C1C1C 150%), linear-gradient(to top, rgba(255,255,255,0.40) 0%, rgba(0,0,0,0.25) 200%)",solid:"#FBEEE6",solidDark:"#8E7D73",blendMode:"multiply"},{id:"gradient-8",name:"深蓝",gradient:"linear-gradient(to top, #0c3483 0%, #a2b6df 100%, #6b8cce 100%, #a2b6df 100%)",solid:"#BDC2E8",solidDark:"#5F6380"},{id:"gradient-9",name:"流彩",gradient:"linear-gradient(-225deg, #473B7B 0%, #3584A7 51%, #30D2BE 100%)",solid:"#323232",solidDark:"#1A1A1A"}],Er=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" fill="currentColor"/>
</svg>
`,Cr=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M18.7176 4.78256C19.4986 5.56361 19.4986 6.82994 18.7176 7.61099L14.8285 11.5001L18.7176 15.3892C19.4986 16.1702 19.4986 17.4365 18.7176 18.2176C17.9365 18.9986 16.6702 18.9986 15.8892 18.2176L12.0001 14.3285L8.11099 18.2176C7.32994 18.9986 6.06361 18.9986 5.28256 18.2176C4.50152 17.4365 4.50152 16.1702 5.28256 15.3892L9.17165 11.5001L5.28256 7.61099C4.50152 6.82994 4.50152 5.56361 5.28256 4.78256C6.06361 4.00152 7.32994 4.00152 8.11099 4.78256L12.0001 8.67165L15.8892 4.78256C16.6702 4.00152 17.9365 4.00152 18.7176 4.78256Z" fill="currentColor"/>
</svg>
`;function Vt(e){return e.replace(/\r?\n/g,"").trim()}const wn={point:{id:"point",name:"Circle",nameZh:"Circle",svgRaw:Vt(Er),iconSize:20,tileSize:36,supportsColor:!0},cross:{id:"cross",name:"Cross",nameZh:"Cross",svgRaw:Vt(Cr),iconSize:20,tileSize:54,supportsColor:!0}};function kr(e,t="rgba(128, 128, 128, 0.1)"){const n=wn[e];if(!n)return"";const{svgRaw:s,iconSize:o,tileSize:i}=n,c=(i-o)/2,u=s.replace(/<svg[^>]*>/,"").replace(/<\/svg>/,"").replace(/currentColor/g,t),I=`<svg width="${i}" height="${i}" viewBox="0 0 ${i} ${i}" xmlns="http://www.w3.org/2000/svg"><svg x="${c}" y="${c}" width="${o}" height="${o}" viewBox="0 0 24 24">`+u+"</svg></svg>";return`data:image/svg+xml;base64,${btoa(I)}`}function Xt(e){if(e==="none")return"cover";const t=wn[e];return t?`${t.tileSize}px ${t.tileSize}px`:"48px 48px"}function wr(e,t){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var o in n)s[n[o]]=o;var i={};e.prototype.toName=function(c){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var u,I,l=s[this.toHex()];if(l)return l;if(c?.closest){var M=this.toRgb(),m=1/0,f="black";if(!i.length)for(var g in n)i[g]=new e(n[g]).toRgb();for(var d in n){var D=(u=M,I=i[d],Math.pow(u.r-I.r,2)+Math.pow(u.g-I.g,2)+Math.pow(u.b-I.b,2));D<m&&(m=D,f=d)}return f}},t.string.push([function(c){var u=c.toLowerCase(),I=u==="transparent"?"#0000":n[u];return I?new e(I).toRgb():null},"name"])}var Oe=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=1),e>n?n:e>t?e:t},Ct=function(e){var t=e/255;return t<.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},kt=function(e){return 255*(e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e)},Qt=96.422,Yt=100,Pt=82.521,Sr=function(e){var t,n,s={x:.9555766*(t=e).x+-.0230393*t.y+.0631636*t.z,y:-.0282895*t.x+1.0099416*t.y+.0210077*t.z,z:.0122982*t.x+-.020483*t.y+1.3299098*t.z};return n={r:kt(.032404542*s.x-.015371385*s.y-.004985314*s.z),g:kt(-.00969266*s.x+.018760108*s.y+41556e-8*s.z),b:kt(556434e-9*s.x-.002040259*s.y+.010572252*s.z),a:e.a},{r:Oe(n.r,0,255),g:Oe(n.g,0,255),b:Oe(n.b,0,255),a:Oe(n.a)}},br=function(e){var t=Ct(e.r),n=Ct(e.g),s=Ct(e.b);return function(o){return{x:Oe(o.x,0,Qt),y:Oe(o.y,0,Yt),z:Oe(o.z,0,Pt),a:Oe(o.a)}}(function(o){return{x:1.0478112*o.x+.0228866*o.y+-.050127*o.z,y:.0295424*o.x+.9904844*o.y+-.0170491*o.z,z:-.0092345*o.x+.0150436*o.y+.7521316*o.z,a:o.a}}({x:100*(.4124564*t+.3575761*n+.1804375*s),y:100*(.2126729*t+.7151522*n+.072175*s),z:100*(.0193339*t+.119192*n+.9503041*s),a:e.a}))},rt=216/24389,Ve=24389/27,qt=function(e){var t=br(e),n=t.x/Qt,s=t.y/Yt,o=t.z/Pt;return n=n>rt?Math.cbrt(n):(Ve*n+16)/116,{l:116*(s=s>rt?Math.cbrt(s):(Ve*s+16)/116)-16,a:500*(n-s),b:200*(s-(o=o>rt?Math.cbrt(o):(Ve*o+16)/116)),alpha:t.a}},Lr=function(e,t,n){var s,o=qt(e),i=qt(t);return function(c){var u=(c.l+16)/116,I=c.a/500+u,l=u-c.b/200;return Sr({x:(Math.pow(I,3)>rt?Math.pow(I,3):(116*I-16)/Ve)*Qt,y:(c.l>8?Math.pow((c.l+16)/116,3):c.l/Ve)*Yt,z:(Math.pow(l,3)>rt?Math.pow(l,3):(116*l-16)/Ve)*Pt,a:c.alpha})}({l:Oe((s={l:o.l*(1-n)+i.l*n,a:o.a*(1-n)+i.a*n,b:o.b*(1-n)+i.b*n,alpha:o.alpha*(1-n)+i.alpha*n}).l,0,400),a:s.a,b:s.b,alpha:Oe(s.alpha)})};function Or(e){function t(n,s,o){o===void 0&&(o=5);for(var i=[],c=1/(o-1),u=0;u<=o-1;u++)i.push(n.mix(s,c*u));return i}e.prototype.mix=function(n,s){s===void 0&&(s=.5);var o=n instanceof e?n:new e(n),i=Lr(this.toRgb(),o.toRgb(),s);return new e(i)},e.prototype.tints=function(n){return t(this,"#fff",n)},e.prototype.shades=function(n){return t(this,"#000",n)},e.prototype.tones=function(n){return t(this,"#808080",n)}}Fn([wr,Or]);function zr(e){const t=e.match(/#[a-fA-F0-9]{6}/);let n="#808080";if(t)n=t[0];else{const o=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);o&&(n=`rgb(${o[1]}, ${o[2]}, ${o[3]})`)}return Bn(n).saturate(.1).darken(.2).alpha(.4).toRgbString()}const ut={light:"#f1f1f1",dark:"#2C2C2E"},Sn=r.createContext(void 0),bn=r.createContext(void 0),Jt=20*1024*1024,vr=e=>{if(e.startsWith("url("))return!0;const t=[],n=/#[0-9A-Fa-f]{6}/g,s=/rgba?\([^)]+\)/g,o=e.match(n);o&&t.push(...o);const i=e.match(s);if(i&&t.push(...i),t.length===0)return!1;let c=0,u=0;return t.forEach(M=>{let m=0,f=0,g=0;if(M.startsWith("#")){const D=M.substring(1);m=parseInt(D.substring(0,2),16),f=parseInt(D.substring(2,4),16),g=parseInt(D.substring(4,6),16)}else if(M.startsWith("rgb")){const D=M.match(/\d+/g);D&&D.length>=3&&(m=parseInt(D[0]),f=parseInt(D[1]),g=parseInt(D[2]))}const d=(.299*m+.587*f+.114*g)/255;c+=d,d>u&&(u=d)}),(c/t.length+u)/2>.4},_r=({children:e})=>{const t=Dr(),{saveWallpaper:n,getWallpaper:s,createWallpaperUrl:o}=Tr(),[i,c]=r.useState(()=>ie.getTheme()||"default"),[u,I]=r.useState(()=>ie.getFollowSystem()),[l,M]=r.useState(()=>ie.getWallpaper()),[m,f]=r.useState(()=>ie.getWallpaperId()),[g]=r.useState(()=>ie.getLastWallpaper()),[d,D]=r.useState(()=>ie.getGradient()),[y,x]=r.useState(()=>ie.getTexture()||"none"),[Y,O]=r.useState(()=>ie.getDockPosition()),[P,F]=r.useState(()=>ie.getIconSize()),E=u?t:i,k=i==="default"&&!u;r.useEffect(()=>{m&&s(m).then(A=>{if(A){const v=o(A);M(v)}})},[m,s,o]);const T=r.useCallback(A=>{c(A),ie.saveTheme(A),u&&(I(!1),ie.saveFollowSystem(!1))},[u]),U=r.useCallback(A=>{I(A),ie.saveFollowSystem(A)},[]),p=r.useCallback(A=>{M(A),ie.saveWallpaper(A),A||(f(null),ie.saveWallpaperId(null))},[]),N=r.useCallback(async A=>{f(A),ie.saveWallpaperId(A);const v=await s(A);if(v){const W=o(v);M(W),ie.saveWallpaper(null)}},[s,o]),w=r.useCallback(async A=>{if(A.size>Jt)throw new Error(`图片大小不能超过 ${Jt/1024/1024}MB`);if(!A.type.startsWith("image/"))throw new Error("请选择图片文件");try{const v=await n(A);await N(v)}catch(v){throw v}},[n,N]),_=r.useCallback(A=>{D(A),ie.saveGradient(A)},[]),G=r.useCallback(A=>{x(A),ie.saveTexture(A)},[]),S=r.useCallback(A=>{O(A),ie.saveDockPosition(A)},[]),z=r.useCallback(A=>{F(A),ie.saveIconSize(A)},[]);r.useEffect(()=>{document.documentElement.setAttribute("data-theme",E)},[E]);const{backgroundValue:re,backgroundBaseValue:L,backgroundTextureValue:R,backgroundTextureTileSize:B,backgroundBlendMode:j}=Ne.useMemo(()=>{let A="",v="",W=null,H="cover",se="normal";if(l)v=`url(${l})`,A=v;else{if(d){const te=Ar.find(X=>X.id===d);te&&(te.id==="theme-default"?k?v="linear-gradient(180deg, #00020E 0%, #071633 25%, #3966AD 65%, #7e9ecb 100%)":v=E==="dark"?ut.dark:ut.light:k?v=te.gradient:v=te.solid,"blendMode"in te&&te.blendMode&&(se=te.blendMode))}else k?v="linear-gradient(180deg, #00020E 0%, #071633 25%, #3966AD 65%, #7e9ecb 100%)":v=E==="dark"?ut.dark:ut.light;if(A=v,!k&&y!=="none"){const te=zr(v);W=`url("${kr(y,te)}")`,H=Xt(y),A=`${W}, ${v}`}}return{backgroundValue:A,backgroundBaseValue:v,backgroundTextureValue:W,backgroundTextureTileSize:H,backgroundBlendMode:se}},[l,d,y,k,E]);r.useEffect(()=>{const A=document.documentElement;if(A.removeAttribute("data-texture"),k&&re){const W=vr(re);A.setAttribute("data-background-brightness",W?"light":"dark")}else A.removeAttribute("data-background-brightness");if(A.style.setProperty("--background-custom",re),!k&&y!=="none"&&!l){const W=Xt(y);A.style.setProperty("--background-size",`${W}, cover`),A.style.setProperty("--background-position","0 0, center"),A.style.setProperty("--background-repeat","repeat, no-repeat")}else A.style.setProperty("--background-size","cover"),A.style.setProperty("--background-position","center"),A.style.setProperty("--background-repeat","no-repeat");j!=="normal"?A.style.setProperty("--background-blend-mode",j):A.style.removeProperty("--background-blend-mode"),A.style.setProperty("--icon-size",P==="small"?"52px":"64px")},[re,j,k,P,y,l]);const Q=r.useMemo(()=>({theme:E,followSystem:u,wallpaper:l,lastWallpaper:g,gradientId:d,texture:y,wallpaperId:m,backgroundValue:re,backgroundBaseValue:L,backgroundTextureValue:R,backgroundTextureTileSize:B,backgroundBlendMode:j,dockPosition:Y,iconSize:P}),[E,u,l,g,d,y,m,re,L,R,B,j,Y,P]),K=r.useMemo(()=>({setTheme:T,setFollowSystem:U,setWallpaper:p,uploadWallpaper:w,setGradientId:_,setTexture:G,setWallpaperId:N,setDockPosition:S,setIconSize:z}),[T,U,p,w,_,G,N,S,z]);return a.jsx(Sn.Provider,{value:Q,children:a.jsx(bn.Provider,{value:K,children:e})})},ot=()=>{const e=r.useContext(Sn);if(e===void 0)throw new Error("useThemeData must be used within a ThemeProvider");return e},Rr=()=>{const e=r.useContext(bn);if(e===void 0)throw new Error("useThemeActions must be used within a ThemeProvider");return e},Ki=()=>{const e=ot(),t=Rr();return{...e,...t}},Ur="_searcher_vs9hs_3",Qr="_innerContainer_vs9hs_18",Yr="_divider_vs9hs_33",Pr="_searchInput_vs9hs_53",$r="_searchInfo_vs9hs_58",Fr="_label_vs9hs_66",Br="_searchTool_vs9hs_77",Wr="_searchEngine_vs9hs_85",Gr="_textInputContainer_vs9hs_99",Zr="_iconContainer_vs9hs_110",Hr="_asteriskIcon_vs9hs_126",Vr="_searchButtonIcon_vs9hs_160",Xr="_searchButtonLabel_vs9hs_170",he={searcher:Ur,innerContainer:Qr,divider:Yr,searchInput:Pr,searchInfo:$r,label:Fr,searchTool:Br,searchEngine:Wr,textInputContainer:Gr,iconContainer:Zr,asteriskIcon:Hr,searchButtonIcon:Vr,searchButtonLabel:Xr},dt={google:{url:"https://suggestqueries.google.com/complete/search",buildUrl:e=>`https://suggestqueries.google.com/complete/search?client=chrome&q=${encodeURIComponent(e)}`,parseResponse:e=>Array.isArray(e)&&Array.isArray(e[1])?e[1]:[]},baidu:{url:"https://suggestion.baidu.com/su",buildUrl:e=>`https://suggestion.baidu.com/su?wd=${encodeURIComponent(e)}&action=opensearch`,parseResponse:e=>Array.isArray(e)&&Array.isArray(e[1])?e[1]:[]}};async function qr(e){const t=e.trim();if(!t)return[];if(typeof chrome<"u"&&chrome.permissions)try{if(!await new Promise(s=>{chrome.permissions.contains({origins:["https://suggestqueries.google.com/*"]},o=>{chrome.runtime&&chrome.runtime.lastError?s(!1):s(!!o)})}))return[]}catch{return[]}else return[];try{const n=await fetch(dt.google.buildUrl(t),{method:"GET",headers:{Accept:"application/json"}});if(n.ok){const s=await n.json(),o=dt.google.parseResponse(s);if(o.length>0)return o}}catch{}try{const n=await fetch(dt.baidu.buildUrl(t),{method:"GET"});if(n.ok){const s=await n.json();return dt.baidu.parseResponse(s)}}catch{}return[]}function Jr(e){const[t,n]=r.useState([]),[s,o]=r.useState(!1),[i,c]=r.useState(null),u=r.useRef(""),I=r.useRef(null),l=r.useCallback(async M=>{const m=M.trim();if(!m){n([]),c(null),u.current=`cleared_${Date.now()}`;return}const f=`req_${Date.now()}`;u.current=f,I.current&&I.current.abort(),I.current=new AbortController,o(!0),c(null);try{const g=await qr(m);u.current===f&&n(g)}catch(g){u.current===f&&(c(g instanceof Error?g:new Error("Failed to fetch suggestions")),n([]))}finally{u.current===f&&o(!1)}},[]);return r.useEffect(()=>{const M=setTimeout(()=>{l(e)},300);return()=>{clearTimeout(M)}},[e,l]),r.useEffect(()=>()=>{I.current&&I.current.abort()},[]),{suggestions:t,isLoading:s,error:i}}const Kr={en:{settings:{position:"Position",center:"Center",bottom:"Bottom",iconSize:"Icon Size",large:"Large",small:"Small",suggestions:"Suggestions",on:"On",off:"Off",language:"Language",followSystem:"Follow System",lightTheme:"Light Theme",darkTheme:"Dark Theme",defaultTheme:"Default Theme",noTexture:"No Texture"},search:{searchBy:"Search by",searchBySuffix:"",searchButton:"Search",systemDefault:"System Default"},contextMenu:{addSticker:"Add Sticker",uploadImage:"Upload Image",editMode:"Edit Mode",exitEditMode:"Exit Edit Mode",settings:"Settings",copyImage:"Copy Image",exportImage:"Export Image",copyText:"Copy Text",editSticker:"Edit Sticker",exportAsImage:"Export as Image",deleteSticker:"Delete Sticker",edit:"Edit",delete:"Delete"},modal:{edit:"Edit",addNew:"Add new",address:"Address",name:"Name",icon:"Icon",getFromWebsite:"Get from website",useTextIcon:"Use Text Icon",uploadNewIcon:"Upload new icon",cancel:"Cancel",save:"Save",add:"Add"},space:{title:"Space",addSpace:"Add space",renameSpace:"Rename Space",rename:"Rename",deleteSpace:"Delete space",importSpace:"Import Space",exportSpace:"Export current space",exportAllSpaces:"Export All Space",pinToTop:"Pin to Top",alreadyAtTop:"Already at the top",deleteConfirm:`Are you sure you want to delete the space "{name}"?
All applications in this space will be deleted.`,importFailed:"Import failed: ",inputName:"Input space name",confirm:"Confirm",tooltip:"Current space",switch:"Left click: Switch space",manage:"Right click: Manage space"},textInput:{placeholder:"Enter text...",s:"S",m:"M",l:"L",cancel:"Cancel",confirm:"Confirm"}},zh:{settings:{position:"布局位置",center:"居中",bottom:"底部",iconSize:"图标大小",large:"大",small:"小",suggestions:"搜索建议",on:"开启",off:"关闭",language:"语言设置",followSystem:"跟随系统",lightTheme:"浅色模式",darkTheme:"深色模式",defaultTheme:"默认主题",noTexture:"无纹理"},search:{searchBy:"使用",searchBySuffix:"",searchButton:"搜索",systemDefault:"系统默认"},contextMenu:{addSticker:"添加贴纸",uploadImage:"上传图片",editMode:"编辑模式",exitEditMode:"退出编辑",settings:"设置",copyImage:"复制图片",exportImage:"导出图片",copyText:"复制文本",editSticker:"编辑贴纸",exportAsImage:"导出为图片",deleteSticker:"删除贴纸",edit:"编辑",delete:"删除"},modal:{edit:"编辑",addNew:"添加新项",address:"网址地址",name:"名称",icon:"图标",getFromWebsite:"获取网站图标",useTextIcon:"使用文字图标",uploadNewIcon:"上传新图标",cancel:"取消",save:"保存",add:"添加"},space:{title:"空间",addSpace:"添加空间",renameSpace:"重命名空间",rename:"重命名",deleteSpace:"删除空间",importSpace:"导入空间",exportSpace:"导出当前空间",exportAllSpaces:"导出所有空间",pinToTop:"置顶空间",alreadyAtTop:"已在顶部",deleteConfirm:`确定要删除空间 "{name}" 吗？
该空间下的所有应用都将被删除。`,importFailed:"导入失败：",inputName:"输入空间名称",confirm:"确认",tooltip:"当前空间",switch:"左键：切换空间",manage:"右键：管理空间"},textInput:{placeholder:"输入文本...",s:"小",m:"中",l:"大",cancel:"取消",confirm:"确认"}}},Ln=r.createContext(void 0),es=({children:e})=>{const[t,n]=r.useState(()=>{const o=localStorage.getItem("app_language");return o==="en"||o==="zh"?o:navigator.language.toLowerCase().startsWith("zh")?"zh":"en"});r.useEffect(()=>{localStorage.setItem("app_language",t)},[t]);const s={language:t,setLanguage:n,t:Kr[t]};return a.jsx(Ln.Provider,{value:s,children:e})},Ke=()=>{const e=r.useContext(Ln);if(!e)throw new Error("useLanguage must be used within a LanguageProvider");return e},ts="_suggestionsList_8p83l_1",ns="_suggestionItem_8p83l_35",rs="_active_8p83l_63",ss="_suggestionText_8p83l_71",gt={suggestionsList:ts,suggestionItem:ns,active:rs,suggestionText:ss},Xe=(e,t=300)=>{e.style.transition="none",e.style.opacity="0",e.style.transform="scale(0.9)",e.style.filter="blur(5px)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`opacity ${t}ms cubic-bezier(0.23, 1, 0.32, 1), transform ${t}ms cubic-bezier(0.23, 1, 0.32, 1), filter ${t}ms cubic-bezier(0.23, 1, 0.32, 1)`,e.style.opacity="1",e.style.transform="scale(1)",e.style.filter="blur(0)",setTimeout(()=>{e.style.transform="",e.style.filter="",e.style.transition=""},t)})})},Pe=(e,t=300,n)=>{e.style.transition="none",e.style.opacity="1",e.style.transform="scale(1)",e.style.filter="blur(0)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`opacity ${t}ms cubic-bezier(0.755, 0.05, 0.855, 0.06), transform ${t}ms cubic-bezier(0.755, 0.05, 0.855, 0.06), filter ${t}ms cubic-bezier(0.755, 0.05, 0.855, 0.06)`,e.style.opacity="0",e.style.transform="scale(0.9)",e.style.filter="blur(5px)",n&&setTimeout(n,t)})})},os=({suggestions:e,activeIndex:t,onSelect:n,onHover:s,isExiting:o=!1,anchorRect:i})=>{const c=r.useRef(null),[u,I]=r.useState({});return r.useEffect(()=>{i&&I({position:"fixed",left:`${i.left}px`,bottom:`${window.innerHeight-i.top}px`,width:`${i.width}px`})},[i]),r.useEffect(()=>{c.current&&!o&&Xe(c.current)},[]),r.useEffect(()=>{o&&c.current&&Pe(c.current,300)},[o]),e.length===0||!i?null:Ye.createPortal(a.jsx("ul",{ref:c,className:gt.suggestionsList,style:u,children:e.map((l,M)=>a.jsx("li",{className:`${gt.suggestionItem} ${M===t?gt.active:""}`,onClick:()=>n(l),onMouseEnter:()=>s(M),children:a.jsx("span",{className:gt.suggestionText,children:l})},M))}),document.body)},as=({searchEngine:e,onSearch:t,onSearchEngineClick:n,containerStyle:s})=>{const[o,i]=r.useState(""),[c,u]=r.useState(!1),[I,l]=r.useState(-1),M=r.useRef(null),{suggestions:m}=Jr(o),f=c&&m.length>0,[g,d]=r.useState(!1),[D,y]=r.useState(!1);r.useEffect(()=>{if(f)d(!0),y(!1);else if(g){y(!0);const T=setTimeout(()=>{d(!1),y(!1)},300);return()=>clearTimeout(T)}},[f,g]),r.useEffect(()=>{M.current?.focus()},[]),r.useEffect(()=>{l(-1)},[m]);const x=T=>{if(T.trim()){try{const U=new URL(T);window.open(U.toString(),"_blank")}catch{t(T)}i(""),u(!1)}},Y=T=>{T.preventDefault(),x(o)},O=T=>{if(g&&m.length>0){if(T.key==="ArrowDown"){T.preventDefault(),l(U=>(U+1)%m.length);return}if(T.key==="ArrowUp"){T.preventDefault(),l(U=>(U-1+m.length)%m.length);return}}T.key==="Enter"&&(T.preventDefault(),I>=0&&m[I]&&g?x(m[I]):x(o))},P=r.useRef(null),[F,E]=r.useState(null);r.useEffect(()=>{if(g&&P.current){const T=P.current.getBoundingClientRect();E(T)}},[g,m]);const{t:k}=Ke();return a.jsxs("header",{ref:P,className:he.searcher,style:s,children:[g&&m.length>0&&a.jsx(os,{suggestions:m,activeIndex:I,onSelect:T=>x(T),onHover:T=>l(T),isExiting:D,anchorRect:F}),a.jsxs("div",{className:he.innerContainer,children:[a.jsx("div",{className:he.divider}),a.jsxs("div",{className:he.searchInfo,children:[a.jsx("p",{className:he.label,children:k.search.searchBy}),a.jsx("div",{className:he.searchTool,children:a.jsxs("p",{className:he.searchEngine,onClick:T=>{const U=T.currentTarget.getBoundingClientRect();n(U)},children:[e.id==="default"?k.search.systemDefault:e.name,k.search.searchBySuffix]})})]}),a.jsx("div",{className:he.textInputContainer,children:a.jsx("input",{ref:M,type:"text",className:he.searchInput,placeholder:"",value:o,onChange:T=>i(T.target.value),onKeyDown:O,onFocus:()=>u(!0),onBlur:()=>{setTimeout(()=>u(!1),200)}})}),a.jsxs("div",{className:he.iconContainer,onClick:Y,children:[a.jsx("div",{className:he.asteriskIcon,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M8.25 3.00002C7.05653 3.00002 5.91193 3.47412 5.06802 4.31803C4.22411 5.16194 3.75 6.30654 3.75 7.50001C3.75 8.69349 4.22411 9.83808 5.06802 10.682C5.91193 11.5259 7.05653 12 8.25 12C9.44347 12 10.5881 11.5259 11.432 10.682C12.2759 9.83808 12.75 8.69349 12.75 7.50001C12.75 6.30654 12.2759 5.16194 11.432 4.31803C10.5881 3.47412 9.44347 3.00002 8.25 3.00002ZM2.25 7.50001C2.25014 6.54516 2.47816 5.60412 2.91513 4.75512C3.3521 3.90611 3.98538 3.17366 4.76235 2.61862C5.53933 2.06359 6.43755 1.70201 7.38237 1.56393C8.32719 1.42586 9.29132 1.51527 10.1946 1.82474C11.0979 2.13422 11.9144 2.65481 12.576 3.34326C13.2377 4.03171 13.7254 4.86814 13.9988 5.78302C14.2722 6.6979 14.3233 7.66482 14.1478 8.60342C13.9724 9.54201 13.5754 10.4252 12.99 11.1795L17.0303 15.2198C17.1669 15.3612 17.2425 15.5507 17.2408 15.7473C17.239 15.944 17.1602 16.1321 17.0211 16.2711C16.8821 16.4102 16.6939 16.4891 16.4973 16.4908C16.3007 16.4925 16.1112 16.4169 15.9698 16.2803L11.9295 12.24C11.0426 12.9286 9.98027 13.3545 8.86332 13.4692C7.74638 13.584 6.61964 13.3831 5.61124 12.8893C4.60283 12.3955 3.75322 11.6286 3.15902 10.6759C2.56482 9.72317 2.24988 8.62284 2.25 7.50001Z",fill:"currentColor"}),a.jsx("path",{d:"M2.25 7.50001C2.25014 6.54516 2.47816 5.60412 2.91513 4.75512C3.3521 3.90611 3.98538 3.17366 4.76235 2.61862C5.53933 2.06359 6.43755 1.70201 7.38237 1.56393C8.32719 1.42586 9.29132 1.51527 10.1946 1.82474C11.0979 2.13422 11.9144 2.65481 12.576 3.34326C13.2377 4.03171 13.7254 4.86814 13.9988 5.78302C14.2722 6.6979 14.3233 7.66482 14.1478 8.60342C13.9724 9.54201 13.5754 10.4252 12.99 11.1795L17.0303 15.2198C17.1669 15.3612 17.2425 15.5507 17.2408 15.7473C17.239 15.944 17.1602 16.1321 17.0211 16.2711C16.8821 16.4102 16.6939 16.4891 16.4973 16.4908C16.3007 16.4925 16.1112 16.4169 15.9698 16.2803L11.9295 12.24C11.0426 12.9286 9.98027 13.3545 8.86332 13.4692C7.74638 13.584 6.61964 13.3831 5.61124 12.8893C4.60283 12.3955 3.75322 11.6286 3.15902 10.6759C2.56482 9.72317 2.24988 8.62284 2.25 7.50001ZM8.25 3.00002C7.65905 3.00002 7.07389 3.11641 6.52792 3.34255C5.98196 3.5687 5.48588 3.90017 5.06802 4.31803C4.65016 4.73589 4.31869 5.23197 4.09254 5.77794C3.8664 6.3239 3.75 6.90906 3.75 7.50001C3.75 8.09096 3.8664 8.67612 4.09254 9.22209C4.31869 9.76805 4.65016 10.2641 5.06802 10.682C5.48588 10.9999 5.98196 11.4313 6.52792 11.6575C7.07389 11.8836 7.65905 12 8.25 12C9.44347 12 10.5881 11.5259 11.432 10.682C12.2759 9.83808 12.75 8.69349 12.75 7.50001C12.75 6.30654 12.2759 5.16194 11.432 4.31803C10.5881 3.47412 9.44347 3.00002 8.25 3.00002Z",fill:"currentColor"})]})}),a.jsx("p",{className:he.searchButtonLabel,children:k.search.searchButton}),a.jsx("div",{className:he.searchButtonIcon,children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M15 2.25C15.1989 2.25 15.3897 2.32902 15.5303 2.46967C15.671 2.61032 15.75 2.80109 15.75 3V4.083C15.75 5.31525 15.75 6.28575 15.6863 7.0665C15.6211 7.86375 15.4861 8.529 15.1778 9.1335C14.7043 10.1214 13.9009 10.9246 12.9128 11.4278C12.3083 11.7353 11.6431 11.871 10.8458 11.9363C10.0651 12 9.09461 12 7.86236 12H4.83986L7.30961 14.4697C7.4463 14.6112 7.52189 14.8007 7.52019 14.9973C7.51848 15.1939 7.43959 15.3821 7.30054 15.5211C7.16148 15.6602 6.97338 15.739 6.77672 15.7408C6.58007 15.7425 6.39062 15.6669 6.24911 15.5302L2.49911 11.7802C2.35851 11.6396 2.27952 11.4488 2.27952 11.25C2.27952 11.0511 2.35851 10.8604 2.49911 10.7197L6.24911 6.96975C6.39062 6.83313 6.58007 6.75754 6.77672 6.75924C6.97338 6.76095 7.16148 6.83983 7.30054 6.97889C7.43959 7.11794 7.51848 7.30605 7.52019 7.5027C7.52189 7.69935 7.4463 7.8888 7.30961 8.03025L4.83986 10.5H7.82936C9.10211 10.5 10.0111 10.5 10.7243 10.4415C11.4278 10.3837 11.8741 10.2735 12.2318 10.0913C12.9373 9.73173 13.5109 9.15808 13.8705 8.4525C14.0528 8.09475 14.1631 7.6485 14.2208 6.945C14.2786 6.23175 14.2793 5.32275 14.2793 4.05V3C14.2793 2.80109 14.3583 2.61032 14.499 2.46967C14.6396 2.32902 14.8304 2.25 15.0293 2.25H15Z",fill:"currentColor"})})})]})]})]})},is="_tooltipContainer_g1t8v_3",cs="_tooltipFadeIn_g1t8v_1",ls="_fadeOut_g1t8v_24",us="_tooltipFadeOut_g1t8v_1",Kt={tooltipContainer:is,tooltipFadeIn:cs,fadeOut:ls,tooltipFadeOut:us},ds=({text:e,targetRef:t})=>{const[n,s]=r.useState(null),[o,i]=r.useState(!1);if(r.useEffect(()=>{const u=()=>{if(t.current){const I=t.current.getBoundingClientRect(),l=window.innerHeight-I.top+8;s({bottom:l,left:I.left+I.width/2})}};return u(),window.addEventListener("resize",u),window.addEventListener("scroll",u,!0),()=>{window.removeEventListener("resize",u),window.removeEventListener("scroll",u,!0)}},[t]),r.useEffect(()=>()=>{i(!0)},[]),!n)return null;const c={left:n.left,bottom:n.bottom,transform:"translateX(-50%)"};return Ye.createPortal(a.jsx("div",{className:`${Kt.tooltipContainer} ${o?Kt.fadeOut:""}`,style:c,children:e}),document.body)},gs="_dockItem_1bzk0_9",Ms="_jiggle_1bzk0_1",Is="_pulse_1bzk0_315",fs="_iconContainer_1bzk0_29",ms="_editOverlay_1bzk0_53",Ds="_editOverlayVisible_1bzk0_87",ps="_editIcon_1bzk0_99",xs="_nonFolderBg_1bzk0_129",ys="_hovered_1bzk0_139",hs="_icon_1bzk0_29",Ns="_folderIcon_1bzk0_167",js="_folderIconTile_1bzk0_193",Ts="_fallbackIcon_1bzk0_225",As="_deleteButton_1bzk0_239",Es="_dropTarget_1bzk0_291",Cs="_editMode_1bzk0_305",ge={dockItem:gs,jiggle:Ms,pulse:Is,iconContainer:fs,editOverlay:ms,editOverlayVisible:Ds,editIcon:ps,nonFolderBg:xs,hovered:ys,icon:hs,folderIcon:Ns,folderIconTile:js,fallbackIcon:Ts,deleteButton:As,dropTarget:Es,editMode:Cs},$e="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJDMTIuNTUyMyAyIDEzIDIuNDQ3NzIgMTMgM0MxMyAzLjU1MjI5IDEyLjU1MjMgNCAxMiA0SDcuNzk5ODFDNi45NDM0MiA0IDYuMzYxMTcgNC4wMDAzNSA1LjkxMTEzIDQuMDM3MTFDNS40NzI3MiA0LjA3MjkzIDUuMjQ4MiA0LjEzODA5IDUuMDkxOCA0LjIxNzc4QzQuNzE1NTUgNC40MDk1MSA0LjQwOTUxIDQuNzE1NTUgNC4yMTc3OCA1LjA5MThDNC4xMzgwOSA1LjI0ODIgNC4wNzI5MyA1LjQ3MjcyIDQuMDM3MTEgNS45MTExM0M0LjAwMDM1IDYuMzYxMTcgNCA2Ljk0MzQyIDQgNy43OTk4MVYxNi4yMDAyQzQgMTcuMDU2NiA0LjAwMDM1IDE3LjYzODggNC4wMzcxMSAxOC4wODg5QzQuMDcyOTMgMTguNTI3MyA0LjEzODA5IDE4Ljc1MTggNC4yMTc3OCAxOC45MDgyQzQuNDA5NTEgMTkuMjg0NSA0LjcxNTU1IDE5LjU5MDUgNS4wOTE4IDE5Ljc4MjJDNS4yNDgyIDE5Ljg2MTkgNS40NzI3MiAxOS45MjcxIDUuOTExMTMgMTkuOTYyOUM2LjM2MTE3IDE5Ljk5OTcgNi45NDM0MiAyMCA3Ljc5OTgxIDIwSDE2LjIwMDJDMTcuMDU2NiAyMCAxNy42Mzg4IDE5Ljk5OTcgMTguMDg4OSAxOS45NjI5QzE4LjUyNzMgMTkuOTI3MSAxOC43NTE4IDE5Ljg2MTkgMTguOTA4MiAxOS43ODIyQzE5LjI4NDUgMTkuNTkwNSAxOS41OTA1IDE5LjI4NDUgMTkuNzgyMiAxOC45MDgyQzE5Ljg2MTkgMTguNzUxOCAxOS45MjcxIDE4LjUyNzMgMTkuOTYyOSAxOC4wODg5QzE5Ljk5OTcgMTcuNjM4OCAyMCAxNy4wNTY2IDIwIDE2LjIwMDJWMTJDMjAgMTEuNDQ3NyAyMC40NDc3IDExIDIxIDExQzIxLjU1MjMgMTEgMjIgMTEuNDQ3NyAyMiAxMlYxNi4yMDAyQzIyIDE3LjAyMzcgMjIuMDAxIDE3LjcwMTYgMjEuOTU2MSAxOC4yNTJDMjEuOTEwMSAxOC44MTQgMjEuODExNyAxOS4zMzExIDIxLjU2NDUgMTkuODE2NEMyMS4xODEgMjAuNTY4OSAyMC41Njg5IDIxLjE4MSAxOS44MTY0IDIxLjU2NDVDMTkuMzMxMSAyMS44MTE3IDE4LjgxNCAyMS45MTAxIDE4LjI1MiAyMS45NTYxQzE3LjcwMTYgMjIuMDAxIDE3LjAyMzcgMjIgMTYuMjAwMiAyMkg3Ljc5OTgxQzYuOTc2MzIgMjIgNi4yOTg0MyAyMi4wMDEgNS43NDgwNSAyMS45NTYxQzUuMTg1OTkgMjEuOTEwMSA0LjY2ODkgMjEuODExNyA0LjE4MzYgMjEuNTY0NUMzLjQzMTA5IDIxLjE4MSAyLjgxOTAyIDIwLjU2ODkgMi40MzU1NSAxOS44MTY0QzIuMTg4MjcgMTkuMzMxMSAyLjA4OTg4IDE4LjgxNCAyLjA0Mzk1IDE4LjI1MkMxLjk5ODk4IDE3LjcwMTYgMiAxNy4wMjM3IDIgMTYuMjAwMlY3Ljc5OTgxQzIgNi45NzYzMiAxLjk5ODk4IDYuMjk4NDMgMi4wNDM5NSA1Ljc0ODA1QzIuMDg5ODggNS4xODU5OSAyLjE4ODI3IDQuNjY4OSAyLjQzNTU1IDQuMTgzNkMyLjgxOTAyIDMuNDMxMDkgMy40MzEwOSAyLjgxOTAyIDQuMTgzNiAyLjQzNTU1QzQuNjY4OSAyLjE4ODI3IDUuMTg1OTkgMi4wODk4OCA1Ljc0ODA1IDIuMDQzOTVDNi4yOTg0MyAxLjk5ODk4IDYuOTc2MzIgMiA3Ljc5OTgxIDJIMTJaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjU0NTkgMi43Njc1OEMxOC41MjIxIDEuNzkxNDQgMjAuMTA0NyAxLjc5MTYgMjEuMDgxMSAyLjc2NzU4QzIyLjA1NzQgMy43NDM4OSAyMi4wNTc0IDUuMzI3NCAyMS4wODExIDYuMzAzNzFMMTEuODg4NyAxNS40OTYxQzEwLjkxMjQgMTYuNDcxOSA5LjMyOTcxIDE2LjQ3MjEgOC4zNTM1MiAxNS40OTYxQzcuMzc3MjEgMTQuNTE5OCA3LjM3NzIxIDEyLjkzNjMgOC4zNTM1MiAxMS45NkwxNy41NDU5IDIuNzY3NThaTTE5LjY2NyA0LjE4MTY0QzE5LjQ3MTcgMy45ODY3MSAxOS4xNTUxIDMuOTg2NTUgMTguOTYgNC4xODE2NEw5Ljc2NzU4IDEzLjM3NEM5LjU3MjQyIDEzLjU2OTIgOS41NzI2MiAxMy44ODU4IDkuNzY3NTggMTQuMDgxMUM5Ljk2Mjg0IDE0LjI3NjMgMTAuMjc5MyAxNC4yNzYzIDEwLjQ3NDYgMTQuMDgxMUwxOS42NjcgNC44ODg2N0MxOS44NjIyIDQuNjkzNDEgMTkuODYyMiA0LjM3Njg4IDE5LjY2NyA0LjE4MTY0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==",ks=({item:e,isEditMode:t,onClick:n,onEdit:s,onDelete:o,isDragging:i=!1,staggerIndex:c,isDropTarget:u=!1,isMergeTarget:I=!1,onLongPress:l,onMouseDown:M,onContextMenu:m})=>{const[f,g]=r.useState(!1),d=r.useRef(null),[D,y]=r.useState(null),x=r.useRef(!1),Y=()=>{if(x.current){x.current=!1;return}const w=d.current?.getBoundingClientRect();t&&e.type!=="folder"?s(w):n(w)},O=w=>{w.stopPropagation(),o()},[P,F]=r.useState(!1),E=r.useRef(null),k=()=>{g(!0),!i&&!t&&(E.current=window.setTimeout(()=>{F(!0)},1e3))},T=()=>{g(!1),D&&(clearTimeout(D),y(null)),E.current&&(clearTimeout(E.current),E.current=null),F(!1)},U=w=>{if(E.current&&(clearTimeout(E.current),E.current=null),F(!1),M&&M(w),x.current=!1,l&&!t){const _=window.setTimeout(()=>{x.current=!0,l()},600);y(_)}},p=w=>{if(w.preventDefault(),w.stopPropagation(),m&&d.current){const _=d.current.getBoundingClientRect();m(w.clientX,w.clientY,_)}},N=Ne.useMemo(()=>{let w=0;for(let _=0;_<e.id.length;_++)w=(w<<5)-w+e.id.charCodeAt(_),w|=0;return`${-(Math.abs(w)%1e3)}ms`},[e.id]);return a.jsxs("div",{className:`${ge.dockItem} ${t?ge.editMode:""} ${i?ge.dragging:""} ${u?ge.dropTarget:""} ${I?ge.pulse:""}`,style:{animationDelay:N},onClick:Y,onContextMenu:p,onMouseEnter:k,onMouseLeave:T,ref:d,onMouseDown:U,onMouseUp:()=>{D&&(clearTimeout(D),y(null))},children:[a.jsxs("div",{className:`${ge.iconContainer} ${e.type!=="folder"?ge.nonFolderBg:""} ${f&&!t?ge.hovered:""}`,children:[t&&e.type!=="folder"&&a.jsx("div",{className:`${ge.editOverlay} ${f?ge.editOverlayVisible:""}`,children:a.jsx("img",{src:$e,alt:"edit",className:ge.editIcon})}),e.type==="folder"?a.jsx("div",{className:ge.folderIcon,children:e.items&&e.items.slice(0,4).map(w=>a.jsx("div",{className:ge.folderIconTile,children:w.icon?a.jsx("img",{src:w.icon,alt:w.name,loading:"lazy",decoding:"async"}):a.jsx("div",{className:ge.fallbackIcon})},w.id))}):a.jsx("img",{src:e.icon||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiByeD0iMTYiIGZpbGw9InJnYmEoMjU1LDI1NSwyNTUsMC4yKSIvPjwvc3ZnPg==",alt:e.name,className:ge.icon,loading:"lazy",decoding:"async"})]}),t&&a.jsx("button",{className:ge.deleteButton,onClick:O,"aria-label":"删除",children:"×"}),P&&a.jsx(ds,{text:e.name,targetRef:d})]})},ws=(e,t)=>e.item.id===t.item.id&&e.item.name===t.item.name&&e.item.icon===t.item.icon&&e.item.items?.length===t.item.items?.length&&e.isEditMode===t.isEditMode&&e.isDragging===t.isDragging&&e.isDropTarget===t.isDropTarget&&e.isMergeTarget===t.isMergeTarget&&e.staggerIndex===t.staggerIndex,On=Ne.memo(ks,ws),Ss="_addIcon_10ekk_5",bs="_icon_10ekk_30",en={addIcon:Ss,icon:bs},Ls=({onClick:e})=>{const t=n=>{const s=n.currentTarget.getBoundingClientRect();e(s)};return a.jsx("div",{className:en.addIcon,onClick:t,"data-add-icon":!0,children:a.jsx("div",{className:en.icon,children:a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M16 8V24M8 16H24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})})},Os="_navigator_63jq5_5",zs="_disabled_63jq5_75",vs="_spaceName_63jq5_89",_s="_dots_63jq5_119",Rs="_dot_63jq5_119",Us="_dotActive_63jq5_153",We={navigator:Os,disabled:zs,spaceName:vs,dots:_s,dot:Rs,dotActive:Us};function Qs({currentSpace:e,totalSpaces:t,currentIndex:n,onSwitch:s,onContextMenu:o,disabled:i=!1}){const{t:c}=Ke(),u=l=>{l.preventDefault(),l.stopPropagation(),!i&&t>1&&s()},I=l=>{l.preventDefault(),l.stopPropagation(),o(l)};return a.jsxs("div",{className:`${We.navigator} ${i?We.disabled:""}`,onClick:u,onContextMenu:I,title:`${c.space.tooltip}: ${e.name}
${c.space.switch}
${c.space.manage}`,children:[a.jsx("span",{className:We.spaceName,children:e.name}),t>1&&a.jsx("div",{className:We.dots,children:Array.from({length:t}).map((l,M)=>a.jsx("span",{className:`${We.dot} ${M===n?We.dotActive:""}`},M))})]})}const Ys="_contextMenu_1vwmr_7",Ps="_menuLabel_1vwmr_43",$s="_menuDivider_1vwmr_69",Fs="_menuOptions_1vwmr_107",Bs="_menuItem_1vwmr_123",Ws="_danger_1vwmr_185",Gs="_menuIcon_1vwmr_203",we={contextMenu:Ys,menuLabel:Ps,menuDivider:$s,menuOptions:Fs,menuItem:Bs,danger:Ws,menuIcon:Gs},qe="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2Ljg4ODkgNS41OTUxMkw0LjE0NjcxIDE4LjMzODNDMy45NTE2IDE4LjUzMzQgMy45NTE5IDE4Ljg1IDQuMTQ2NzEgMTkuMDQ1M0M0LjM0MTk5IDE5LjI0MDMgNC42NTg1NiAxOS4yNDA1IDQuODUzNzQgMTkuMDQ1M0wxNy41OTU5IDYuMzAyMTVMMTkuMDExIDcuNzE3MTlMNi4yNjc4IDIwLjQ2MDRDNS4yOTE2MSAyMS40MzYxIDMuNzA4ODYgMjEuNDM2MSAyLjczMjY1IDIwLjQ2MDRDMS43NTY0OCAxOS40ODQgMS43NTYzOSAxNy45MDA1IDIuNzMyNjUgMTYuOTI0MkwxNS40NzQ4IDQuMTgxMDZMMTYuODg4OSA1LjU5NTEyWiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTIxLjAwMDIgMTkuMDAwNEMyMS41NTI0IDE5LjAwMDUgMjIuMDAwMiAxOS40NDgyIDIyLjAwMDIgMjAuMDAwNEMyMiAyMC41NTI0IDIxLjU1MjMgMjEuMDAwMyAyMS4wMDAyIDIxLjAwMDRIOS41MDAyM0M4Ljk0ODA3IDIxLjAwMDQgOC41MDA0NCAyMC41NTI1IDguNTAwMjMgMjAuMDAwNEM4LjUwMDIzIDE5LjQ0ODEgOC45NDc5NCAxOS4wMDA0IDkuNTAwMjMgMTkuMDAwNEgyMS4wMDAyWiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTE2LjkyNSAyLjczMTg0QzE3LjkwMTIgMS43NTYwNyAxOS40ODQgMS43NTYxMSAyMC40NjAyIDIuNzMxODRDMjEuNDM2MSAzLjcwODA3IDIxLjQzNjEgNS4yOTE3MiAyMC40NjAyIDYuMjY3OTdMMTkuNzE4IDcuMDEwMTZMMTguMzAzIDUuNTk1MTJMMTkuMDQ2MSA0Ljg1Mjk0QzE5LjI0MDkgNC42NTc3MyAxOS4yNDEgNC4zNDEwNiAxOS4wNDYxIDQuMTQ1OUMxOC44NTEgMy45NTEyMiAxOC41MzQyIDMuOTUxMTggMTguMzM5MSA0LjE0NTlMMTcuNTk1OSA0Ljg4ODA5TDE2LjE4MTkgMy40NzQwM0wxNi45MjUgMi43MzE4NFoiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=",Je="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE5IDdDMTkuNTUyMyA3IDIwIDcuNDQ3NzIgMjAgOFYxNy4yMDAyQzIwIDE4LjAyMzcgMjAuMDAxIDE4LjcwMTYgMTkuOTU2MSAxOS4yNTJDMTkuOTEwMSAxOS44MTQgMTkuODExNyAyMC4zMzExIDE5LjU2NDUgMjAuODE2NEMxOS4xODEgMjEuNTY4OSAxOC41Njg5IDIyLjE4MSAxNy44MTY0IDIyLjU2NDVDMTcuMzMxMSAyMi44MTE3IDE2LjgxNCAyMi45MTAxIDE2LjI1MiAyMi45NTYxQzE1LjcwMTYgMjMuMDAxIDE1LjAyMzcgMjMgMTQuMjAwMiAyM0g5Ljc5OThDOC45NzYzMSAyMyA4LjI5ODQzIDIzLjAwMSA3Ljc0ODA1IDIyLjk1NjFDNy4xODU5OSAyMi45MTAxIDYuNjY4OSAyMi44MTE3IDYuMTgzNTkgMjIuNTY0NUM1LjQzMTA5IDIyLjE4MSA0LjgxOTAyIDIxLjU2ODkgNC40MzU1NSAyMC44MTY0QzQuMTg4MjcgMjAuMzMxMSA0LjA4OTg3IDE5LjgxNCA0LjA0Mzk1IDE5LjI1MkMzLjk5ODk4IDE4LjcwMTYgNCAxOC4wMjM3IDQgMTcuMjAwMlY4QzQgNy40NDc3MiA0LjQ0NzcyIDcgNSA3QzUuNTUyMjggNyA2IDcuNDQ3NzIgNiA4VjE3LjIwMDJDNiAxOC4wNTY2IDYuMDAwMzUgMTguNjM4OCA2LjAzNzExIDE5LjA4ODlDNi4wNzI5MyAxOS41MjczIDYuMTM4MDggMTkuNzUxOCA2LjIxNzc3IDE5LjkwODJDNi40MDk1MSAyMC4yODQ1IDYuNzE1NTQgMjAuNTkwNSA3LjA5MTggMjAuNzgyMkM3LjI0ODIgMjAuODYxOSA3LjQ3MjcyIDIwLjkyNzEgNy45MTExMyAyMC45NjI5QzguMzYxMTcgMjAuOTk5NyA4Ljk0MzQxIDIxIDkuNzk5OCAyMUgxNC4yMDAyQzE1LjA1NjYgMjEgMTUuNjM4OCAyMC45OTk3IDE2LjA4ODkgMjAuOTYyOUMxNi41MjczIDIwLjkyNzEgMTYuNzUxOCAyMC44NjE5IDE2LjkwODIgMjAuNzgyMkMxNy4yODQ1IDIwLjU5MDUgMTcuNTkwNSAyMC4yODQ1IDE3Ljc4MjIgMTkuOTA4MkMxNy44NjE5IDE5Ljc1MTggMTcuOTI3MSAxOS41MjczIDE3Ljk2MjkgMTkuMDg4OUMxNy45OTk3IDE4LjYzODggMTggMTguMDU2NiAxOCAxNy4yMDAyVjhDMTggNy40NDc3MiAxOC40NDc3IDcgMTkgN1oiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik04LjUgMTBDOS4wNTIyOCAxMCA5LjUgMTAuNDQ3NyA5LjUgMTFWMThDOS41IDE4LjU1MjMgOS4wNTIyOCAxOSA4LjUgMTlDNy45NDc3MiAxOSA3LjUgMTguNTUyMyA3LjUgMThWMTFDNy41IDEwLjQ0NzcgNy45NDc3MiAxMCA4LjUgMTBaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMTIgMTBDMTIuNTUyMyAxMCAxMyAxMC40NDc3IDEzIDExVjE4QzEzIDE4LjU1MjMgMTIuNTUyMyAxOSAxMiAxOUMxMS40NDc3IDE5IDExIDE4LjU1MjMgMTEgMThWMTFDMTEgMTAuNDQ3NyAxMS40NDc3IDEwIDEyIDEwWiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTE1LjUgMTBDMTYuMDUyMyAxMCAxNi41IDEwLjQ0NzcgMTYuNSAxMVYxOEMxNi41IDE4LjU1MjMgMTYuMDUyMyAxOSAxNS41IDE5QzE0Ljk0NzcgMTkgMTQuNSAxOC41NTIzIDE0LjUgMThWMTFDMTQuNSAxMC40NDc3IDE0Ljk0NzcgMTAgMTUuNSAxMFoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0yMSA0QzIxLjU1MjMgNCAyMiA0LjQ0NzcyIDIyIDVDMjIgNS41NTIyOCAyMS41NTIzIDYgMjEgNkgzQzIuNDQ3NzIgNiAyIDUuNTUyMjggMiA1QzIgNC40NDc3MiAyLjQ0NzcyIDQgMyA0SDIxWiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTE0IDFDMTQuNTUyMyAxIDE1IDEuNDQ3NzIgMTUgMkMxNSAyLjU1MjI4IDE0LjU1MjMgMyAxNCAzSDEwQzkuNDQ3NzIgMyA5IDIuNTUyMjggOSAyQzkgMS40NDc3MiA5LjQ0NzcyIDEgMTAgMUgxNFoiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=",Zs=({x:e,y:t,item:n,isEditMode:s,onClose:o,onEdit:i,onToggleEditMode:c,onDelete:u})=>{const{t:I}=Ke(),l=r.useRef(null),M=r.useRef(!1),m=r.useCallback(()=>{M.current||(M.current=!0,l.current?Pe(l.current,200,()=>{o()}):o())},[o]);r.useEffect(()=>{M.current=!1,l.current&&Xe(l.current)},[e,t]),r.useEffect(()=>{const x=Y=>{Y.button!==2&&l.current&&!l.current.contains(Y.target)&&m()};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[m]),r.useEffect(()=>{const x=Y=>Y.preventDefault();return document.addEventListener("contextmenu",x),()=>document.removeEventListener("contextmenu",x)},[]);const f=180,g=160,d=10;let D=e,y=t;return e+f+d>window.innerWidth&&(D=window.innerWidth-f-d),D<d&&(D=d),t+g+d>window.innerHeight&&(y=window.innerHeight-g-d),y<d&&(y=d),Ye.createPortal(a.jsxs("div",{ref:l,className:we.contextMenu,style:{left:D,top:y},onClick:x=>x.stopPropagation(),children:[a.jsx("div",{className:we.menuLabel,children:n.name}),a.jsx("div",{className:we.menuDivider}),a.jsxs("div",{className:we.menuOptions,children:[n.type!=="folder"&&a.jsxs("button",{className:we.menuItem,onClick:()=>{i(),m()},children:[a.jsx("span",{className:we.menuIcon,style:{WebkitMaskImage:`url(${qe})`,maskImage:`url(${qe})`}}),a.jsx("span",{children:I.contextMenu.edit})]}),a.jsxs("button",{className:we.menuItem,onClick:()=>{c(),m()},children:[a.jsx("span",{className:we.menuIcon,style:{WebkitMaskImage:`url(${$e})`,maskImage:`url(${$e})`}}),a.jsx("span",{children:s?I.contextMenu.exitEditMode:I.contextMenu.editMode})]}),a.jsxs("button",{className:`${we.menuItem} ${we.danger}`,onClick:()=>{u(),m()},children:[a.jsx("span",{className:we.menuIcon,style:{WebkitMaskImage:`url(${Je})`,maskImage:`url(${Je})`}}),a.jsx("span",{children:I.contextMenu.delete})]})]})]}),document.body)},Hs="_backdrop_2f4fb_3",Vs="_container_2f4fb_17",Xs="_header_2f4fb_30",qs="_title_2f4fb_38",Js="_closeButton_2f4fb_47",Ks="_content_2f4fb_68",eo="_popoverRoot_2f4fb_76",to="_popover_2f4fb_76",no="_clickAway_2f4fb_93",Ae={backdrop:Hs,container:Vs,header:Xs,title:qs,closeButton:Js,content:Ks,popoverRoot:eo,popover:to,clickAway:no},ro=({isOpen:e,onClose:t,children:n,title:s,anchorRect:o,hideHeader:i,className:c})=>{const[u,I]=r.useState(e),l=r.useRef(null),M=r.useRef(!1);r.useEffect(()=>{e&&(M.current=!1,I(!0))},[e]),r.useLayoutEffect(()=>{e&&u&&l.current&&!M.current&&Xe(l.current)},[e,u]),r.useEffect(()=>{!e&&u&&!M.current&&(M.current=!0,l.current?Pe(l.current,300,()=>I(!1)):I(!1))},[e,u]);const m=g=>{g.target===g.currentTarget&&f()},f=()=>{M.current||(M.current=!0,l.current?Pe(l.current,300,()=>{I(!1),t()}):(I(!1),t()))};return u?o?Ye.createPortal(a.jsxs(a.Fragment,{children:[a.jsx("div",{"data-modal":"true",style:{position:"fixed",left:`${Math.min(Math.max(Math.round(o.left+o.width/2),160),window.innerWidth-160)}px`,top:`${Math.round(o.top-24)}px`,transform:"translate(-50%, -100%)",zIndex:2001,pointerEvents:"auto"},onClick:g=>g.stopPropagation(),children:a.jsxs("div",{ref:l,className:`${Ae.container} ${Ae.popover} ${c||""}`,style:{minWidth:"auto"},children:[!i&&s&&a.jsx("div",{className:Ae.header,children:a.jsx("h2",{className:Ae.title,children:s})}),a.jsx("div",{className:Ae.content,onClick:g=>g.stopPropagation(),children:n})]})}),a.jsx("div",{className:Ae.clickAway,onClick:f,style:{zIndex:2e3}})]}),document.body):a.jsx("div",{className:Ae.backdrop,onClick:m,children:a.jsxs("div",{ref:l,"data-modal":"true",className:`${Ae.container} ${c||""}`,onClick:g=>g.stopPropagation(),children:[s&&a.jsxs("div",{className:Ae.header,children:[a.jsx("h2",{className:Ae.title,children:s}),a.jsx("button",{className:Ae.closeButton,onClick:f,children:"×"})]}),a.jsx("div",{className:Ae.content,children:n})]})}):null},ft="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDRDMTIuMjY1MiA0IDEyLjUxOTYgNC4xMDUzNiAxMi43MDcxIDQuMjkyODlDMTIuODk0NiA0LjQ4MDQzIDEzIDQuNzM0NzggMTMgNVYxMUgxOUMxOS4yNjUyIDExIDE5LjUxOTYgMTEuMTA1NCAxOS43MDcxIDExLjI5MjlDMTkuODk0NiAxMS40ODA0IDIwIDExLjczNDggMjAgMTJDMjAgMTIuMjY1MiAxOS44OTQ2IDEyLjUxOTYgMTkuNzA3MSAxMi43MDcxQzE5LjUxOTYgMTIuODk0NiAxOS4yNjUyIDEzIDE5IDEzSDEzVjE5QzEzIDE5LjI2NTIgMTIuODk0NiAxOS41MTk2IDEyLjcwNzEgMTkuNzA3MUMxMi41MTk2IDE5Ljg5NDYgMTIuMjY1MiAyMCAxMiAyMEMxMS43MzQ4IDIwIDExLjQ4MDQgMTkuODk0NiAxMS4yOTI5IDE5LjcwNzFDMTEuMTA1NCAxOS41MTk2IDExIDE5LjI2NTIgMTEgMTlWMTNINUM0LjczNDc4IDEzIDQuNDgwNDMgMTIuODk0NiA0LjI5Mjg5IDEyLjcwNzFDNC4xMDUzNiAxMi41MTk2IDQgMTIuMjY1MiA0IDEyQzQgMTEuNzM0OCA0LjEwNTM2IDExLjQ4MDQgNC4yOTI4OSAxMS4yOTI5QzQuNDgwNDMgMTEuMTA1NCA0LjczNDc4IDExIDUgMTFIMTFWNUMxMSA0LjczNDc4IDExLjEwNTQgNC40ODA0MyAxMS4yOTI5IDQuMjkyODlDMTEuNDgwNCA0LjEwNTM2IDExLjczNDggNCAxMiA0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==",tn="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMi44NDM2IDIuMjkyODNDMTMuMjM0MSAxLjkwMjQzIDEzLjg2NzEgMS45MDIzNSAxNC4yNTc2IDIuMjkyODNMMjEuMjU3NiA5LjI5MjgzQzIxLjY0NzggOS42ODMzNCAyMS42NDc5IDEwLjMxNjQgMjEuMjU3NiAxMC43MDY5QzIwLjg2NzIgMTEuMDk3MyAyMC4yMzQxIDExLjA5NzIgMTkuODQzNiAxMC43MDY5TDE5LjY0NTMgMTAuNTA4N0wxMy44NjUgMTcuOTcxNUwxNC42NTcgMTguNzYzNUMxNS4wNDczIDE5LjE1NDEgMTUuMDQ3NSAxOS43ODcyIDE0LjY1NyAyMC4xNzc2QzE0LjI2NjYgMjAuNTY4IDEzLjYzMzUgMjAuNTY3OSAxMy4yNDMgMjAuMTc3Nkw4Ljk5ODgzIDE1LjkzNDRMMy43MDY4NCAyMS4yMjc0QzMuMzE2MzEgMjEuNjE3OSAyLjY4MzI4IDIxLjYxNzkgMi4yOTI3OCAyMS4yMjc0QzEuOTAyNDUgMjAuODM2OSAxLjkwMjM2IDIwLjIwMzggMi4yOTI3OCAxOS44MTMzTDcuNTg0NzcgMTQuNTIwNEwzLjM0MzU2IDEwLjI3ODJDMi45NTMwMyA5Ljg4NzY2IDIuOTUzMDMgOS4yNTQ2NSAzLjM0MzU2IDguODY0MTJDMy43MzQwOCA4LjQ3MzYgNC4zNjcxIDguNDczNiA0Ljc1NzYyIDguODY0MTJMNS41NTM1MiA5LjY2MDAyTDEzLjA4MjggMy45NDYxNUwxMi44NDM2IDMuNzA2ODlDMTIuNDUzIDMuMzE2MzcgMTIuNDUzIDIuNjgzMzYgMTIuODQzNiAyLjI5MjgzWk02Ljk4MjIzIDExLjA4ODdMMTIuNDQwMiAxNi41NDY3TDE4LjIyMDUgOS4wODM4NUwxNC41MTA1IDUuMzczODlMNi45ODIyMyAxMS4wODg3WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==",nn="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2LjIwMDIgMkMxNy4wMjM3IDIgMTcuNzAxNiAxLjk5ODk4IDE4LjI1MiAyLjA0Mzk0QzE4LjgxNCAyLjA4OTg3IDE5LjMzMTEgMi4xODgyNyAxOS44MTY0IDIuNDM1NTRDMjAuNTY4OSAyLjgxOTAxIDIxLjE4MSAzLjQzMTA5IDIxLjU2NDUgNC4xODM1OUMyMS44MTE3IDQuNjY4OSAyMS45MTAxIDUuMTg1OTkgMjEuOTU2MSA1Ljc0ODA0QzIyLjAwMSA2LjI5ODQyIDIyIDYuOTc2MzEgMjIgNy43OTk4VjE2LjIwMDJDMjIgMTcuMDIzNyAyMi4wMDEgMTcuNzAxNiAyMS45NTYxIDE4LjI1MkMyMS45MTAxIDE4LjgxNCAyMS44MTE3IDE5LjMzMTEgMjEuNTY0NSAxOS44MTY0QzIxLjE4MSAyMC41Njg5IDIwLjU2ODkgMjEuMTgxIDE5LjgxNjQgMjEuNTY0NUMxOS4zMzExIDIxLjgxMTcgMTguODE0IDIxLjkxMDEgMTguMjUyIDIxLjk1NjFDMTcuNzAxNiAyMi4wMDEgMTcuMDIzNyAyMiAxNi4yMDAyIDIySDcuNzk5ODFDNi45NzYzMiAyMiA2LjI5ODQzIDIyLjAwMSA1Ljc0ODA1IDIxLjk1NjFDNS4xODU5OSAyMS45MTAxIDQuNjY4OSAyMS44MTE3IDQuMTgzNiAyMS41NjQ1QzMuNDMxMDkgMjEuMTgxIDIuODE5MDIgMjAuNTY4OSAyLjQzNTU1IDE5LjgxNjRDMi4xODgyNyAxOS4zMzExIDIuMDg5ODggMTguODE0IDIuMDQzOTUgMTguMjUyQzEuOTk4OTggMTcuNzAxNiAyIDE3LjAyMzcgMiAxNi4yMDAyVjEyQzIgMTEuNDQ3NyAyLjQ0NzcyIDExIDMgMTFDMy41NTIyOSAxMSA0IDExLjQ0NzcgNCAxMlYxNi4yMDAyQzQgMTcuMDU2NiA0LjAwMDM1IDE3LjYzODggNC4wMzcxMSAxOC4wODg5QzQuMDcyOTMgMTguNTI3MyA0LjEzODA5IDE4Ljc1MTggNC4yMTc3OCAxOC45MDgyQzQuNDA5NTEgMTkuMjg0NSA0LjcxNTU1IDE5LjU5MDUgNS4wOTE4IDE5Ljc4MjJDNS4yNDgyIDE5Ljg2MTkgNS40NzI3MiAxOS45MjcxIDUuOTExMTMgMTkuOTYyOUM2LjM2MTE3IDE5Ljk5OTYgNi45NDM0MiAyMCA3Ljc5OTgxIDIwSDE2LjIwMDJDMTcuMDU2NiAyMCAxNy42Mzg4IDE5Ljk5OTYgMTguMDg4OSAxOS45NjI5QzE4LjUyNzMgMTkuOTI3MSAxOC43NTE4IDE5Ljg2MTkgMTguOTA4MiAxOS43ODIyQzE5LjI4NDUgMTkuNTkwNSAxOS41OTA1IDE5LjI4NDUgMTkuNzgyMiAxOC45MDgyQzE5Ljg2MTkgMTguNzUxOCAxOS45MjcxIDE4LjUyNzMgMTkuOTYyOSAxOC4wODg5QzE5Ljk5OTcgMTcuNjM4OCAyMCAxNy4wNTY2IDIwIDE2LjIwMDJWNy43OTk4QzIwIDYuOTQzNDEgMTkuOTk5NyA2LjM2MTE3IDE5Ljk2MjkgNS45MTExM0MxOS45MjcxIDUuNDcyNzIgMTkuODYxOSA1LjI0ODE5IDE5Ljc4MjIgNS4wOTE3OUMxOS41OTA1IDQuNzE1NTQgMTkuMjg0NSA0LjQwOTUxIDE4LjkwODIgNC4yMTc3N0MxOC43NTE4IDQuMTM4MDggMTguNTI3MyA0LjA3MjkzIDE4LjA4ODkgNC4wMzcxMUMxNy42Mzg4IDQuMDAwMzUgMTcuMDU2NiA0IDE2LjIwMDIgNEgxMkMxMS40NDc3IDQgMTEgMy41NTIyOCAxMSAzQzExIDIuNDQ3NzEgMTEuNDQ3NyAyIDEyIDJIMTYuMjAwMloiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0zLjI5Mjk3IDMuMjkyOTdDMy42ODM0OSAyLjkwMjQ0IDQuMzE2NTEgMi45MDI0NCA0LjcwNzAzIDMuMjkyOTdMMTMgMTEuNTg1OVY5QzEzIDguNDQ3NzIgMTMuNDQ3NyA4IDE0IDhDMTQuNTUyMyA4IDE1IDguNDQ3NzEgMTUgOVYxM0MxNSAxNC4xMDQ2IDE0LjEwNDYgMTUgMTMgMTVIOUM4LjQ0NzcyIDE1IDguMDAwMDEgMTQuNTUyMyA4IDE0QzggMTMuNDQ3NyA4LjQ0NzcyIDEzIDkgMTNIMTEuNTg1OUwzLjI5Mjk3IDQuNzA3MDNDMi45MDI0NSA0LjMxNjUgMi45MDI0NSAzLjY4MzQ5IDMuMjkyOTcgMy4yOTI5N1oiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=",Qe="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTExIDJDMTEuNTUyMyAyIDEyIDIuNDQ3NzEgMTIgM0MxMiAzLjU1MjI4IDExLjU1MjMgNCAxMSA0SDcuNzk5ODFDNi45NDM0MiA0IDYuMzYxMTcgNC4wMDAzNSA1LjkxMTEzIDQuMDM3MTFDNS40NzI3MiA0LjA3MjkzIDUuMjQ4MiA0LjEzODA4IDUuMDkxOCA0LjIxNzc3QzQuNzE1NTUgNC40MDk1MSA0LjQwOTUxIDQuNzE1NTQgNC4yMTc3OCA1LjA5MTc5QzQuMTM4MDkgNS4yNDgxOSA0LjA3MjkzIDUuNDcyNzIgNC4wMzcxMSA1LjkxMTEzQzQuMDAwMzUgNi4zNjExNyA0IDYuOTQzNDEgNCA3Ljc5OThWMTYuMjAwMkM0IDE3LjA1NjYgNC4wMDAzNSAxNy42Mzg4IDQuMDM3MTEgMTguMDg4OUM0LjA3MjkzIDE4LjUyNzMgNC4xMzgwOSAxOC43NTE4IDQuMjE3NzggMTguOTA4MkM0LjQwOTUxIDE5LjI4NDUgNC43MTU1NSAxOS41OTA1IDUuMDkxOCAxOS43ODIyQzUuMjQ4MiAxOS44NjE5IDUuNDcyNzIgMTkuOTI3MSA1LjkxMTEzIDE5Ljk2MjlDNi4zNjExNyAxOS45OTk2IDYuOTQzNDIgMjAgNy43OTk4MSAyMEgxNi4yMDAyQzE3LjA1NjYgMjAgMTcuNjM4OCAxOS45OTk2IDE4LjA4ODkgMTkuOTYyOUMxOC41MjczIDE5LjkyNzEgMTguNzUxOCAxOS44NjE5IDE4LjkwODIgMTkuNzgyMkMxOS4yODQ1IDE5LjU5MDUgMTkuNTkwNSAxOS4yODQ1IDE5Ljc4MjIgMTguOTA4MkMxOS44NjE5IDE4Ljc1MTggMTkuOTI3MSAxOC41MjczIDE5Ljk2MjkgMTguMDg4OUMxOS45OTk3IDE3LjYzODggMjAgMTcuMDU2NiAyMCAxNi4yMDAyVjEzQzIwIDEyLjQ0NzcgMjAuNDQ3NyAxMiAyMSAxMkMyMS41NTIzIDEyIDIyIDEyLjQ0NzcgMjIgMTNWMTYuMjAwMkMyMiAxNy4wMjM3IDIyLjAwMSAxNy43MDE2IDIxLjk1NjEgMTguMjUyQzIxLjkxMDEgMTguODE0IDIxLjgxMTcgMTkuMzMxMSAyMS41NjQ1IDE5LjgxNjRDMjEuMTgxIDIwLjU2ODkgMjAuNTY4OSAyMS4xODEgMTkuODE2NCAyMS41NjQ1QzE5LjMzMTEgMjEuODExNyAxOC44MTQgMjEuOTEwMSAxOC4yNTIgMjEuOTU2MUMxNy43MDE2IDIyLjAwMSAxNy4wMjM3IDIyIDE2LjIwMDIgMjJINy43OTk4MUM2Ljk3NjMyIDIyIDYuMjk4NDMgMjIuMDAxIDUuNzQ4MDUgMjEuOTU2MUM1LjE4NTk5IDIxLjkxMDEgNC42Njg5IDIxLjgxMTcgNC4xODM2IDIxLjU2NDVDMy40MzEwOSAyMS4xODEgMi44MTkwMiAyMC41Njg5IDIuNDM1NTUgMTkuODE2NEMyLjE4ODI3IDE5LjMzMTEgMi4wODk4OCAxOC44MTQgMi4wNDM5NSAxOC4yNTJDMS45OTg5OCAxNy43MDE2IDIgMTcuMDIzNyAyIDE2LjIwMDJWNy43OTk4QzIgNi45NzYzMSAxLjk5ODk4IDYuMjk4NDIgMi4wNDM5NSA1Ljc0ODA0QzIuMDg5ODggNS4xODU5OSAyLjE4ODI3IDQuNjY4OSAyLjQzNTU1IDQuMTgzNTlDMi44MTkwMiAzLjQzMTA5IDMuNDMxMDkgMi44MTkwMSA0LjE4MzYgMi40MzU1NEM0LjY2ODkgMi4xODgyNyA1LjE4NTk5IDIuMDg5ODcgNS43NDgwNSAyLjA0Mzk0QzYuMjk4NDMgMS45OTg5OCA2Ljk3NjMyIDIgNy43OTk4MSAySDExWiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTIwIDJDMjEuMTA0NiAyIDIyIDIuODk1NDQgMjIgNFY4QzIyIDguNTUyMjggMjEuNTUyMyA4Ljk5OTk5IDIxIDlDMjAuNDQ3NyA5IDIwIDguNTUyMjggMjAgOFY1LjQxNDA2TDExLjcwNyAxMy43MDdDMTEuMzE2NSAxNC4wOTc2IDEwLjY4MzUgMTQuMDk3NiAxMC4yOTMgMTMuNzA3QzkuOTAyNDUgMTMuMzE2NSA5LjkwMjQ1IDEyLjY4MzUgMTAuMjkzIDEyLjI5M0wxOC41ODU5IDRIMTZDMTUuNDQ3NyA0IDE1IDMuNTUyMjggMTUgM0MxNSAyLjQ0NzcyIDE1LjQ0NzcgMiAxNiAySDIwWiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==",so="_menu_1icqg_5",oo="_label_1icqg_23",ao="_divider_1icqg_49",io="_optionsContainer_1icqg_87",co="_menuItem_1icqg_103",lo="_danger_1icqg_165",uo="_disabled_1icqg_183",go="_icon_1icqg_197",Mo="_iconEmoji_1icqg_237",Io="_renameContainer_1icqg_261",fo="_renameLabel_1icqg_277",mo="_renameInputWrapper_1icqg_297",Do="_renameInput_1icqg_297",po="_confirmButton_1icqg_361",ae={menu:so,label:oo,divider:ao,optionsContainer:io,menuItem:co,danger:lo,disabled:uo,icon:go,iconEmoji:Mo,renameContainer:Io,renameLabel:fo,renameInputWrapper:mo,renameInput:Do,confirmButton:po};function xo({isOpen:e,anchorRect:t,currentSpace:n,allSpaces:s,isLastSpace:o,onClose:i,onAdd:c,onRename:u,onDelete:I,onImport:l,onImportMultiple:M,onPin:m,isFirstSpace:f,isEditMode:g,onToggleEditMode:d}){const{t:D}=Ke(),[y,x]=r.useState(!1),[Y,O]=r.useState(""),P=r.useRef(null),F=r.useRef(null),E=r.useRef(null);r.useEffect(()=>{y&&F.current&&(F.current.focus(),F.current.select())},[y]),r.useEffect(()=>{e||(x(!1),O(""))},[e]);const k=()=>{c(),i()},T=()=>{O(n.name),x(!0)},U=()=>{const z=Y.trim();z&&z!==n.name&&u(z),x(!1),i()},p=z=>{z.key==="Enter"?U():z.key==="Escape"&&x(!1)},N=()=>{const z=D.space.deleteConfirm.replace("{name}",n.name);!o&&window.confirm(z)&&(I(),i())},w=()=>{ir(n),i()},_=()=>{cr(s),i()},G=()=>{E.current?.click()},S=async z=>{const re=z.target.files?.[0];if(re)try{const L=await dr(re);L.type==="multi"?M(L.data):l(L.data),i()}catch(L){const R=L instanceof Error?L.message:"Unknown error";window.alert(`${D.space.importFailed}${R}`)}finally{E.current&&(E.current.value="")}};return a.jsx(ro,{isOpen:e,onClose:i,title:void 0,hideHeader:!0,anchorRect:t,children:a.jsx("div",{ref:P,className:ae.menu,children:y?a.jsxs("div",{className:ae.renameContainer,children:[a.jsx("div",{className:ae.renameLabel,children:D.space.renameSpace}),a.jsxs("div",{className:ae.renameInputWrapper,children:[a.jsx("input",{ref:F,type:"text",className:ae.renameInput,value:Y,onChange:z=>O(z.target.value),onKeyDown:p,maxLength:10,placeholder:D.space.inputName}),a.jsx("button",{className:ae.confirmButton,onClick:U,disabled:!Y.trim()||Y.trim()===n.name,children:D.space.confirm})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:ae.label,children:D.space.title}),a.jsx("div",{className:ae.divider}),a.jsxs("div",{className:ae.optionsContainer,children:[a.jsxs("button",{className:ae.menuItem,onClick:k,children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${ft})`,maskImage:`url(${ft})`}}),a.jsx("span",{children:D.space.addSpace})]}),a.jsxs("button",{className:ae.menuItem,onClick:()=>{d(),i()},children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${$e})`,maskImage:`url(${$e})`}}),a.jsx("span",{children:g?D.contextMenu.exitEditMode:D.contextMenu.editMode})]}),a.jsxs("button",{className:ae.menuItem,onClick:T,children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${qe})`,maskImage:`url(${qe})`}}),a.jsx("span",{children:D.space.rename})]}),a.jsxs("button",{className:`${ae.menuItem} ${f?ae.disabled:""}`,onClick:()=>{m(),i()},disabled:f,title:f?D.space.alreadyAtTop:D.space.pinToTop,children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${tn})`,maskImage:`url(${tn})`}}),a.jsx("span",{children:D.space.pinToTop})]}),a.jsxs("button",{className:`${ae.menuItem} ${ae.danger} ${o?ae.disabled:""}`,onClick:N,disabled:o,title:o?"Reserve at least one space":D.space.deleteSpace,children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${Je})`,maskImage:`url(${Je})`}}),a.jsx("span",{children:D.space.deleteSpace})]}),a.jsx("div",{className:ae.divider}),a.jsxs("button",{className:ae.menuItem,onClick:G,children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${nn})`,maskImage:`url(${nn})`}}),a.jsx("span",{children:D.space.importSpace})]}),a.jsxs("button",{className:ae.menuItem,onClick:w,children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${Qe})`,maskImage:`url(${Qe})`}}),a.jsx("span",{children:D.space.exportSpace})]}),a.jsxs("button",{className:ae.menuItem,onClick:_,children:[a.jsx("span",{className:ae.icon,style:{WebkitMaskImage:`url(${Qe})`,maskImage:`url(${Qe})`}}),a.jsx("span",{children:D.space.exportAllSpaces})]}),a.jsx("input",{ref:E,type:"file",accept:".json",style:{display:"none"},onChange:S})]})]})})})}const yo=64,ho=8,No=yo+ho,jo=50,rn=8,ec=4,To=64,tc=64,Ao=8,nc=To+Ao,Eo=8,Co=3,ko=30,wo=500,So=300,sn="cubic-bezier(0.25, 1, 0.5, 1)",Ue="cubic-bezier(0.2, 0, 0, 1)",on="cubic-bezier(0.4, 0, 0.2, 1)",mt=280,Le=200,Dt=150,bo=1.05,Lo=9999,It={PICKUP:10,REORDER:5,MERGE:15,DROP:10,CANCEL:20},Oo=({isActive:e,item:t,position:n,isAnimatingReturn:s,isEditMode:o,dragElementRef:i,isPreMerge:c=!1,isDraggingOut:u=!1,onAnimationComplete:I})=>{if(!e||!t)return null;const l=()=>c?"scale(0.6)":u||s?"scale(1.0)":`scale(${bo})`,M=()=>c||s?"none":"0 16px 32px rgba(0,0,0,0.3)",m=()=>s?`left ${mt}ms ${sn}, top ${mt}ms ${sn}, transform ${Le}ms ease-out, box-shadow ${Le}ms ease-out`:`transform ${Dt}ms ${on}, box-shadow ${Dt}ms ${on}`,f=Ne.useRef(!1);Ne.useEffect(()=>{s&&(f.current=!1)},[s]);const g=d=>{s&&!f.current&&(d.propertyName==="left"||d.propertyName==="top")&&(f.current=!0,I?.())};return Ye.createPortal(a.jsx("div",{ref:d=>{i&&(i.current=d)},style:{position:"fixed",left:n.x,top:n.y,width:64,height:64,pointerEvents:"none",zIndex:Lo,transform:l(),boxShadow:M(),borderRadius:"16px",transition:m()},onTransitionEnd:g,children:a.jsx(On,{item:t,isEditMode:o,onClick:()=>{},onEdit:()=>{},onDelete:()=>{},isDragging:!0})}),document.body)},$t=e=>({isDragging:!1,item:null,originalIndex:-1,currentPosition:{x:0,y:0},startPosition:{x:0,y:0},offset:{x:0,y:0},isAnimatingReturn:!1,targetPosition:null,...e}),zn=e=>$t(e),vn=(e,t,n,s)=>Math.hypot(n-e,s-t),zo=e=>{e?document.body.classList.add("is-dragging"):document.body.classList.remove("is-dragging")},vo=(e,t,n)=>{const{isEditMode:s,item:o,index:i,event:c,setDragState:u,handleMouseMove:I,handleMouseUp:l,createDragState:M}=e;if(!s)return;c.preventDefault(),t.current=!1;const m=c.currentTarget.getBoundingClientRect(),f={x:c.clientX-m.left,y:c.clientY-m.top},g=c.clientX,d=c.clientY;let D=!1;const y=Y=>{if(vn(Y.clientX,Y.clientY,g,d)>Co){if(t.current=!0,!D){D=!0;const P=M(o,i,m,g,d,f);u(P),e.onDragStart&&e.onDragStart(o)}window.removeEventListener("mousemove",y),n.current=null,window.addEventListener("mousemove",I)}},x=()=>{window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",x),n.current=null,t.current=!1,D&&l()};n.current=y,window.addEventListener("mousemove",y),window.addEventListener("mouseup",x)},_o=(e,t,n,s,o)=>{if(n.length===0)return 0;if(o){const M=n[n.length-1];if(t>M.rect.bottom)return s}let i=null,c=1/0;for(const M of n){const m=Math.hypot(e-M.centerX,t-M.centerY);m<c&&(c=m,i=M)}if(!i)return s;const u=10,{centerX:I,index:l}=i;return e<I+u?l:l+1},rc=(e,t,n)=>{const s=Array.from(e),[o]=s.splice(t,1);return s.splice(n,0,o),s},_n=(e,t,n=mt+70)=>{if(!e){setTimeout(t,mt);return}let s=!1;const o=()=>{s||(s=!0,e.removeEventListener("transitionend",i),t())},i=c=>{(c.propertyName==="left"||c.propertyName==="top")&&o()};e.addEventListener("transitionend",i),setTimeout(o,n)},an=()=>$t({targetAction:null,targetActionData:null}),sc=()=>$t({targetAction:null,targetActionData:null}),Mt=()=>zn({targetAction:null,targetActionData:null}),oc=()=>zn({targetAction:null,targetActionData:null}),Ro=e=>{const{items:t,onDragStart:n,onDragEnd:s,externalDragItem:o,createInitialState:i,containerRef:c}=e,[u,I]=r.useState(i),[l,M]=r.useState(null),m=r.useRef([]),f=r.useRef(u),g=r.useRef(t),d=r.useRef(null),D=r.useRef([]),y=r.useRef(!1),x=r.useRef(null),Y=r.useRef(null),O=r.useRef(null),P=r.useRef(null),F=r.useCallback(_=>{typeof _=="function"?M(G=>{const S=_(G);return d.current=S,S}):(d.current=_,M(_))},[]);r.useEffect(()=>{f.current=u},[u]),r.useEffect(()=>{g.current=t},[t]),r.useEffect(()=>{zo(u.isDragging)},[u.isDragging]);const E=r.useCallback(()=>{const _=[];m.current.forEach((G,S)=>{if(G&&g.current[S]){const z=G.getBoundingClientRect();_.push({id:g.current[S].id,index:S,rect:z,centerX:z.left+z.width/2,centerY:z.top+z.height/2})}}),D.current=_,c?.current&&(P.current=c.current.getBoundingClientRect())},[c]),k=r.useCallback(_=>{E(),I(G=>({...G,isDragging:!0})),n&&n(_)},[n,E]),T=r.useCallback((_,G,S,z)=>vn(_.clientX,_.clientY,G,S)>8?(y.current=!0,z(),!0):!1,[]),U=r.useCallback(()=>{F(null),Y.current=null},[]);r.useEffect(()=>{o||U()},[o,U]);const p=r.useCallback((_,G)=>{x.current&&(window.removeEventListener("mousemove",x.current),x.current=null),window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",G)},[]),N=r.useCallback(_=>{typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(_)},[]),w=r.useCallback((_,G,S,z)=>{I(re=>({...re,isDragging:!1,isAnimatingReturn:!0,targetPosition:_,targetAction:G,targetActionData:S})),y.current=!1,_n(O.current,()=>{f.current.isAnimatingReturn&&z()})},[I]);return r.useEffect(()=>{const _=G=>{G.key==="Escape"&&u.isDragging&&(x.current&&(window.removeEventListener("mousemove",x.current),x.current=null),I(e.resetState()),F(null),y.current=!1,s&&s(),N(20))};return u.isDragging&&window.addEventListener("keydown",_),()=>{window.removeEventListener("keydown",_)}},[u.isDragging,e,s,I,F,N]),{dragState:u,setDragState:I,placeholderIndex:l,setPlaceholderIndex:F,itemRefs:m,dragRef:f,itemsRef:g,placeholderRef:d,layoutSnapshotRef:D,hasMovedRef:y,thresholdListenerRef:x,lastPlaceholderRef:Y,dragElementRef:O,containerRef:c,cachedContainerRectRef:P,startDragging:k,handleDragThresholdCheck:T,captureLayoutSnapshot:E,resetPlaceholderState:U,cleanupDragListeners:p,startReturnAnimation:w,performHapticFeedback:N}};function Uo({onHoverOpenFolder:e,hoverOpenDelay:t=wo,preMergeDelay:n=So,getItems:s,performHapticFeedback:o}){const[i,c]=r.useState(null),[u,I]=r.useState(null),[l,M]=r.useState(null),[m,f]=r.useState(!1),g=r.useRef(null),d=r.useRef(null),D=r.useRef(null),y=r.useRef(!1),x=r.useRef(0),Y=r.useRef(null);r.useEffect(()=>{g.current=i},[i]),r.useEffect(()=>{d.current=u},[u]),r.useEffect(()=>{D.current=l},[l]),r.useEffect(()=>{y.current=m},[m]);const O=r.useCallback(()=>{c(null),I(null),M(null),f(!1),Y.current=null},[]),P=r.useCallback((F,E)=>{if(Y.current!==F.id)Y.current=F.id,x.current=Date.now(),f(!1),M(null),c(null),I(null);else{const k=Date.now()-x.current;if(F.type==="folder"&&k>t&&!y.current&&e){const U=s().find(p=>p.id===F.id);if(U)return e(E,U),Y.current=null,!0}k>n&&!y.current&&(f(!0),M(F.id),F.type==="folder"?(c(F.id),I(null)):(c(null),I(F.id)),o&&o(It.MERGE))}return!1},[e,t,n,s,o]);return{hoveredFolderId:i,hoveredAppId:u,mergeTargetId:l,isPreMerge:m,hoveredFolderRef:g,hoveredAppRef:d,mergeTargetRef:D,isPreMergeRef:y,handleMergeTargetHover:P,resetMergeStates:O,setHoveredFolderId:c,setHoveredAppId:I}}const Qo=(e,t)=>{const n=document.querySelector('[data-folder-view="true"]');if(!n)return!1;const s=n.getBoundingClientRect();return e>=s.left&&e<=s.right&&t>=s.top&&t<=s.bottom},Yo=()=>document.querySelector('[data-folder-view="true"]')?.getBoundingClientRect()??null,Po=(e,t,n,s=0)=>e>=n.left-s&&e<=n.right+s&&t>=n.top-s&&t<=n.bottom+s;function $o(e,t,n,s,o=100){return!s&&Qo(e,t)?{type:"folder"}:n&&e>=n.left-o&&e<=n.right+o&&t>=n.top-o&&t<=n.bottom+o?{type:"dock",rect:n}:{type:"outside"}}function Fo(e,t,n,s,o=25){for(const i of t)if(Math.hypot(e.x-i.centerX,e.y-i.centerY)<o){const u=s.find(I=>I.id===i.id);if(u&&u.id!==n)return{id:u.id,type:u.type}}return null}function Bo(e,t,n,s,o=64){return s?{x:e-n.x+o/2,y:t-n.y+o/2}:{x:e,y:t}}function Wo(e,t,n){if(n===0)return 0;for(let s=0;s<t.length;s++)if(e<t[s].centerX)return s;return n}const Go=()=>({layoutConfig:{type:"horizontal",cellSize:72,hysteresisThreshold:10},calculatePlaceholder:(t,n,s,o)=>{for(let i=0;i<s.length;i++)if(t<s[i].centerX)return i;return o},calculateTransform:(t,n,s,o)=>{if(n===null)return{x:0,y:0};if(o&&s!==-1){if(t===s)return{x:0,y:0};if(n===s||n===s+1)return{x:0,y:0};if(s<n){if(t>s&&t<n)return{x:-72,y:0}}else if(s>n&&t>=n&&t<s)return{x:72,y:0}}else if(s===-1&&t>=n)return{x:72,y:0};return{x:0,y:0}}}),ac=(e=4)=>({layoutConfig:{type:"grid",columns:e,cellSize:72,padding:8,hysteresisThreshold:15},calculatePlaceholder:(i,c,u,I,l)=>_o(i,c,u,I,l||null),calculateTransform:(i,c,u,I)=>{if(c===null)return{x:0,y:0};const l=(M,m)=>{if(M===m)return{x:0,y:0};const f=M%e,g=Math.floor(M/e),d=m%e,D=Math.floor(m/e);return{x:(d-f)*72,y:(D-g)*72}};if(u===-1)return i>=c?l(i,i+1):{x:0,y:0};if(I&&u!==-1){if(i===u)return{x:0,y:0};if(u>c){if(i>=c&&i<u)return l(i,i+1)}else if(u<c&&i>u&&i<=c)return l(i,i-1)}return{x:0,y:0}},isOutsideContainer:(i,c,u)=>!Po(i,c,u,10)}),Zo=({items:e,isEditMode:t,onReorder:n,onDropToFolder:s,onMergeFolder:o,onDragToOpenFolder:i,onHoverOpenFolder:c,onDragStart:u,onDragEnd:I,externalDragItem:l,hasFolderPlaceholderActive:M})=>{const{dragState:m,setDragState:f,placeholderIndex:g,setPlaceholderIndex:d,itemRefs:D,dragRef:y,itemsRef:x,placeholderRef:Y,layoutSnapshotRef:O,hasMovedRef:P,thresholdListenerRef:F,startDragging:E,captureLayoutSnapshot:k,dragElementRef:T,cleanupDragListeners:U,performHapticFeedback:p}=Ro({items:e,isEditMode:t,onDragStart:u,onDragEnd:I,externalDragItem:l,createInitialState:an,resetState:Mt}),{hoveredFolderId:N,hoveredAppId:w,mergeTargetId:_,isPreMerge:G,hoveredFolderRef:S,hoveredAppRef:z,isPreMergeRef:re,handleMergeTargetHover:L,resetMergeStates:R}=Uo({onHoverOpenFolder:c,getItems:()=>x.current,performHapticFeedback:p}),B=r.useMemo(()=>Go(),[]),j=r.useRef(null),Q=r.useRef(null),K=r.useRef({x:0,y:0}),A=r.useRef(!1),v=r.useRef(null),W=r.useRef(null),H=r.useCallback(()=>{j.current&&(Q.current=j.current.getBoundingClientRect())},[]);r.useEffect(()=>{g!==null&&m.isDragging&&p(It.REORDER)},[g,p,m.isDragging]);const se=r.useCallback(()=>{d(null),R()},[d,R]),te=r.useCallback((V,C,q)=>{const h=Q.current||j.current?.getBoundingClientRect();return $o(V,C,h||null,q?.type==="folder",jo)},[]),X=r.useCallback((V,C,q,h)=>{const $=Bo(V.clientX,V.clientY,C.offset,C.isDragging);return Fo($,q,h.id,x.current,ko)},[]),le=r.useCallback((V,C)=>Wo(V,C,x.current.length),[]),Me=r.useCallback(V=>{const C=y.current,q=C.isDragging?C.item:l;if(!C.isDragging&&!l&&C.item)if(Math.hypot(V.clientX-C.startPosition.x,V.clientY-C.startPosition.y)>Eo)H(),p(It.PICKUP),E(C.item);else return;if(!q)return;if((!O.current||O.current.length===0)&&x.current.length>0&&k(),C.isDragging&&T.current){const ne=V.clientX-C.offset.x,de=V.clientY-C.offset.y;T.current.style.left=`${ne}px`,T.current.style.top=`${de}px`}const h=V.clientX,$=V.clientY;K.current={x:h,y:$};const Z=te(h,$,q);if(Z.type==="folder"||Z.type==="outside"){se();return}const J=O.current,ee=X(V,C,J,q);if(ee){if(L(ee,q))return}else if(J.length>0){const ne=le(h,J);d(ne)}else d(0)},[l,E,k,H,te,X,le,L,se,d,p]),ue=r.useCallback(V=>{W.current=V,v.current===null&&(v.current=requestAnimationFrame(()=>{v.current=null;const C=W.current;C&&Me(C)}))},[Me]);r.useEffect(()=>{const V=A.current;if(l)return A.current=!0,H(),window.addEventListener("mousemove",ue),()=>{window.removeEventListener("mousemove",ue)};V&&(se(),O.current=[],A.current=!1)},[l,ue,H,se]),r.useEffect(()=>{A.current&&(d(null),O.current=[],A.current=!1)},[e,d]);const De=r.useCallback(()=>{const V=y.current;if(!V.isDragging&&V.item&&!P.current){U(ue,De),P.current=!1,f(Mt());return}if(!V.item)return;U(ue,De);const C=Y.current,q=S.current,h=z.current,$=x.current,Z=re.current,J=O.current;let ee=null,ne=null,de=null;if(V.item.type!=="folder"&&M?.()&&i&&V.item.type!=="folder"){const oe=Yo();oe&&(ee={x:oe.left+oe.width/2-32,y:oe.top+oe.height/2-32},ne="dragToOpenFolder",de={type:"dragToOpenFolder",item:V.item})}else if(Z){if(q&&s){const oe=J.find(ye=>ye.id===q);oe&&(ee={x:oe.rect.left,y:oe.rect.top});const Ie=$.find(ye=>ye.id===q);Ie&&(ne="dropToFolder",de={type:"dropToFolder",item:V.item,targetFolder:Ie})}else if(h&&o){const oe=J.find(ye=>ye.id===h);oe&&(ee={x:oe.rect.left,y:oe.rect.top});const Ie=$.find(ye=>ye.id===h);Ie&&(ne="mergeFolder",de={type:"mergeFolder",item:V.item,targetItem:Ie})}}else if(C!=null){const oe=V.originalIndex;let Ie=C;const ye=[...$];if(oe!==-1){Ie>oe&&(Ie-=1);const[ve]=ye.splice(oe,1);ye.splice(Ie,0,ve)}const ze=No;let Re=0,it=0;const ht=D.current.find((ve,je)=>ve&&je!==oe);if(ht){const ve=ht.getBoundingClientRect(),je=D.current.findIndex((Pn,$n)=>Pn===ht&&$n!==oe);let Ft=je;oe!==-1&&je>oe&&(Ft=je-1);const Un=B.calculateTransform(je,C,oe,!0).x,Qn=ve.left-Un-Ft*ze,Yn=ve.top;Re=Qn+Ie*ze,it=Yn}else if(J.length>0&&J[0]){const ve=J[0].rect.left,je=J[0].rect.top;Re=ve+Ie*ze,it=je}else{const je=(j.current||document.querySelector('[data-dock-container="true"]'))?.getBoundingClientRect();je&&(Re=je.left+rn+Ie*ze,it=je.top+rn)}ee={x:Re,y:it},ne="reorder",de={type:"reorder",newItems:ye}}ee&&ne?(f(oe=>({...oe,isDragging:!1,isAnimatingReturn:!0,currentPosition:ee,targetPosition:ee,targetAction:ne,targetActionData:de})),R(),P.current=!1,_n(T.current,()=>{y.current.isAnimatingReturn&&xe()})):(f(Mt()),d(null),R(),P.current=!1,I&&I())},[B,s,o,i,I,n,ue,f,d,U,M]),pe=(V,C,q)=>{vo({isEditMode:t,item:C,index:q,event:V,setDragState:f,handleMouseMove:ue,handleMouseUp:De,createDragState:(h,$,Z,J,ee,ne)=>({...an(),item:h,originalIndex:$,currentPosition:{x:Z.left,y:Z.top},startPosition:{x:J,y:ee},offset:ne})},P,F)},xe=r.useCallback(()=>{const V=y.current;if(!V.isAnimatingReturn||!V.targetAction||!V.item)return;const C=V.targetActionData;if(f(Mt()),d(null),C)switch(p(It.DROP),C.type){case"reorder":n(C.newItems);break;case"dropToFolder":s&&s(C.item,C.targetFolder);break;case"mergeFolder":o&&o(C.item,C.targetItem);break;case"dragToOpenFolder":i&&i(C.item);break}I&&I()},[n,s,o,i,I,f,d,y]),Ce=r.useMemo(()=>{const V=g;if(V===null)return e.map(()=>0);const q=(m.isDragging||m.isAnimatingReturn)&&m.originalIndex!==-1?m.originalIndex:l?-1:m.originalIndex,h=m.isDragging||m.isAnimatingReturn,$=e.map((J,ee)=>B.calculateTransform(ee,V,q,h).x),Z=B.calculateTransform(e.length,V,q,h);return $.push(Z.x),$},[g,m.isDragging,m.isAnimatingReturn,m.originalIndex,l,e.length,B]),ke=r.useCallback(V=>Ce[V]??0,[Ce]);return r.useEffect(()=>()=>{v.current!==null&&cancelAnimationFrame(v.current),U(ue,De)},[]),{dragState:m,placeholderIndex:g,hoveredFolderId:N,hoveredAppId:w,mergeTargetId:_,isPreMerge:G,itemRefs:D,dockRef:j,handleMouseDown:pe,handleAnimationComplete:xe,getItemTransform:ke,dragElementRef:T}},Ho="_dock_i4b9e_9",Vo="_dockContent_i4b9e_41",Xo="_dockItemWrapper_i4b9e_75",qo="_editMode_i4b9e_93",Jo="_dockItem_i4b9e_75",Ko="_divider_i4b9e_103",ea="_dockNavigator_i4b9e_167",ta="_navigatorIcon_i4b9e_185",na="_placeholder_i4b9e_211",ra="_editTools_i4b9e_239",sa="_visible_i4b9e_269",oa="_isBeingDragged_i4b9e_287",aa="_itemExiting_i4b9e_365",ia="_slideOutUp_i4b9e_1",ca="_itemHidden_i4b9e_375",la="_itemEntering_i4b9e_391",ua="_slideInUp_i4b9e_1",da="_navigatorTransitioning_i4b9e_431",me={dock:Ho,dockContent:Vo,dockItemWrapper:Xo,editMode:qo,dockItem:Jo,divider:Ko,dockNavigator:ea,navigatorIcon:ta,placeholder:na,editTools:ra,visible:sa,isBeingDragged:oa,itemExiting:aa,slideOutUp:ia,itemHidden:ca,itemEntering:la,slideInUp:ua,navigatorTransitioning:da},ga=({items:e,isEditMode:t,onItemClick:n,onItemEdit:s,onItemDelete:o,onItemAdd:i,onItemsReorder:c,onDropToFolder:u,onDragToOpenFolder:I,onHoverOpenFolder:l,onLongPressEdit:M,onWidthChange:m,externalDragItem:f,onDragStart:g,onDragEnd:d})=>{const D=r.useRef(null),{folderPlaceholderActive:y}=kn(),{setIsEditMode:x}=Ut(),{spaces:Y,currentSpace:O,currentIndex:P,isSwitching:F,setIsSwitching:E,switchToNextSpace:k,addSpace:T,renameSpace:U,deleteSpace:p,importSpace:N,importMultipleSpaces:w,pinSpace:_}=Tn(),[G,S]=r.useState("idle"),z=r.useRef(null),re=r.useCallback(()=>{if(F||Y.length<=1)return;const C=z.current?z.current.getBoundingClientRect().width:0;z.current&&C>0&&(z.current.style.width=`${C}px`),E(!0),S("exiting");const q=120,h=200,$=15,Z=250;setTimeout(()=>{S("hidden"),k(),setTimeout(()=>{if(S("entering"),z.current){z.current.style.width="";const ee=z.current.getBoundingClientRect().width;C>0&&Math.abs(ee-C)>1&&(z.current.style.width=`${C}px`,requestAnimationFrame(()=>{z.current&&(z.current.style.width=`${ee}px`,setTimeout(()=>{z.current&&(z.current.style.width="")},Z))}))}const J=h+e.length*$;setTimeout(()=>{S("idle"),E(!1)},J)},10)},q)},[F,Y.length,e.length,k,E]),[L,R]=r.useState(!1),[B,j]=r.useState(null),Q=r.useCallback(C=>{j(C.currentTarget.getBoundingClientRect()),R(!0)},[]),[K,A]=r.useState(null),v=r.useCallback((C,q,h,$)=>{A({x:q,y:h,item:C,rect:$})},[]),W=r.useRef(y);r.useEffect(()=>{W.current=y},[y]);const{dragState:H,placeholderIndex:se,mergeTargetId:te,isPreMerge:X,itemRefs:le,dockRef:Me,handleMouseDown:ue,handleAnimationComplete:De,getItemTransform:pe,dragElementRef:xe}=Zo({items:e,isEditMode:t,onReorder:c,onDragToOpenFolder:I,onHoverOpenFolder:(C,q)=>{l&&l(C,q)},onDropToFolder:u,onMergeFolder:(C,q)=>{if(q.type==="folder"){const h=C.type==="folder"&&C.items?C.items:[C],$=e.map(Z=>{if(Z.id===q.id){const J=[...Z.items||[],...h];return{...Z,items:J,icon:be(J)}}return Z}).filter(Z=>Z.id!==C.id);c($)}else{const h={id:`folder-${Date.now()}`,name:"Folder",type:"folder",items:[q,C]};h.icon=be(h.items);const $=e.map(Z=>Z.id===q.id?h:Z).filter(Z=>Z.id!==C.id);c($)}},externalDragItem:f,onDragStart:g,onDragEnd:d,hasFolderPlaceholderActive:()=>W.current}),Ce=H.isDragging||H.isAnimatingReturn||!!f,ke=r.useMemo(()=>({draggingCollapsed:`width ${Le}ms ${Ue}, min-width ${Le}ms ${Ue}, opacity ${Dt}ms`,draggingWithPlaceholder:`width ${Le}ms ${Ue}, min-width ${Le}ms ${Ue}, transform ${Le}ms ${Ue}, opacity ${Dt}ms`,normal:`transform ${Le}ms ${Ue}`}),[]),V=r.useCallback((C,q,h,$,Z)=>q?$===null?{"--stagger-index":C,width:0,minWidth:0,overflow:"hidden",opacity:0,visibility:"hidden",pointerEvents:"none",transition:Z?ke.draggingCollapsed:"none"}:{"--stagger-index":C,width:64,minWidth:64,opacity:0,visibility:"hidden",pointerEvents:"none",transform:`translateX(${h}px)`,transition:Z?ke.draggingWithPlaceholder:"none"}:{"--stagger-index":C,transform:`translateX(${h}px)`,transition:Z?ke.normal:"none"},[ke]);return r.useEffect(()=>{D.current&&(Me.current=D.current)},[Me]),r.useEffect(()=>{if(!m||!D.current)return;const C=new ResizeObserver(q=>{for(const h of q){let $=0;h.borderBoxSize&&h.borderBoxSize.length>0?$=Math.round(h.borderBoxSize[0].inlineSize):($=Math.round(h.contentRect.width),h.target instanceof HTMLElement&&($=Math.round(h.target.getBoundingClientRect().width))),m($)}});return C.observe(D.current),()=>C.disconnect()},[m]),a.jsxs("header",{ref:D,className:`${me.dock} ${t?me.editMode:""}`,children:[a.jsxs("div",{ref:z,className:me.dockContent,"data-dock-container":"true",children:[a.jsxs("div",{className:`${me.editTools} ${t?me.visible:""}`,children:[a.jsx(Ls,{onClick:C=>i(C)}),a.jsx("div",{className:me.divider,children:a.jsx("svg",{width:"1",height:"48",viewBox:"0 0 1 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("line",{x1:"0.5",y1:"0",x2:"0.5",y2:"48",strokeWidth:"1"})})})]}),e.map((C,q)=>{const h=te===C.id,$=H.item?.id===C.id,Z=pe(q);let J="";return G==="exiting"?J=me.itemExiting:G==="hidden"?J=me.itemHidden:G==="entering"&&(J=me.itemEntering),a.jsx("div",{ref:ee=>{le.current[q]=ee},className:`${me.dockItemWrapper} ${$?me.isBeingDragged:""} ${J}`,"data-dock-item-wrapper":"true",style:V(q,$,Z,se,Ce),children:a.jsx(On,{item:C,isEditMode:t,onClick:ee=>n(C,ee),onEdit:ee=>s(C,ee),onDelete:()=>o(C),isDragging:$,staggerIndex:q,isDropTarget:h,isMergeTarget:h,onLongPress:M,onMouseDown:ee=>ue(ee,C,q),onContextMenu:(ee,ne,de)=>v(C,ee,ne,de)})},C.id)}),a.jsx("div",{className:me.divider,style:{transform:`translateX(${pe(e.length)}px)`,transition:Ce?`transform ${Le}ms ${Ue}`:"none"},children:a.jsx("svg",{width:"1",height:"48",viewBox:"0 0 1 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("line",{x1:"0.5",y1:"0",x2:"0.5",y2:"48",strokeWidth:"1"})})}),pe(e.length)>0&&a.jsx("div",{style:{width:pe(e.length),flexShrink:0,transition:Ce?`width ${Le}ms ${Ue}`:"none"}})]}),a.jsx("div",{className:`${me.dockNavigator} ${G==="exiting"||G==="hidden"?me.navigatorTransitioning:""}`,children:a.jsx(Qs,{currentSpace:O,totalSpaces:Y.length,currentIndex:P,onSwitch:re,onContextMenu:Q,disabled:F})}),a.jsx(Oo,{isActive:H.isDragging||H.isAnimatingReturn,item:H.item,position:H.currentPosition,isAnimatingReturn:H.isAnimatingReturn,isEditMode:t,dragElementRef:xe,isPreMerge:X,onAnimationComplete:De}),a.jsx(xo,{isOpen:L,anchorRect:B,currentSpace:O,allSpaces:Y,isLastSpace:Y.length<=1,onClose:()=>R(!1),onAdd:()=>{T(),R(!1)},onRename:C=>{U(O.id,C),R(!1)},onDelete:()=>{p(O.id),R(!1)},onImport:C=>{N(C),R(!1)},onImportMultiple:C=>{w(C),R(!1)},onPin:()=>{_(O.id),R(!1)},isFirstSpace:P===0,isEditMode:t,onToggleEditMode:()=>x(!t)}),K&&a.jsx(Zs,{x:K.x,y:K.y,item:K.item,isEditMode:t,onClose:()=>A(null),onEdit:()=>s(K.item,K.rect),onToggleEditMode:()=>x(!t),onDelete:()=>o(K.item)})]})},Ma="_editor_134qh_5",Ia="_innerContainer_134qh_28",fa="_icon_134qh_41",wt={editor:Ma,innerContainer:Ia,icon:fa},ma=({onClick:e,visible:t=!1,isEditMode:n=!1})=>a.jsx("header",{className:wt.editor,style:{opacity:t?1:0,pointerEvents:t?"auto":"none"},children:a.jsx("div",{className:wt.innerContainer,onClick:e,children:a.jsx("div",{className:wt.icon,children:n?a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M20.707 5.293C20.8944 5.48053 20.9997 5.73484 20.9997 6C20.9997 6.26516 20.8944 6.51947 20.707 6.707L9.70696 17.707C9.51943 17.8945 9.26512 17.9998 8.99996 17.9998C8.7348 17.9998 8.48049 17.8945 8.29296 17.707L3.29296 12.707C3.19745 12.6148 3.12127 12.5044 3.06886 12.3824C3.01645 12.2604 2.98886 12.1292 2.98771 11.9964C2.98655 11.8636 3.01186 11.7319 3.06214 11.609C3.11242 11.4861 3.18667 11.3745 3.28056 11.2806C3.37446 11.1867 3.48611 11.1125 3.60901 11.0622C3.7319 11.0119 3.86358 10.9866 3.99636 10.9877C4.12914 10.9889 4.26036 11.0165 4.38236 11.0689C4.50437 11.1213 4.61471 11.1975 4.70696 11.293L8.99996 15.586L19.293 5.293C19.4805 5.10553 19.7348 5.00021 20 5.00021C20.2651 5.00021 20.5194 5.10553 20.707 5.293Z",fill:"currentColor"})}):a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M12 2C12.5523 2 13 2.44772 13 3C13 3.55229 12.5523 4 12 4H7.79981C6.94342 4 6.36117 4.00035 5.91113 4.03711C5.47272 4.07293 5.2482 4.13809 5.0918 4.21778C4.71555 4.40951 4.40951 4.71555 4.21778 5.0918C4.13809 5.2482 4.07293 5.47272 4.03711 5.91113C4.00035 6.36117 4 6.94342 4 7.79981V16.2002C4 17.0566 4.00035 17.6388 4.03711 18.0889C4.07293 18.5273 4.13809 18.7518 4.21778 18.9082C4.40951 19.2845 4.71555 19.5905 5.0918 19.7822C5.2482 19.8619 5.47272 19.9271 5.91113 19.9629C6.36117 19.9997 6.94342 20 7.79981 20H16.2002C17.0566 20 17.6388 19.9997 18.0889 19.9629C18.5273 19.9271 18.7518 19.8619 18.9082 19.7822C19.2845 19.5905 19.5905 19.2845 19.7822 18.9082C19.8619 18.7518 19.9271 18.5273 19.9629 18.0889C19.9997 17.6388 20 17.0566 20 16.2002V12C20 11.4477 20.4477 11 21 11C21.5523 11 22 11.4477 22 12V16.2002C22 17.0237 22.001 17.7016 21.9561 18.252C21.9101 18.814 21.8117 19.3311 21.5645 19.8164C21.181 20.5689 20.5689 21.181 19.8164 21.5645C19.3311 21.8117 18.814 21.9101 18.252 21.9561C17.7016 22.001 17.0237 22 16.2002 22H7.79981C6.97632 22 6.29843 22.001 5.74805 21.9561C5.18599 21.9101 4.6689 21.8117 4.1836 21.5645C3.43109 21.181 2.81902 20.5689 2.43555 19.8164C2.18827 19.3311 2.08988 18.814 2.04395 18.252C1.99898 17.7016 2 17.0237 2 16.2002V7.79981C2 6.97632 1.99898 6.29843 2.04395 5.74805C2.08988 5.18599 2.18827 4.6689 2.43555 4.1836C2.81902 3.43109 3.43109 2.81902 4.1836 2.43555C4.6689 2.18827 5.18599 2.08988 5.74805 2.04395C6.29843 1.99898 6.97632 2 7.79981 2H12Z",fill:"currentColor"}),a.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.5459 2.76758C18.5221 1.79144 20.1047 1.7916 21.0811 2.76758C22.0574 3.74389 22.0574 5.3274 21.0811 6.30371L11.8887 15.4961C10.9124 16.4719 9.32971 16.4721 8.35352 15.4961C7.37721 14.5198 7.37721 12.9363 8.35352 11.96L17.5459 2.76758ZM19.667 4.18164C19.4717 3.98671 19.1551 3.98655 18.96 4.18164L9.76758 13.374C9.57242 13.5692 9.57262 13.8858 9.76758 14.0811C9.96284 14.2763 10.2793 14.2763 10.4746 14.0811L19.667 4.88867C19.8622 4.69341 19.8622 4.37688 19.667 4.18164Z",fill:"currentColor"})]})})})}),Da="_settings_1wnbj_5",pa="_innerContainer_1wnbj_28",xa="_icon_1wnbj_41",St={settings:Da,innerContainer:pa,icon:xa},ya=({onClick:e,visible:t=!1})=>a.jsx("header",{className:St.settings,style:{opacity:t?1:0,pointerEvents:t?"auto":"none"},children:a.jsx("div",{className:St.innerContainer,onClick:e,children:a.jsx("div",{className:St.icon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M19.4 15C19.2669 15.3016 19.2272 15.6362 19.286 15.9606C19.3448 16.285 19.4995 16.5843 19.73 16.82L19.79 16.88C19.976 17.0657 20.1235 17.2863 20.2241 17.5291C20.3248 17.7719 20.3766 18.0322 20.3766 18.295C20.3766 18.5578 20.3248 18.8181 20.2241 19.0609C20.1235 19.3037 19.976 19.5243 19.79 19.71C19.6043 19.896 19.3837 20.0435 19.1409 20.1441C18.8981 20.2448 18.6378 20.2966 18.375 20.2966C18.1122 20.2966 17.8519 20.2448 17.6091 20.1441C17.3663 20.0435 17.1457 19.896 16.96 19.71L16.9 19.65C16.6643 19.4195 16.365 19.2648 16.0406 19.206C15.7162 19.1472 15.3816 19.1869 15.08 19.32C14.7842 19.4468 14.532 19.6572 14.3543 19.9255C14.1766 20.1938 14.0813 20.5082 14.08 20.83V21C14.08 21.5304 13.8693 22.0391 13.4942 22.4142C13.1191 22.7893 12.6104 23 12.08 23C11.5496 23 11.0409 22.7893 10.6658 22.4142C10.2907 22.0391 10.08 21.5304 10.08 21V20.91C10.0723 20.579 9.96512 20.258 9.77251 19.9887C9.5799 19.7194 9.31074 19.5143 9 19.4C8.69838 19.2669 8.36381 19.2272 8.03941 19.286C7.71502 19.3448 7.41568 19.4995 7.18 19.73L7.12 19.79C6.93425 19.976 6.71368 20.1235 6.47088 20.2241C6.22808 20.3248 5.96783 20.3766 5.705 20.3766C5.44217 20.3766 5.18192 20.3248 4.93912 20.2241C4.69632 20.1235 4.47575 19.976 4.29 19.79C4.10405 19.6043 3.95653 19.3837 3.85588 19.1409C3.75523 18.8981 3.70343 18.6378 3.70343 18.375C3.70343 18.1122 3.75523 17.8519 3.85588 17.6091C3.95653 17.3663 4.10405 17.1457 4.29 16.96L4.35 16.9C4.58054 16.6643 4.73519 16.365 4.794 16.0406C4.85282 15.7162 4.81312 15.3816 4.68 15.08C4.55324 14.7842 4.34276 14.532 4.07447 14.3543C3.80618 14.1766 3.49179 14.0813 3.17 14.08H3C2.46957 14.08 1.96086 13.8693 1.58579 13.4942C1.21071 13.1191 1 12.6104 1 12.08C1 11.5496 1.21071 11.0409 1.58579 10.6658C1.96086 10.2907 2.46957 10.08 3 10.08H3.09C3.42099 10.0723 3.742 9.96512 4.0113 9.77251C4.28059 9.5799 4.48572 9.31074 4.6 9C4.73312 8.69838 4.77282 8.36381 4.714 8.03941C4.65519 7.71502 4.50054 7.41568 4.27 7.18L4.21 7.12C4.02405 6.93425 3.87653 6.71368 3.77588 6.47088C3.67523 6.22808 3.62343 5.96783 3.62343 5.705C3.62343 5.44217 3.67523 5.18192 3.77588 4.93912C3.87653 4.69632 4.02405 4.47575 4.21 4.29C4.39575 4.10405 4.61632 3.95653 4.85912 3.85588C5.10192 3.75523 5.36217 3.70343 5.625 3.70343C5.88783 3.70343 6.14808 3.75523 6.39088 3.85588C6.63368 3.95653 6.85425 4.10405 7.04 4.29L7.1 4.35C7.33568 4.58054 7.63502 4.73519 7.95941 4.794C8.28381 4.85282 8.61838 4.81312 8.92 4.68H9C9.29577 4.55324 9.54802 4.34276 9.72569 4.07447C9.90337 3.80618 9.99872 3.49179 10 3.17V3C10 2.46957 10.2107 1.96086 10.5858 1.58579C10.9609 1.21071 11.4696 1 12 1C12.5304 1 13.0391 1.21071 13.4142 1.58579C13.7893 1.96086 14 2.46957 14 3V3.09C14.0013 3.41179 14.0966 3.72618 14.2743 3.99447C14.452 4.26276 14.7042 4.47324 15 4.6C15.3016 4.73312 15.6362 4.77282 15.9606 4.714C16.285 4.65519 16.5843 4.50054 16.82 4.27L16.88 4.21C17.0657 4.02405 17.2863 3.87653 17.5291 3.77588C17.7719 3.67523 18.0322 3.62343 18.295 3.62343C18.5578 3.62343 18.8181 3.67523 19.0609 3.77588C19.3037 3.87653 19.5243 4.02405 19.71 4.21C19.896 4.39575 20.0435 4.61632 20.1441 4.85912C20.2448 5.10192 20.2966 5.36217 20.2966 5.625C20.2966 5.88783 20.2448 6.14808 20.1441 6.39088C20.0435 6.63368 19.896 6.85425 19.71 7.04L19.65 7.1C19.4195 7.33568 19.2648 7.63502 19.206 7.95941C19.1472 8.28381 19.1869 8.61838 19.32 8.92V9C19.4468 9.29577 19.6572 9.54802 19.9255 9.72569C20.1938 9.90337 20.5082 9.99872 20.83 10H21C21.5304 10 22.0391 10.2107 22.4142 10.5858C22.7893 10.9609 23 11.4696 23 12C23 12.5304 22.7893 13.0391 22.4142 13.4142C22.0391 13.7893 21.5304 14 21 14H20.91C20.5882 14.0013 20.2738 14.0966 20.0055 14.2743C19.7372 14.452 19.5268 14.7042 19.4 15Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})})}),ha="_container_na3p7_1",Na="_layer_na3p7_23",Ge={container:ha,layer:Na},ja=e=>{if(e.includes(","))return null;const t=e.match(/^url\(['"]?([^'"]+)['"]?\)$/);return t&&!t[1].startsWith("data:")?t[1]:null},Ta=()=>{const{backgroundBaseValue:e,backgroundTextureValue:t,backgroundTextureTileSize:n,backgroundBlendMode:s}=ot(),[o,i]=Ne.useState([]),[c,u]=Ne.useState([]),I=Ne.useRef(c);return I.current=c,Ne.useEffect(()=>{const l=Date.now(),M=ja(e),m={id:l,value:e,wallpaperUrl:M,visible:!1};i(d=>[...d.slice(-1),m]);const f=setTimeout(()=>{i(d=>d.map(D=>D.id===l?{...D,visible:!0}:D))},50),g=setTimeout(()=>{i(d=>d.filter(D=>D.id===l))},300);return()=>{clearTimeout(f),clearTimeout(g)}},[e]),Ne.useEffect(()=>{const l=Date.now(),M={id:l,value:t,tileSize:n,visible:!1};if(I.current.length>0){u(g=>g.map(d=>({...d,visible:!1})));const f=setTimeout(()=>{t?(u([M]),requestAnimationFrame(()=>{u(g=>g.map(d=>d.id===l?{...d,visible:!0}:d))})):u([])},300);return()=>clearTimeout(f)}else if(t){u(d=>[...d,M]);const f=setTimeout(()=>{u(d=>d.map(D=>D.id===l?{...D,visible:!0}:D))},50),g=setTimeout(()=>{u(d=>d.filter(D=>D.id===l))},300);return()=>{clearTimeout(f),clearTimeout(g)}}else u([])},[t,n]),a.jsxs("div",{className:Ge.container,children:[o.map(l=>a.jsx("div",{className:Ge.layerWrapper,style:{zIndex:0},children:l.wallpaperUrl?a.jsx("img",{src:l.wallpaperUrl,alt:"",className:Ge.layer,style:{opacity:l.visible?1:0,zIndex:l.id}}):a.jsx("div",{className:Ge.layer,style:{background:l.value,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",opacity:l.visible?1:0,zIndex:l.id}})},`base-${l.id}`)),c.map(l=>l.value?a.jsx("div",{className:Ge.layerWrapper,style:{zIndex:1,mixBlendMode:s},children:a.jsx("div",{className:Ge.layer,style:{backgroundImage:l.value,backgroundSize:l.tileSize||"var(--background-size)",backgroundPosition:"center",backgroundRepeat:"repeat",opacity:l.visible?1:0,zIndex:l.id}})},`tex-${l.id}`):null)]})},Aa=500,Rn=r.createContext(void 0),Ea=()=>`sticker-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,Ca=({children:e})=>{const[t,n]=r.useState(()=>ie.getStickers()),[s,o]=r.useState(null),i=r.useRef();r.useEffect(()=>(i.current&&clearTimeout(i.current),i.current=window.setTimeout(()=>{ie.saveStickers(t)},Aa),()=>{i.current&&clearTimeout(i.current)}),[t]);const c=r.useCallback(f=>{n(g=>{const d=Math.max(...g.map(y=>y.zIndex||1),0),D={...f,id:Ea(),zIndex:d+1,style:f.type==="text"?f.style||tr:void 0};return[...g,D]})},[]),u=r.useCallback((f,g)=>{n(d=>d.map(D=>D.id===f?{...D,...g}:D))},[]),I=r.useCallback(f=>{n(g=>g.filter(d=>d.id!==f)),o(g=>g===f?null:g)},[]),l=r.useCallback(f=>{n(g=>{const d=Math.max(...g.map(D=>D.zIndex||1),0);return g.map(D=>D.id===f?{...D,zIndex:d+1}:D)})},[]),M=r.useCallback(f=>{o(f)},[]),m=r.useMemo(()=>({stickers:t,selectedStickerId:s,addSticker:c,updateSticker:u,deleteSticker:I,selectSticker:M,bringToTop:l}),[t,s,c,u,I,M,l]);return a.jsx(Rn.Provider,{value:m,children:e})},ka=()=>{const e=r.useContext(Rn);if(e===void 0)throw new Error("useZenShelf must be used within a ZenShelfProvider");return e};function cn(e,t){const n=URL.createObjectURL(e),s=document.createElement("a");s.href=n,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}async function wa(e){try{await navigator.clipboard.write([new ClipboardItem({"image/png":e})])}catch(t){throw t}}function Sa(e){return new Promise(t=>{const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const s=n.getContext("2d");s?(s.drawImage(e,0,0),n.toBlob(o=>{t(o)},"image/png")):t(null)})}function ba(e){return new Promise(t=>{if(e.type!=="text"){t(null);return}const n=getComputedStyle(document.documentElement).getPropertyValue("--color-sticker-stroke").trim()||"white",s=600,o=48,i=.25,u=document.createElement("canvas").getContext("2d");if(!u){t(null);return}u.font=`900 ${o}px "Bricolage Grotesque", sans-serif`;const I=e.content.split(`
`),l=o*.9;let M=0;for(const _ of I){const G=u.measureText(_);M=Math.max(M,G.width)}const m=o*i,f=m/2,g=16+f,d=12+f,D=M,y=l*I.length,x=o*.2,Y=D+g*2,O=y+d*2+x,P=O<s?s/O:1,F=Math.ceil(Y*P),E=Math.ceil(O*P),k=Math.round(o*P),T=Math.round(g*P),U=Math.round(m*P),p=k*.9,N=document.createElement("canvas");N.width=F,N.height=E;const w=N.getContext("2d");if(w){w.font=`900 ${k}px "Bricolage Grotesque", sans-serif`,w.textBaseline="middle";let _;e.style?.textAlign==="center"?(w.textAlign="center",_=F/2):e.style?.textAlign==="right"?(w.textAlign="right",_=F-T):(w.textAlign="left",_=T),w.strokeStyle=n,w.lineWidth=U,w.lineJoin="round",w.miterLimit=2;const G=p*I.length;let S=(E-G)/2+p/2;for(const z of I)w.strokeText(z,_,S),S+=p;w.fillStyle=e.style?.color||"#1C1C1E",S=(E-G)/2+p/2;for(const z of I)w.fillText(z,_,S),S+=p;N.toBlob(z=>{t(z)},"image/png")}else t(null)})}function La(e){return new Promise(t=>{if(e.type!=="image"){t(null);return}const n=new Image;n.onload=()=>{const s=getComputedStyle(document.documentElement).getPropertyValue("--color-sticker-stroke").trim()||"white",o=16,i=6,c=12,u=6,I=i+c,l=n.width+I*2,M=n.height+I*2+u,m=document.createElement("canvas");m.width=l,m.height=M;const f=m.getContext("2d");if(f){const g=I,d=I,D=(y,x,Y,O,P)=>{f.beginPath(),f.moveTo(y+P,x),f.lineTo(y+Y-P,x),f.quadraticCurveTo(y+Y,x,y+Y,x+P),f.lineTo(y+Y,x+O-P),f.quadraticCurveTo(y+Y,x+O,y+Y-P,x+O),f.lineTo(y+P,x+O),f.quadraticCurveTo(y,x+O,y,x+O-P),f.lineTo(y,x+P),f.quadraticCurveTo(y,x,y+P,x),f.closePath()};f.save(),f.shadowColor="rgba(0, 0, 0, 0.15)",f.shadowBlur=c,f.shadowOffsetY=u,D(g,d,n.width,n.height,o),f.fillStyle="white",f.fill(),f.restore(),D(g,d,n.width,n.height,o),f.strokeStyle=s,f.lineWidth=i*2,f.stroke(),f.save(),D(g,d,n.width,n.height,o),f.clip(),f.drawImage(n,g,d),f.restore(),m.toBlob(y=>{t(y)},"image/png")}else t(null)},n.onerror=()=>{t(null)},n.src=e.content})}const Oa="_canvas_14a9x_7",za="_creativeMode_14a9x_37",va="_sticker_14a9x_57",_a="_stickerText_14a9x_83",Ra="_dragging_14a9x_99",Ua="_creativeHover_14a9x_109",Qa="_imageSticker_14a9x_125",Ya="_textSticker_14a9x_119",Pa="_bounceBack_14a9x_177",$a="_selected_14a9x_205",Fa="_imageContainer_14a9x_301",Ba="_resizeHandle_14a9x_315",Wa="_deleteButton_14a9x_371",Ga="_textInputPopup_14a9x_441",Za="_textInputInner_14a9x_475",Ha="_textInputLabel_14a9x_499",Va="_textInput_14a9x_441",Xa="_styleOptionsSection_14a9x_575",qa="_alignmentGroup_14a9x_589",Ja="_highlightBackground_14a9x_615",Ka="_alignmentButton_14a9x_641",ei="_colorOptionsGrid_14a9x_683",ti="_colorOptionBtn_14a9x_701",ni="_active_14a9x_677",ri="_textInputActions_14a9x_739",si="_textInputCancel_14a9x_751",oi="_textInputConfirm_14a9x_787",ai="_floatingToolbar_14a9x_837",ii="_toolbarDivider_14a9x_871",ci="_alignButton_14a9x_885",li="_colorButton_14a9x_933",ui="_contextMenu_14a9x_973",di="_menuLabel_14a9x_1009",gi="_menuDivider_14a9x_1035",Mi="_menuOptions_14a9x_1073",Ii="_menuItem_14a9x_1089",fi="_danger_14a9x_1151",mi="_menuIcon_14a9x_1169",Di="_stickerPreviewContainer_14a9x_1209",pi="_stickerPreviewInput_14a9x_1229",xi="_stickerToolbar_14a9x_1329",yi="_toolbarAlignGroup_14a9x_1361",hi="_toolbarHighlight_14a9x_1381",Ni="_toolbarIcon_14a9x_1407",ji="_toolbarAlignBtn_14a9x_1431",Ti="_toolbarColorGroup_14a9x_1473",Ai="_toolbarColorBtn_14a9x_1483",Ei="_toolbarCancelBtn_14a9x_1519",Ci="_toolbarConfirmBtn_14a9x_1553",b={canvas:Oa,creativeMode:za,sticker:va,stickerText:_a,dragging:Ra,creativeHover:Ua,imageSticker:Qa,textSticker:Ya,bounceBack:Pa,selected:$a,imageContainer:Fa,resizeHandle:Ba,deleteButton:Wa,textInputPopup:Ga,textInputInner:Za,textInputLabel:Ha,textInput:Va,styleOptionsSection:Xa,alignmentGroup:qa,highlightBackground:Ja,alignmentButton:Ka,colorOptionsGrid:ei,colorOptionBtn:ti,active:ni,textInputActions:ri,textInputCancel:si,textInputConfirm:oi,floatingToolbar:ai,toolbarDivider:ii,alignButton:ci,colorButton:li,contextMenu:ui,menuLabel:di,menuDivider:gi,menuOptions:Mi,menuItem:Ii,danger:fi,menuIcon:mi,stickerPreviewContainer:Di,stickerPreviewInput:pi,stickerToolbar:xi,toolbarAlignGroup:yi,toolbarHighlight:hi,toolbarIcon:Ni,toolbarAlignBtn:ji,toolbarColorGroup:Ti,toolbarColorBtn:Ai,toolbarCancelBtn:Ei,toolbarConfirmBtn:Ci},pt=["#1C1C1E","#FF3B30","#007AFF","#34C759","#FF9500","#AF52DE","#FFFFFF"],ki=({sticker:e,stickerRect:t,onStyleChange:n})=>{const s=e.style?.textAlign||"left",o=e.style?.color||pt[0],i={left:t.left+t.width/2,top:t.top-50,transform:"translateX(-50%)"};return a.jsxs("div",{className:b.floatingToolbar,style:i,children:[a.jsx("button",{className:`${b.alignButton} ${s==="left"?b.active:""}`,onClick:()=>n({textAlign:"left"}),title:"Align Left",children:"☰"}),a.jsx("button",{className:`${b.alignButton} ${s==="center"?b.active:""}`,onClick:()=>n({textAlign:"center"}),title:"Center",children:"≡"}),a.jsx("button",{className:`${b.alignButton} ${s==="right"?b.active:""}`,onClick:()=>n({textAlign:"right"}),title:"Align Right",children:"≡"}),a.jsx("div",{className:b.toolbarDivider}),pt.map(c=>a.jsx("button",{className:`${b.colorButton} ${o===c?b.active:""}`,style:{background:c},onClick:()=>n({color:c}),title:c},c))]})},wi=(e,t)=>e.sticker.id===t.sticker.id&&e.sticker.style?.color===t.sticker.style?.color&&e.sticker.style?.textAlign===t.sticker.style?.textAlign&&e.stickerRect.left===t.stickerRect.left&&e.stickerRect.top===t.stickerRect.top&&e.stickerRect.width===t.stickerRect.width,Si=Ne.memo(ki,wi),ln="#1C1C1E",un="#FFFFFF",bi=(e,t)=>{if(t!=="dark")return e;const n=e.toUpperCase();return n===ln.toUpperCase()||n==="#1C1C1E"?un:n===un.toUpperCase()||n==="#FFF"?ln:e},Ee={BOTTOM_MARGIN:200,TOP_LEFT:{width:48,height:48},TOP_RIGHT:{width:48,height:48},EDGE_MARGIN:20},Li=({sticker:e,isSelected:t,isCreativeMode:n,onSelect:s,onDelete:o,onPositionChange:i,onStyleChange:c,onBringToTop:u,onScaleChange:I,isEditMode:l,viewportScale:M,onDoubleClick:m})=>{const{theme:f}=ot(),g=r.useRef(null),[d,D]=r.useState(!1),[y,x]=r.useState(!1),[Y,O]=r.useState(!1),[P,F]=r.useState(null),E=r.useRef(null),k=r.useRef(null),[T,U]=r.useState(300),p=r.useRef({rotation:0,targetRotation:0,lastX:0}),N=r.useRef(!1),w=r.useRef();r.useEffect(()=>{t&&g.current?F(g.current.getBoundingClientRect()):F(null)},[t,e.x,e.y]);const _=r.useCallback(()=>{const{rotation:j,targetRotation:Q}=p.current,K=Q-j,A=j+K*.15;p.current.rotation=A,g.current&&(g.current.style.transform=`rotate(${A.toFixed(2)}deg)`),N.current||Math.abs(K)>.05||Math.abs(A)>.05?w.current=requestAnimationFrame(_):(g.current&&(g.current.style.transform=""),p.current.rotation=0,p.current.targetRotation=0)},[]),G=j=>{j.target.closest(`.${b.deleteButton}`)||j.target.closest(`.${b.resizeHandle}`)||(n&&!l&&s(),u(),D(!0),N.current=!0,E.current={x:j.clientX,y:j.clientY,stickerX:e.x,stickerY:e.y},p.current.lastX=j.clientX,p.current.targetRotation=0,w.current&&cancelAnimationFrame(w.current),w.current=requestAnimationFrame(_),j.preventDefault(),j.stopPropagation())};r.useEffect(()=>{if(!d)return;let j=null,Q=null;const K=v=>{if(!E.current)return;const W=v.clientX-E.current.x,H=v.clientY-E.current.y;Q={x:E.current.stickerX+W/M,y:E.current.stickerY+H/M},j===null&&(j=requestAnimationFrame(()=>{j=null,Q&&g.current&&(g.current.style.left=`${Q.x*M}px`,g.current.style.top=`${Q.y*M}px`)}));const se=v.clientX-p.current.lastX;p.current.lastX=v.clientX;const te=.4,X=12;let le=-se*te;le=Math.max(-X,Math.min(X,le)),p.current.targetRotation=le},A=()=>{j!==null&&cancelAnimationFrame(j);const v=g.current;if(!v){D(!1),N.current=!1,E.current=null;return}let W=Q?.x??e.x,H=Q?.y??e.y;const se=window.innerWidth,te=window.innerHeight;let X=!1;const le=v.getBoundingClientRect(),Me=le.width,ue=le.height,De=W*M,pe=H*M,xe={left:De,top:pe,right:De+Me,bottom:pe+ue},Ce=(ne,de)=>!(ne.right<de.left||ne.left>de.right||ne.bottom<de.top||ne.top>de.bottom),ke=document.querySelector('[data-ui-zone="bottom"]');if(ke){const ne=ke.getBoundingClientRect();if(Ce(xe,ne)){const de=xe.bottom-ne.top+Ee.EDGE_MARGIN,at=xe.right-ne.left+Ee.EDGE_MARGIN,oe=ne.right-xe.left+Ee.EDGE_MARGIN,Ie=xe.left-at>=Ee.EDGE_MARGIN,ye=xe.right+oe<=se-Ee.EDGE_MARGIN;let ze=de,Re="up";switch(Ie&&at<ze&&(ze=at,Re="left"),ye&&oe<ze&&(ze=oe,Re="right"),Re){case"up":H=(ne.top-ue-Ee.EDGE_MARGIN)/M;break;case"left":W=(ne.left-Me-Ee.EDGE_MARGIN)/M;break;case"right":W=(ne.right+Ee.EDGE_MARGIN)/M;break}X=!0}}const V=Me/M,C=ue/M,q=se/M-V-Ee.EDGE_MARGIN/M,h=te/M-C-Ee.EDGE_MARGIN/M,$=Ee.EDGE_MARGIN/M,Z=Ee.EDGE_MARGIN/M;let J=W;q<$?J=Math.max(q,Math.min($,W)):J=Math.max($,Math.min(q,W));let ee=H;h<Z?ee=Math.max(h,Math.min(Z,H)):ee=Math.max(Z,Math.min(h,H)),(Math.abs(J-W)>.1||Math.abs(ee-H)>.1)&&(X=!0),W=J,H=ee,X&&(g.current&&(g.current.classList.add(b.bounceBack),g.current.style.left=`${W*M}px`,g.current.style.top=`${H*M}px`),O(!0),setTimeout(()=>O(!1),350)),(X||Q)&&i(W,H),D(!1),N.current=!1,E.current=null,p.current.targetRotation=0};return document.addEventListener("mousemove",K,{capture:!0}),document.addEventListener("mouseup",A,{capture:!0}),()=>{document.removeEventListener("mousemove",K,{capture:!0}),document.removeEventListener("mouseup",A,{capture:!0}),j!==null&&cancelAnimationFrame(j)}},[d,i,_]),r.useEffect(()=>()=>{w.current&&cancelAnimationFrame(w.current)},[]);const S=j=>{j.preventDefault(),j.stopPropagation(),x(!0),k.current={x:j.clientX,y:j.clientY,startScale:e.scale||1}};r.useEffect(()=>{if(!y)return;let j=null,Q=null;const K=v=>{if(!k.current)return;const W=v.clientX-k.current.x,H=v.clientY-k.current.y,te=(W+H)/2/200;Q=Math.max(.2,Math.min(3,k.current.startScale+te)),j===null&&(j=requestAnimationFrame(()=>{j=null,Q!==null&&I(Q)}))},A=()=>{j!==null&&(cancelAnimationFrame(j),Q!==null&&I(Q)),x(!1),k.current=null};return document.addEventListener("mousemove",K),document.addEventListener("mouseup",A),()=>{document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",A),j!==null&&cancelAnimationFrame(j)}},[y,I]);const z=j=>{U(j.currentTarget.naturalWidth)},re=j=>{j.stopPropagation(),m?.()},L=[b.sticker,e.type==="text"&&b.stickerText,d&&b.dragging,Y&&b.bounceBack,t&&b.selected,n&&b.creativeHover].filter(Boolean).join(" "),R=e.type==="image"?Math.min(T,nt)*(e.scale||1)*M:void 0,B=(e.style?.fontSize||40)*M;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{ref:g,className:L,style:{left:e.x*M,top:e.y*M,zIndex:d?3e3:e.zIndex||1},"data-sticker-id":e.id,onMouseDown:G,onDoubleClick:re,children:[e.type==="text"?a.jsx("div",{className:[b.textSticker,d&&b.dragging,n&&b.creativeHover].filter(Boolean).join(" "),style:{color:bi(e.style?.color||"#1C1C1E",f),textAlign:e.style?.textAlign||"left",fontSize:B},children:e.content}):a.jsxs("div",{className:b.imageContainer,children:[a.jsx("img",{src:e.content,alt:"sticker",className:[b.imageSticker,d&&b.dragging,n&&b.creativeHover].filter(Boolean).join(" "),style:{width:R},draggable:!1,onLoad:z}),a.jsx("div",{className:b.resizeHandle,onMouseDown:S})]}),n&&!l&&a.jsx("button",{className:b.deleteButton,onClick:j=>{j.stopPropagation(),o()},children:"×"})]}),t&&e.type==="text"&&P&&a.jsx(Si,{sticker:e,stickerRect:P,onStyleChange:c})]})},Oi=(e,t)=>e.sticker.id===t.sticker.id&&e.sticker.x===t.sticker.x&&e.sticker.y===t.sticker.y&&e.sticker.content===t.sticker.content&&e.sticker.zIndex===t.sticker.zIndex&&e.sticker.scale===t.sticker.scale&&e.sticker.type===t.sticker.type&&e.sticker.style?.color===t.sticker.style?.color&&e.sticker.style?.textAlign===t.sticker.style?.textAlign&&e.sticker.style?.fontSize===t.sticker.style?.fontSize&&e.isSelected===t.isSelected&&e.isCreativeMode===t.isCreativeMode&&e.isEditMode===t.isEditMode&&e.viewportScale===t.viewportScale,zi=Ne.memo(Li,Oi),dn="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIgNkMyIDUuNzM0NzggMi4xMDUzNiA1LjQ4MDQzIDIuMjkyODkgNS4yOTI4OUMyLjQ4MDQzIDUuMTA1MzYgMi43MzQ3OCA1IDMgNUgyMUMyMS4yNjUyIDUgMjEuNTE5NiA1LjEwNTM2IDIxLjcwNzEgNS4yOTI4OUMyMS44OTQ2IDUuNDgwNDMgMjIgNS43MzQ3OCAyMiA2QzIyIDYuMjY1MjIgMjEuODk0NiA2LjUxOTU3IDIxLjcwNzEgNi43MDcxMUMyMS41MTk2IDYuODk0NjQgMjEuMjY1MiA3IDIxIDdIM0MyLjg2ODY4IDcgMi43Mzg2NCA2Ljk3NDEzIDIuNjE3MzIgNi45MjM4OEMyLjQ5NTk5IDYuODczNjIgMi4zODU3NSA2Ljc5OTk3IDIuMjkyODkgNi43MDcxMUMyLjIwMDAzIDYuNjE0MjUgMi4xMjYzOCA2LjUwNDAxIDIuMDc2MTIgNi4zODI2OEMyLjAyNTg3IDYuMjYxMzYgMiA2LjEzMTMyIDIgNlpNMiAxMkMyIDExLjczNDggMi4xMDUzNiAxMS40ODA0IDIuMjkyODkgMTEuMjkyOUMyLjQ4MDQzIDExLjEwNTQgMi43MzQ3OCAxMSAzIDExSDIxQzIxLjI2NTIgMTEgMjEuNTE5NiAxMS4xMDU0IDIxLjcwNzEgMTEuMjkyOUMyMS44OTQ2IDExLjQ4MDQgMjIgMTEuNzM0OCAyMiAxMkMyMiAxMi4yNjUyIDIxLjg5NDYgMTIuNTE5NiAyMS43MDcxIDEyLjcwNzFDMjEuNTE5NiAxMi44OTQ2IDIxLjI2NTIgMTMgMjEgMTNIM0MyLjczNDc4IDEzIDIuNDgwNDMgMTIuODk0NiAyLjI5Mjg5IDEyLjcwNzFDMi4xMDUzNiAxMi41MTk2IDIgMTIuMjY1MiAyIDEyWk0yIDE4QzIgMTcuNzM0OCAyLjEwNTM2IDE3LjQ4MDQgMi4yOTI4OSAxNy4yOTI5QzIuNDgwNDMgMTcuMTA1NCAyLjczNDc4IDE3IDMgMTdIMTRDMTQuMjY1MiAxNyAxNC41MTk2IDE3LjEwNTQgMTQuNzA3MSAxNy4yOTI5QzE0Ljg5NDYgMTcuNDgwNCAxNSAxNy43MzQ4IDE1IDE4QzE1IDE4LjI2NTIgMTQuODk0NiAxOC41MTk2IDE0LjcwNzEgMTguNzA3MUMxNC41MTk2IDE4Ljg5NDYgMTQuMjY1MiAxOSAxNCAxOUgzQzIuNzM0NzggMTkgMi40ODA0MyAxOC44OTQ2IDIuMjkyODkgMTguNzA3MUMyLjEwNTM2IDE4LjUxOTYgMiAxOC4yNjUyIDIgMThaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K",gn="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIgNkMyIDUuNzM0NzggMi4xMDUzNiA1LjQ4MDQzIDIuMjkyODkgNS4yOTI4OUMyLjQ4MDQzIDUuMTA1MzYgMi43MzQ3OCA1IDMgNUgyMUMyMS4yNjUyIDUgMjEuNTE5NiA1LjEwNTM2IDIxLjcwNzEgNS4yOTI4OUMyMS44OTQ2IDUuNDgwNDMgMjIgNS43MzQ3OCAyMiA2QzIyIDYuMjY1MjIgMjEuODk0NiA2LjUxOTU3IDIxLjcwNzEgNi43MDcxMUMyMS41MTk2IDYuODk0NjQgMjEuMjY1MiA3IDIxIDdIM0MyLjg2ODY4IDcgMi43Mzg2NCA2Ljk3NDEzIDIuNjE3MzIgNi45MjM4OEMyLjQ5NTk5IDYuODczNjIgMi4zODU3NSA2Ljc5OTk3IDIuMjkyODkgNi43MDcxMUMyLjIwMDAzIDYuNjE0MjUgMi4xMjYzOCA2LjUwNDAxIDIuMDc2MTIgNi4zODI2OEMyLjAyNTg3IDYuMjYxMzYgMiA2LjEzMTMyIDIgNlpNMiAxMkMyIDExLjczNDggMi4xMDUzNiAxMS40ODA0IDIuMjkyODkgMTEuMjkyOUMyLjQ4MDQzIDExLjEwNTQgMi43MzQ3OCAxMSAzIDExSDIxQzIxLjI2NTIgMTEgMjEuNTE5NiAxMS4xMDU0IDIxLjcwNzEgMTEuMjkyOUMyMS44OTQ2IDExLjQ4MDQgMjIgMTEuNzM0OCAyMiAxMkMyMiAxMi4yNjUyIDIxLjg5NDYgMTIuNTE5NiAyMS43MDcxIDEyLjcwNzFDMjEuNTE5NiAxMi44OTQ2IDIxLjI2NTIgMTMgMjEgMTNIM0MyLjczNDc4IDEzIDIuNDgwNDMgMTIuODk0NiAyLjI5Mjg5IDEyLjcwNzFDMi4xMDUzNiAxMi41MTk2IDIgMTIuMjY1MiAyIDEyWk02IDE4QzYgMTcuNzM0OCA2LjEwNTM2IDE3LjQ4MDQgNi4yOTI4OSAxNy4yOTI5QzYuNDgwNDMgMTcuMTA1NCA2LjczNDc4IDE3IDcgMTdIMTdDMTcuMjY1MiAxNyAxNy41MTk2IDE3LjEwNTQgMTcuNzA3MSAxNy4yOTI5QzE3Ljg5NDYgMTcuNDgwNCAxOCAxNy43MzQ4IDE4IDE4QzE4IDE4LjI2NTIgMTcuODk0NiAxOC41MTk2IDE3LjcwNzEgMTguNzA3MUMxNy41MTk2IDE4Ljg5NDYgMTcuMjY1MiAxOSAxNyAxOUg3QzYuNzM0NzggMTkgNi40ODA0MyAxOC44OTQ2IDYuMjkyODkgMTguNzA3MUM2LjEwNTM2IDE4LjUxOTYgNiAxOC4yNjUyIDYgMThaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K",Mn="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIgNkMyIDUuNzM0NzggMi4xMDUzNiA1LjQ4MDQzIDIuMjkyODkgNS4yOTI4OUMyLjQ4MDQzIDUuMTA1MzYgMi43MzQ3OCA1IDMgNUgyMUMyMS4yNjUyIDUgMjEuNTE5NiA1LjEwNTM2IDIxLjcwNzEgNS4yOTI4OUMyMS44OTQ2IDUuNDgwNDMgMjIgNS43MzQ3OCAyMiA2QzIyIDYuMjY1MjIgMjEuODk0NiA2LjUxOTU3IDIxLjcwNzEgNi43MDcxMUMyMS41MTk2IDYuODk0NjQgMjEuMjY1MiA3IDIxIDdIM0MyLjg2ODY4IDcgMi43Mzg2NCA2Ljk3NDEzIDIuNjE3MzIgNi45MjM4OEMyLjQ5NTk5IDYuODczNjIgMi4zODU3NSA2Ljc5OTk3IDIuMjkyODkgNi43MDcxMUMyLjIwMDAzIDYuNjE0MjUgMi4xMjYzOCA2LjUwNDAxIDIuMDc2MTIgNi4zODI2OEMyLjAyNTg3IDYuMjYxMzYgMiA2LjEzMTMyIDIgNlpNMiAxMkMyIDExLjczNDggMi4xMDUzNiAxMS40ODA0IDIuMjkyODkgMTEuMjkyOUMyLjQ4MDQzIDExLjEwNTQgMi43MzQ3OCAxMSAzIDExSDIxQzIxLjI2NTIgMTEgMjEuNTE5NiAxMS4xMDU0IDIxLjcwNzEgMTEuMjkyOUMyMS44OTQ2IDExLjQ4MDQgMjIgMTEuNzM0OCAyMiAxMkMyMiAxMi4yNjUyIDIxLjg5NDYgMTIuNTE5NiAyMS43MDcxIDEyLjcwNzFDMjEuNTE5NiAxMi44OTQ2IDIxLjI2NTIgMTMgMjEgMTNIM0MyLjczNDc4IDEzIDIuNDgwNDMgMTIuODk0NiAyLjI5Mjg5IDEyLjcwNzFDMi4xMDUzNiAxMi41MTk2IDIgMTIuMjY1MiAyIDEyWk05IDE4QzkgMTcuNzM0OCA5LjEwNTM2IDE3LjQ4MDQgOS4yOTI4OSAxNy4yOTI5QzkuNDgwNDMgMTcuMTA1NCA5LjczNDc4IDE3IDEwIDE3SDIxQzIxLjI2NTIgMTcgMjEuNTE5NiAxNy4xMDU0IDIxLjcwNzEgMTcuMjkyOUMyMS44OTQ2IDE3LjQ4MDQgMjIgMTcuNzM0OCAyMiAxOEMyMiAxOC4yNjUyIDIxLjg5NDYgMTguNTE5NiAyMS43MDcxIDE4LjcwNzFDMjEuNTE5NiAxOC44OTQ2IDIxLjI2NTIgMTkgMjEgMTlIMTBDOS43MzQ3OCAxOSA5LjQ4MDQzIDE4Ljg5NDYgOS4yOTI4OSAxOC43MDcxQzkuMTA1MzYgMTguNTE5NiA5IDE4LjI2NTIgOSAxOFoiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=",In="#1C1C1E",fn="#FFFFFF",vi=(e,t)=>{if(t!=="dark")return e;const n=e.toUpperCase();return n===In.toUpperCase()||n==="#1C1C1E"?fn:n===fn.toUpperCase()||n==="#FFF"?In:e},_i=({x:e,y:t,initialText:n="",initialStyle:s,onSubmit:o,onCancel:i,viewportScale:c})=>{const{t:u}=Ke(),{theme:I}=ot(),l=r.useRef(null),M=r.useRef(null),m=r.useRef(null),f=r.useRef(null),[g,d]=r.useState(n),[D,y]=r.useState(s?.textAlign||"left"),[x,Y]=r.useState(s?.color||pt[0]),[O,P]=r.useState(s?.fontSize||40),[F,E]=r.useState(!1),k=[{label:u.textInput.l,value:40},{label:u.textInput.m,value:32},{label:u.textInput.s,value:24}];r.useEffect(()=>{if(m.current&&Xe(m.current,200),M.current&&(n||Xe(M.current,200)),l.current&&(l.current.focus(),n)){l.current.innerText=n;const S=document.createRange();S.selectNodeContents(l.current),S.collapse(!1);const z=window.getSelection();z?.removeAllRanges(),z?.addRange(S)}},[n]),r.useEffect(()=>{l.current&&(l.current.style.fontSize=`${O*c}px`)},[O,c]);const T=r.useCallback((S,z=!0)=>{F||(E(!0),z&&M.current&&Pe(M.current,150),m.current?Pe(m.current,150,S):S())},[F]);r.useEffect(()=>{const S=re=>{if(F)return;const L=re.target;if(l.current?.contains(L)||m.current?.contains(L))return;const R=l.current?.innerText?.trim()||"";R?T(()=>o(R,{color:x,textAlign:D,fontSize:O}),!1):T(i)},z=setTimeout(()=>{document.addEventListener("mousedown",S)},100);return()=>{clearTimeout(z),document.removeEventListener("mousedown",S)}},[x,D,O,o,i,F,T]);const U=S=>{S.key==="Enter"&&!S.shiftKey?(S.preventDefault(),w()):S.key==="Escape"&&_()},p=()=>{l.current&&d(l.current.innerText)},N=S=>{S.preventDefault();const z=S.clipboardData.getData("text/plain");document.execCommand("insertText",!1,z),p()},w=()=>{const S=l.current?.innerText?.trim()||"";S?T(()=>o(S,{color:x,textAlign:D,fontSize:O}),!1):_()},_=()=>{T(i)},G=k.findIndex(S=>S.value===O);return Ye.createPortal(a.jsxs("div",{ref:f,className:`${b.stickerPreviewContainer} ${F?b.exiting:""}`,style:{left:e,top:t},children:[a.jsx("div",{ref:M,children:a.jsx("div",{ref:l,className:b.stickerPreviewInput,contentEditable:!0,suppressContentEditableWarning:!0,style:{color:vi(x,I),textAlign:D,fontSize:`${O*c}px`},onInput:p,onKeyDown:U,onPaste:N,onClick:S=>S.stopPropagation(),"data-placeholder":u.textInput.placeholder})}),a.jsxs("div",{ref:m,className:b.stickerToolbar,onClick:S=>S.stopPropagation(),children:[a.jsxs("div",{className:b.toolbarAlignGroup,children:[a.jsx("div",{className:b.toolbarHighlight,style:{transform:`translateX(${["left","center","right"].indexOf(D)*100}%)`}}),a.jsx("button",{className:b.toolbarAlignBtn,onClick:()=>y("left"),title:"Align Left",children:a.jsx("span",{className:b.toolbarIcon,style:{WebkitMaskImage:`url(${dn})`,maskImage:`url(${dn})`}})}),a.jsx("button",{className:b.toolbarAlignBtn,onClick:()=>y("center"),title:"Center",children:a.jsx("span",{className:b.toolbarIcon,style:{WebkitMaskImage:`url(${gn})`,maskImage:`url(${gn})`}})}),a.jsx("button",{className:b.toolbarAlignBtn,onClick:()=>y("right"),title:"Align Right",children:a.jsx("span",{className:b.toolbarIcon,style:{WebkitMaskImage:`url(${Mn})`,maskImage:`url(${Mn})`}})})]}),a.jsx("div",{className:b.toolbarDivider}),a.jsxs("div",{className:b.toolbarAlignGroup,children:[a.jsx("div",{className:b.toolbarHighlight,style:{transform:`translateX(${G*100}%)`}}),k.map(S=>a.jsx("button",{className:b.toolbarAlignBtn,onClick:()=>P(S.value),title:`Font Size: ${S.value}px`,children:S.label},S.value))]}),a.jsx("div",{className:b.toolbarDivider}),a.jsx("div",{className:b.toolbarColorGroup,children:pt.map(S=>a.jsx("button",{className:`${b.toolbarColorBtn} ${x===S?b.active:""}`,style:{backgroundColor:S},onClick:()=>Y(S),title:S},S))}),a.jsx("div",{className:b.toolbarDivider}),a.jsx("button",{className:b.toolbarCancelBtn,onClick:_,children:u.textInput.cancel}),a.jsx("button",{className:b.toolbarConfirmBtn,onClick:w,disabled:!g.trim(),children:u.textInput.confirm})]})]}),document.body)},Ze="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIgM0MyIDIuNzM0NzggMi4xMDUzNiAyLjQ4MDQzIDIuMjkyODkgMi4yOTI4OUMyLjQ4MDQzIDIuMTA1MzYgMi43MzQ3OCAyIDMgMkgyMUMyMS4yNjUyIDIgMjEuNTE5NiAyLjEwNTM2IDIxLjcwNzEgMi4yOTI4OUMyMS44OTQ2IDIuNDgwNDMgMjIgMi43MzQ3OCAyMiAzQzIyIDMuMjY1MjIgMjEuODk0NiAzLjUxOTU3IDIxLjcwNzEgMy43MDcxMUMyMS41MTk2IDMuODk0NjQgMjEuMjY1MiA0IDIxIDRIM0MyLjczNDc4IDQgMi40ODA0MyAzLjg5NDY0IDIuMjkyODkgMy43MDcxMUMyLjEwNTM2IDMuNTE5NTcgMiAzLjI2NTIyIDIgM1pNMTIgNkMxMi4yNjUyIDYuMDAwMDYgMTIuNTE5NSA2LjEwNTQ1IDEyLjcwNyA2LjI5M0wxOC43MDcgMTIuMjkzQzE4Ljg4OTIgMTIuNDgxNiAxOC45OSAxMi43MzQyIDE4Ljk4NzcgMTIuOTk2NEMxOC45ODU0IDEzLjI1ODYgMTguODgwMiAxMy41MDk0IDE4LjY5NDggMTMuNjk0OEMxOC41MDk0IDEzLjg4MDIgMTguMjU4NiAxMy45ODU0IDE3Ljk5NjQgMTMuOTg3N0MxNy43MzQyIDEzLjk5IDE3LjQ4MTYgMTMuODg5MiAxNy4yOTMgMTMuNzA3TDEzIDkuNDE0VjIxQzEzIDIxLjI2NTIgMTIuODk0NiAyMS41MTk2IDEyLjcwNzEgMjEuNzA3MUMxMi41MTk2IDIxLjg5NDYgMTIuMjY1MiAyMiAxMiAyMkMxMS43MzQ4IDIyIDExLjQ4MDQgMjEuODk0NiAxMS4yOTI5IDIxLjcwNzFDMTEuMTA1NCAyMS41MTk2IDExIDIxLjI2NTIgMTEgMjFWOS40MTRMNi43MDcgMTMuNzA3QzYuNTE4NCAxMy44ODkyIDYuMjY1OCAxMy45OSA2LjAwMzYgMTMuOTg3N0M1Ljc0MTQgMTMuOTg1NCA1LjQ5MDU5IDEzLjg4MDIgNS4zMDUxOCAxMy42OTQ4QzUuMTE5NzcgMTMuNTA5NCA1LjAxNDYgMTMuMjU4NiA1LjAxMjMzIDEyLjk5NjRDNS4wMTAwNSAxMi43MzQyIDUuMTEwODQgMTIuNDgxNiA1LjI5MyAxMi4yOTNMMTEuMjkzIDYuMjkzQzExLjQ4MDUgNi4xMDU0NSAxMS43MzQ4IDYuMDAwMDYgMTIgNloiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=",mn="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMTJDOCAxMC45MzkxIDguNDIxNDMgOS45MjE3MiA5LjE3MTU3IDkuMTcxNTdDOS45MjE3MiA4LjQyMTQzIDEwLjkzOTEgOCAxMiA4QzEzLjA2MDkgOCAxNC4wNzgzIDguNDIxNDMgMTQuODI4NCA5LjE3MTU3QzE1LjU3ODYgOS45MjE3MiAxNiAxMC45MzkxIDE2IDEyQzE2IDEzLjA2MDkgMTUuNTc4NiAxNC4wNzgzIDE0LjgyODQgMTQuODI4NEMxNC4wNzgzIDE1LjU3ODYgMTMuMDYwOSAxNiAxMiAxNkMxMC45MzkxIDE2IDkuOTIxNzIgMTUuNTc4NiA5LjE3MTU3IDE0LjgyODRDOC40MjE0MyAxNC4wNzgzIDggMTMuMDYwOSA4IDEyWk0xMiAxMEMxMS40Njk2IDEwIDEwLjk2MDkgMTAuMjEwNyAxMC41ODU4IDEwLjU4NThDMTAuMjEwNyAxMC45NjA5IDEwIDExLjQ2OTYgMTAgMTJDMTAgMTIuNTMwNCAxMC4yMTA3IDEzLjAzOTEgMTAuNTg1OCAxMy40MTQyQzEwLjk2MDkgMTMuNzg5MyAxMS40Njk2IDE0IDEyIDE0QzEyLjUzMDQgMTQgMTMuMDM5MSAxMy43ODkzIDEzLjQxNDIgMTMuNDE0MkMxMy43ODkzIDEzLjAzOTEgMTQgMTIuNTMwNCAxNCAxMkMxNCAxMS40Njk2IDEzLjc4OTMgMTAuOTYwOSAxMy40MTQyIDEwLjU4NThDMTMuMDM5MSAxMC4yMTA3IDEyLjUzMDQgMTAgMTIgMTBaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwIDIuMDAwMjRDMTEuMjM3NiAxLjI4NTcxIDEyLjc2MjQgMS4yODU3MSAxNCAyLjAwMDI0TDE5LjY2MDIgNS4yNjc4MkMyMC44OTc3IDUuOTgyMzYgMjEuNjYwMiA3LjMwMzY0IDIxLjY2MDIgOC43MzI2NlYxNS4yNjc4QzIxLjY2MDEgMTYuNjk2OCAyMC44OTc3IDE4LjAxODIgMTkuNjYwMiAxOC43MzI3TDE0IDIyLjAwMDJDMTIuNzYyNCAyMi43MTQ3IDExLjIzNzYgMjIuNzE0NyAxMCAyMi4wMDAyTDQuMzM5ODQgMTguNzMyN0MzLjEwMjMxIDE4LjAxODIgMi4zMzk5MyAxNi42OTY4IDIuMzM5ODQgMTUuMjY3OFY4LjczMjY2QzIuMzM5ODQgNy4zMDM2NCAzLjEwMjMgNS45ODIzNiA0LjMzOTg0IDUuMjY3ODJMMTAgMi4wMDAyNFpNMTMgMy43MzI2NkMxMi4zODEyIDMuMzc1MzkgMTEuNjE4OCAzLjM3NTM5IDExIDMuNzMyNjZMNS4zMzk4NCA3LjAwMDI0QzQuNzIxMSA3LjM1NzUyIDQuMzM5ODQgOC4wMTgxNyA0LjMzOTg0IDguNzMyNjZWMTUuMjY3OEM0LjMzOTkzIDE1Ljk4MjMgNC43MjExMSAxNi42NDMgNS4zMzk4NCAxNy4wMDAyTDExIDIwLjI2NzhDMTEuNjE4OCAyMC42MjUgMTIuMzgxMiAyMC42MjUgMTMgMjAuMjY3OEwxOC42NjAyIDE3LjAwMDJDMTkuMjc4OSAxNi42NDMgMTkuNjYwMSAxNS45ODIzIDE5LjY2MDIgMTUuMjY3OFY4LjczMjY2QzE5LjY2MDIgOC4wMTgxNyAxOS4yNzg5IDcuMzU3NTIgMTguNjYwMiA3LjAwMDI0TDEzIDMuNzMyNjZaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K",Ri=({x:e,y:t,type:n,isImageSticker:s,onClose:o,onAddSticker:i,onUploadImage:c,onToggleEditMode:u,isEditMode:I,onEditSticker:l,onDeleteSticker:M,onCopyImage:m,onCopyText:f,onExportImage:g,onExportImageSticker:d,onOpenSettings:D})=>{const{t:y}=Ke(),x=r.useRef(null),Y=r.useRef(!1),O=r.useCallback(()=>{Y.current||(Y.current=!0,x.current?Pe(x.current,200,()=>{o()}):o())},[o]);r.useEffect(()=>{Y.current=!1,x.current&&Xe(x.current)},[e,t]),r.useEffect(()=>{const U=p=>{p.button!==2&&x.current&&!x.current.contains(p.target)&&O()};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[O]),r.useEffect(()=>{const U=p=>p.preventDefault();return document.addEventListener("contextmenu",U),()=>document.removeEventListener("contextmenu",U)},[]);const P=180,F=n==="background"?180:200,E=10;let k=e,T=t;return e+P+E>window.innerWidth&&(k=window.innerWidth-P-E),k<E&&(k=E),t+F+E>window.innerHeight&&(T=window.innerHeight-F-E),T<E&&(T=E),Ye.createPortal(a.jsxs("div",{ref:x,className:b.contextMenu,style:{left:k,top:T},onClick:U=>U.stopPropagation(),children:[a.jsx("div",{className:b.menuLabel,children:"EclipseTab"}),a.jsx("div",{className:b.menuDivider}),a.jsx("div",{className:b.menuOptions,children:n==="background"?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:b.menuItem,onClick:()=>{i(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${ft})`,maskImage:`url(${ft})`}}),a.jsx("span",{children:y.contextMenu.addSticker})]}),a.jsxs("button",{className:b.menuItem,onClick:()=>{c(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${Ze})`,maskImage:`url(${Ze})`}}),a.jsx("span",{children:y.contextMenu.uploadImage})]}),a.jsxs("button",{className:b.menuItem,onClick:()=>{u(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${$e})`,maskImage:`url(${$e})`}}),a.jsx("span",{children:I?y.contextMenu.exitEditMode:y.contextMenu.editMode})]}),a.jsxs("button",{className:b.menuItem,onClick:()=>{D?.(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${mn})`,maskImage:`url(${mn})`}}),a.jsx("span",{children:y.contextMenu.settings})]})]}):a.jsxs(a.Fragment,{children:[s?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:b.menuItem,onClick:()=>{m?.(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${Qe})`,maskImage:`url(${Qe})`}}),a.jsx("span",{children:y.contextMenu.copyImage})]}),a.jsxs("button",{className:b.menuItem,onClick:()=>{d?.(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${Ze})`,maskImage:`url(${Ze})`}}),a.jsx("span",{children:y.contextMenu.exportImage})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:b.menuItem,onClick:()=>{f?.(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${Qe})`,maskImage:`url(${Qe})`}}),a.jsx("span",{children:y.contextMenu.copyText})]}),a.jsxs("button",{className:b.menuItem,onClick:()=>{l?.(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${qe})`,maskImage:`url(${qe})`}}),a.jsx("span",{children:y.contextMenu.editSticker})]}),a.jsxs("button",{className:b.menuItem,onClick:()=>{g?.(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${Ze})`,maskImage:`url(${Ze})`}}),a.jsx("span",{children:y.contextMenu.exportAsImage})]})]}),a.jsxs("button",{className:`${b.menuItem} ${b.danger}`,onClick:()=>{M?.(),o()},children:[a.jsx("span",{className:b.menuIcon,style:{WebkitMaskImage:`url(${Je})`,maskImage:`url(${Je})`}}),a.jsx("span",{children:y.contextMenu.deleteSticker})]})]})})]}),document.body)},Ui=({onOpenSettings:e})=>{const t=r.useRef(null),n=r.useRef(null),{stickers:s,selectedStickerId:o,addSticker:i,updateSticker:c,deleteSticker:u,selectSticker:I,bringToTop:l}=ka(),{isEditMode:M,setIsEditMode:m}=Ut(),[f,g]=r.useState(null),[d,D]=r.useState(null),y=1920,[x,Y]=r.useState(()=>window.innerWidth/y);r.useEffect(()=>{const p=()=>{Y(window.innerWidth/y)};return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const[O,P]=r.useState(null),F=["[data-dock-container]",".dock","header",'[class*="Searcher"]','[class*="Modal"]','[class*="Settings"]','[class*="Editor"]','[class*="FolderView"]','[class*="textInputPopup"]','[class*="contextMenu"]'].join(", ");r.useEffect(()=>{const p=N=>{const w=N.target;if(w.closest(F))return;const _=w.closest("[data-sticker-id]");if(_){N.preventDefault();const G=_.dataset.stickerId;G&&D({x:N.clientX,y:N.clientY,type:"sticker",stickerId:G});return}N.preventDefault(),D({x:N.clientX,y:N.clientY,type:"background"})};return document.addEventListener("contextmenu",p),()=>document.removeEventListener("contextmenu",p)},[s]),r.useEffect(()=>{const p=N=>{const w=N.target;w.closest(F)||w.closest("[data-sticker-id]")||f||g({x:N.clientX,y:N.clientY})};return document.addEventListener("dblclick",p),()=>document.removeEventListener("dblclick",p)},[f]),r.useEffect(()=>{const p=N=>{(N.key==="Delete"||N.key==="Backspace")&&o&&u(o)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[o,u]);const E=r.useCallback(async p=>{const N=p.target.files?.[0];if(!N)return;const w=new FileReader;w.onload=async()=>{const _=w.result,G=await Ht(_),S=new Image;S.onload=()=>{const z=(window.innerWidth/2-Math.min(S.width,nt)/2)/x,re=(window.innerHeight/2-S.height*Math.min(S.width,nt)/S.width/2)/x;i({type:"image",content:G,x:z,y:re})},S.src=G},w.readAsDataURL(N),n.current&&(n.current.value="")},[i]),k=r.useCallback((p,N)=>{O?c(O.id,{content:p,style:N?{color:N.color,textAlign:N.textAlign,fontSize:N.fontSize}:O.style}):f&&i({type:"text",content:p,x:f.x/x,y:f.y/x,style:N?{color:N.color,textAlign:N.textAlign,fontSize:N.fontSize}:void 0}),g(null),P(null)},[f,O,i,c]),T=r.useCallback(()=>{g(null),P(null)},[]),U=r.useCallback(p=>{P(p),g({x:p.x*x,y:p.y*x})},[x]);return r.useEffect(()=>{const p=async N=>{const w=document.activeElement;if((w?.tagName==="INPUT"||w?.tagName==="TEXTAREA")&&(w.closest('[class*="Searcher"]')||w.closest('[class*="textInputPopup"]')))return;const _=N.clipboardData?.items;if(_){for(const G of _)if(G.type.startsWith("image/")){N.preventDefault();const S=G.getAsFile();if(!S)continue;const z=new FileReader;z.onload=async()=>{const re=z.result,L=await Ht(re),R=new Image;R.onload=()=>{const B=(window.innerWidth/2-Math.min(R.width,nt)/2)/x,j=(window.innerHeight/2-R.height*Math.min(R.width,nt)/R.width/2)/x;i({type:"image",content:L,x:B,y:j})},R.src=L},z.readAsDataURL(S);break}}};return document.addEventListener("paste",p),()=>document.removeEventListener("paste",p)},[i]),a.jsxs("div",{ref:t,className:`${b.canvas} ${M?b.creativeMode:""}`,children:[s.filter(p=>!O||p.id!==O.id).map(p=>a.jsx(zi,{sticker:p,isSelected:o===p.id,isCreativeMode:M,onSelect:()=>I(p.id),onDelete:()=>u(p.id),onPositionChange:(N,w)=>c(p.id,{x:N,y:w}),onStyleChange:N=>{p.style&&c(p.id,{style:{...p.style,...N}})},onBringToTop:()=>l(p.id),onScaleChange:N=>{c(p.id,{scale:N})},isEditMode:M,viewportScale:x,onDoubleClick:()=>{p.type==="text"&&U(p)}},p.id)),f&&a.jsx(_i,{x:f.x,y:f.y,initialText:O?.content||"",initialStyle:O?.style,onSubmit:k,onCancel:T,viewportScale:x}),d&&a.jsx(Ri,{x:d.x,y:d.y,type:d.type,stickerId:d.stickerId,isImageSticker:(()=>s.find(N=>N.id===d.stickerId)?.type==="image")(),onClose:()=>D(null),onAddSticker:()=>{g({x:d.x,y:d.y})},onUploadImage:()=>{n.current?.click()},onToggleEditMode:()=>{m(!M)},isEditMode:M,onEditSticker:()=>{const p=s.find(N=>N.id===d.stickerId);p&&U(p)},onDeleteSticker:()=>{d.stickerId&&u(d.stickerId)},onCopyImage:async()=>{const p=s.find(N=>N.id===d.stickerId);if(p&&p.type==="image")try{const N=new Image;N.onload=async()=>{const w=await Sa(N);w&&await wa(w)},N.src=p.content}catch{}},onExportImage:async()=>{const p=s.find(N=>N.id===d.stickerId);if(p&&p.type==="text")try{const N=await ba(p);N&&cn(N,`sticker-${Date.now()}.png`)}catch{}},onCopyText:()=>{const p=s.find(N=>N.id===d.stickerId);p&&p.type==="text"&&navigator.clipboard.writeText(p.content)},onExportImageSticker:async()=>{const p=s.find(N=>N.id===d.stickerId);if(p&&p.type==="image")try{const N=await La(p);N&&cn(N,`sticker-${Date.now()}.png`)}catch{}},onOpenSettings:()=>{d&&e?.({x:d.x,y:d.y})}}),a.jsx("input",{ref:n,type:"file",accept:"image/*",style:{display:"none"},onChange:E})]})},Qi="_app_xy3ny_3",Yi="_container_xy3ny_15",Pi="_containerCenter_xy3ny_39",$i="_settingsArea_xy3ny_60",Fi="_editorArea_xy3ny_73",tt={app:Qi,container:Yi,containerCenter:Pi,settingsArea:$i,editorArea:Fi},Bi=r.lazy(()=>yt(()=>import("./FolderView-85c15c74.js"),["./FolderView-85c15c74.js","./vendor-react-d96b9a5d.js","./vendor-utils-654bd828.js","./FolderView-6ba4a8c1.css"],import.meta.url).then(e=>({default:e.FolderView}))),Wi=r.lazy(()=>yt(()=>import("./AddEditModal-59c29e38.js"),["./AddEditModal-59c29e38.js","./vendor-react-d96b9a5d.js","./vendor-utils-654bd828.js","./AddEditModal-0bb10ee4.css"],import.meta.url).then(e=>({default:e.AddEditModal}))),Gi=r.lazy(()=>yt(()=>import("./SearchEngineModal-3348b5ce.js"),["./SearchEngineModal-3348b5ce.js","./vendor-react-d96b9a5d.js","./vendor-utils-654bd828.js","./SearchEngineModal-a6441b00.css"],import.meta.url).then(e=>({default:e.SearchEngineModal}))),Zi=r.lazy(()=>yt(()=>import("./SettingsModal-4daef45c.js"),["./SettingsModal-4daef45c.js","./vendor-react-d96b9a5d.js","./vendor-utils-654bd828.js","./SettingsModal-551d4591.css"],import.meta.url).then(e=>({default:e.SettingsModal})));function Hi(){const{dockItems:e,selectedSearchEngine:t,setSelectedSearchEngine:n,handleItemDelete:s,handleItemSave:o,handleItemsReorder:i,handleFolderItemsReorder:c,handleFolderItemDelete:u,handleDragFromFolder:I,handleDragToFolder:l,handleDropOnFolder:M}=mr(),{isEditMode:m,openFolderId:f,folderAnchor:g,setIsEditMode:d,setOpenFolderId:D,setFolderAnchor:y}=Ut(),{draggingItem:x,setDraggingItem:Y,setFolderPlaceholderActive:O}=kn(),{dockPosition:P}=ot(),F=r.useMemo(()=>e.find(h=>h.id===f),[e,f]),E=r.useCallback((h,$)=>{h.type==="folder"?(D(h.id),y($??null)):h.url&&window.open(h.url,"_blank")},[D,y]),k=r.useCallback((h,$)=>{$.type==="folder"&&D($.id)},[D]),[T,U]=r.useState(!1),[p,N]=r.useState(!1),[w,_]=r.useState(!1),[G,S]=r.useState(null),[z,re]=r.useState(null),[L,R]=r.useState(null),[B,j]=r.useState(null),[Q,K]=r.useState(!1),[A,v]=r.useState(!1),[W,H]=r.useState(null),se=48,te=.5,[X,le]=r.useState(1);r.useLayoutEffect(()=>{const h=()=>{const $=window.innerWidth,J=(W??640)+se;if($>=J)le(1);else{const ee=Math.max(te,$/J);le(ee)}};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[W]);const[Me,ue]=r.useState(!1),De=r.useRef(null),pe=r.useRef(null);r.useEffect(()=>{const h=$=>{if(De.current){const Z=De.current.getBoundingClientRect(),J=$.clientX>=Z.left&&$.clientX<=Z.right&&$.clientY>=Z.top&&$.clientY<=Z.bottom;v(J)}if(pe.current){const Z=pe.current.getBoundingClientRect(),J=$.clientX>=Z.left&&$.clientX<=Z.right&&$.clientY>=Z.top&&$.clientY<=Z.bottom;K(J)}};return document.addEventListener("mousemove",h),()=>document.removeEventListener("mousemove",h)},[]);const xe=h=>{if(t.id==="default"){if(typeof chrome<"u"&&chrome.search&&chrome.search.query){chrome.search.query({text:h,disposition:"CURRENT_TAB"});return}window.open(`https://www.google.com/search?q=${encodeURIComponent(h)}`,"_blank");return}const $=`${t.url}${encodeURIComponent(h)}`;window.open($,"_blank")},Ce=(h,$)=>{j(h),R($??null),U(!0)},ke=()=>{j(null),U(!0)},V=h=>{o(h,B),U(!1),j(null)},C=r.useCallback(h=>{h.url&&window.open(h.url,"_blank")},[]),q=r.useCallback((h,$)=>{Ce(h,$)},[]);return r.useEffect(()=>{const h=()=>{const Z=getComputedStyle(document.documentElement).getPropertyValue("--color-sticker-stroke").trim(),J=document.querySelector("#text-sticker-stroke feFlood");J&&Z&&J.setAttribute("flood-color",Z)};h();const $=new MutationObserver(Z=>{Z.forEach(J=>{J.type==="attributes"&&J.attributeName==="data-theme"&&h()})});return $.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>$.disconnect()},[]),a.jsxs("div",{className:tt.app,children:[a.jsx("svg",{width:"0",height:"0",style:{position:"absolute",visibility:"hidden"},children:a.jsx("defs",{children:a.jsxs("filter",{id:"text-sticker-stroke",x:"-25%",y:"-25%",width:"150%",height:"150%",children:[a.jsx("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"4.5",result:"dilated"}),a.jsx("feGaussianBlur",{in:"dilated",stdDeviation:"2",result:"blurred"}),a.jsx("feComponentTransfer",{in:"blurred",result:"rounded",children:a.jsx("feFuncA",{type:"table",tableValues:"0 0 0.5 1 1 1 1 1"})}),a.jsx("feFlood",{floodColor:"white",result:"white"}),a.jsx("feComposite",{in:"white",in2:"rounded",operator:"in",result:"stroke"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"stroke"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})})}),a.jsx(Ta,{}),a.jsx(Ui,{onOpenSettings:h=>{re({left:h.x,top:h.y,right:h.x,bottom:h.y,width:0,height:0,x:h.x,y:h.y,toJSON:()=>({})}),_(!0)}}),a.jsxs("div",{className:P==="center"?tt.containerCenter:tt.container,"data-ui-zone":"bottom",style:X<1?{transform:P==="center"?`translate(-50%, -50%) scale(${X})`:`translate(-50%, -100%) scale(${X})`,transformOrigin:P==="center"?"center center":"bottom center"}:void 0,children:[a.jsx(as,{searchEngine:t,onSearch:xe,onSearchEngineClick:h=>{S(h),N(!0)},containerStyle:W?{width:`${W}px`}:void 0}),a.jsx(ga,{items:e,isEditMode:m,onItemClick:E,onItemEdit:Ce,onItemDelete:s,onItemAdd:h=>{R(h??null),ke()},onItemsReorder:i,onDropToFolder:M,onDragToOpenFolder:l,onHoverOpenFolder:k,onLongPressEdit:()=>d(!0),onWidthChange:h=>H(h),onDragStart:h=>Y(h),onDragEnd:()=>Y(null),externalDragItem:x})]}),a.jsx("div",{ref:De,className:tt.settingsArea,"data-ui-zone":"top-left",children:a.jsx(ya,{visible:A,onClick:h=>{h.stopPropagation();const $=h.currentTarget.getBoundingClientRect();re($),_(!0)}})}),a.jsx("div",{ref:pe,className:tt.editorArea,"data-ui-zone":"top-right",children:a.jsx(ma,{visible:Q||m,isEditMode:m,onClick:()=>d(!m)})}),F&&F.type==="folder"&&a.jsx(r.Suspense,{fallback:null,children:a.jsx(Bi,{folder:F,isEditMode:m,onItemClick:C,onItemEdit:q,onItemDelete:h=>u(F.id,h),onClose:()=>{D(null),y(null)},onItemsReorder:h=>c(F.id,h),onItemDragOut:I,anchorRect:g,onDragStart:h=>{Y(h),ue(!0)},onDragEnd:()=>{Y(null),ue(!1)},externalDragItem:Me?null:x,onFolderPlaceholderChange:O,onToggleEditMode:()=>d(!m)})}),T&&a.jsx(r.Suspense,{fallback:null,children:a.jsx(Wi,{isOpen:T,item:B,onClose:()=>{U(!1),j(null)},onSave:V,anchorRect:L,hideHeader:!0})}),a.jsx(r.Suspense,{fallback:null,children:a.jsx(Gi,{isOpen:p,selectedEngine:t,engines:xn,onClose:()=>N(!1),onSelect:n,anchorRect:G})}),w&&a.jsx(r.Suspense,{fallback:null,children:a.jsx(Zi,{isOpen:w,onClose:()=>_(!1),anchorPosition:z?{x:z.left,y:z.top<100?z.top+60:z.top}:{x:0,y:0}})})]})}bt.createRoot(document.getElementById("root")).render(a.jsx(_r,{children:a.jsx(Ir,{children:a.jsx(fr,{children:a.jsx(Ca,{children:a.jsx(es,{children:a.jsx(Hi,{})})})})})}));export{On as D,sn as E,ec as F,Ar as G,It as H,ro as M,Le as S,wn as T,rc as a,vo as b,ac as c,sc as d,nc as e,Oo as f,Zs as g,To as h,tc as i,a as j,Ao as k,Pe as l,Ke as m,st as n,_n as o,Ji as p,zt as q,oc as r,Xe as s,Ki as t,Ro as u,Tr as v,Dr as w};
