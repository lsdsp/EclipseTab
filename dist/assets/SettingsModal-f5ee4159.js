import{u as W,a as $,r as i,R as A,j as e,b as P,s as B,c as G,G as D}from"./main-5b93f245.js";const L="_backdrop_16dr9_7",E="_modal_16dr9_23",F="_innerContainer_16dr9_51",z="_iconContainer_16dr9_79",X="_defaultTheme_16dr9_97",V="_defaultThemeActive_16dr9_139",q="_themeGroupContainer_16dr9_151",M="_highlightBackground_16dr9_177",H="_themeGroupOption_16dr9_203",J="_textureOption_16dr9_237",K="_wallpaperUploadBtn_16dr9_239",Q="_textureSectionWrapper_16dr9_251",Y="_textureSectionWrapperOpen_16dr9_281",Z="_textureSection_16dr9_251",ee="_textureOptionActive_16dr9_369",te="_texturePreviewNone_16dr9_381",ne="_texturePreviewImage_16dr9_399",ae="_colorOptionsContainer_16dr9_415",re="_colorOption_16dr9_415",le="_colorOptionActive_16dr9_473",oe="_wallpaperSection_16dr9_487",ie="_disabled_16dr9_507",se="_hidden_16dr9_521",ce="_error_16dr9_531",t={backdrop:L,modal:E,innerContainer:F,iconContainer:z,defaultTheme:X,defaultThemeActive:V,themeGroupContainer:q,highlightBackground:M,themeGroupOption:H,textureOption:J,wallpaperUploadBtn:K,textureSectionWrapper:Q,textureSectionWrapperOpen:Y,textureSection:Z,textureOptionActive:ee,texturePreviewNone:te,texturePreviewImage:ne,colorOptionsContainer:ae,colorOption:re,colorOptionActive:le,wallpaperSection:oe,disabled:ie,hidden:se,error:ce},de=""+new URL("Point Texture Preview-17565573.svg",import.meta.url).href,ue=""+new URL("X Texture Preview-2004a0f7.svg",import.meta.url).href,pe=""+new URL("star3-ef948816.svg",import.meta.url).href,me=""+new URL("sun-a529e1f6.svg",import.meta.url).href,he=""+new URL("moon-cd98c44e.svg",import.meta.url).href,_e=""+new URL("monitor-b828c770.svg",import.meta.url).href,xe=""+new URL("slash-f0692e0a.svg",import.meta.url).href,fe=""+new URL("asterisk-d84f7b04.svg",import.meta.url).href,ge="_gridContainer_1wzd1_1",ve="_uploadBtn_1wzd1_23",we="_uploading_1wzd1_57",je="_pulse_1wzd1_1",Ce="_thumbnail_1wzd1_69",Se="_active_1wzd1_101",Te="_image_1wzd1_111",Ne="_deleteBtn_1wzd1_123",h={gridContainer:ge,uploadBtn:ve,uploading:we,pulse:je,thumbnail:Ce,active:Se,image:Te,deleteBtn:Ne},ke=""+new URL("wallpaper-04f00454.svg",import.meta.url).href,ye=""+new URL("close-664899ff.svg",import.meta.url).href,be=()=>{const{wallpaperId:o,setWallpaperId:k,uploadWallpaper:S,setWallpaper:_}=W(),{getRecentWallpapers:y,createWallpaperUrl:c,deleteWallpaper:T}=$(),[v,b]=i.useState([]),[w,d]=i.useState({}),[u,x]=i.useState(!1),f=A.useRef(null),s=async()=>{const n=await y();b(n);const r={};n.forEach(l=>{r[l.id]=c(l.thumbnail||l.data)}),d(r)};i.useEffect(()=>{s()},[]);const j=()=>{var n;(n=f.current)==null||n.click()},p=async n=>{var l;const r=(l=n.target.files)==null?void 0:l[0];if(r){x(!0);try{await S(r),await s()}catch(O){console.error("Upload failed:",O)}finally{x(!1),f.current&&(f.current.value="")}}},m=async n=>{n!==o&&await k(n)},C=async(n,r)=>{n.stopPropagation();try{await T(r),r===o&&_(null),await s()}catch(l){console.error("Delete failed:",l)}};return e.jsxs("div",{className:h.gridContainer,children:[e.jsxs("div",{className:`${h.uploadBtn} ${u?h.uploading:""}`,onClick:j,title:"Upload Wallpaper",children:[e.jsx("input",{ref:f,type:"file",accept:"image/*",onChange:p,style:{display:"none"}}),e.jsx("img",{src:ke,alt:"Upload",width:24,height:24})]}),v.map(n=>e.jsxs("div",{className:`${h.thumbnail} ${n.id===o?h.active:""}`,onClick:()=>m(n.id),title:new Date(n.createdAt).toLocaleDateString(),children:[w[n.id]&&e.jsx("img",{src:w[n.id],alt:"Wallpaper",className:h.image}),e.jsx("button",{className:h.deleteBtn,onClick:r=>C(r,n.id),title:"Delete",children:e.jsx("img",{src:ye,alt:"Delete",width:10,height:10})})]},n.id))]})},Ie=({isOpen:o,onClose:k,anchorPosition:S})=>{const{theme:_,setTheme:y,followSystem:c,setFollowSystem:T,wallpaper:v,setWallpaper:b,gradientId:w,setGradientId:d,texture:u,setTexture:x}=W(),f=P(),[s,j]=i.useState(o),p=i.useRef(null),m=_==="default"&&!c;if(i.useEffect(()=>{m&&u!=="none"&&x("none")},[m,u,x]),i.useEffect(()=>{o&&j(!0)},[o]),i.useEffect(()=>{o&&s&&p.current&&B(p.current)},[o,s]),i.useEffect(()=>{!o&&s&&(p.current?G(p.current,300,()=>j(!1)):j(!1))},[o,s]),!s)return null;const C=a=>{y(a),a==="default"&&d("theme-default"),c&&T(!1)},n=()=>{T(!c)},r=a=>{if(v){b(null),d(a);return}w===a?(d(a==="theme-default"?"gradient-1":"theme-default"),requestAnimationFrame(()=>{d(a)})):d(a)},l=a=>{x(a)},O={left:`${S.x}px`,top:`${S.y+60}px`};let g=-1;c?g=2:_==="light"?g=0:_==="dark"&&(g=1);const R={transform:g>=0?`translateX(${g*56}px)`:"scale(0)",opacity:g>=0?1:0};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t.backdrop,onClick:k}),e.jsx("div",{ref:p,className:t.modal,style:O,children:e.jsxs("div",{className:t.innerContainer,children:[e.jsxs("div",{className:t.iconContainer,children:[e.jsx("button",{className:`${t.defaultTheme} ${m?t.defaultThemeActive:""}`,onClick:()=>C("default"),title:"Default Theme",children:e.jsx("img",{src:pe,alt:"Default Theme",width:24,height:24})}),e.jsxs("div",{className:t.themeGroupContainer,children:[e.jsx("div",{className:t.highlightBackground,style:R}),e.jsx("button",{className:t.themeGroupOption,onClick:()=>C("light"),title:"Light Theme",children:e.jsx("img",{src:me,alt:"Light Theme",width:24,height:24})}),e.jsx("button",{className:t.themeGroupOption,onClick:()=>C("dark"),title:"Dark Theme",children:e.jsx("img",{src:he,alt:"Dark Theme",width:24,height:24})}),e.jsx("button",{className:t.themeGroupOption,onClick:n,title:"Follow System",children:e.jsx("img",{src:_e,alt:"Follow System",width:24,height:24})})]})]}),e.jsx("div",{className:`${t.textureSectionWrapper} ${!m&&!v?t.textureSectionWrapperOpen:""}`,children:e.jsxs("div",{className:t.textureSection,children:[e.jsx("button",{className:`${t.textureOption} ${u==="none"?t.textureOptionActive:""}`,onClick:()=>l("none"),title:"No Texture",children:e.jsx("div",{className:t.texturePreviewNone,children:e.jsx("img",{src:xe,alt:"No Texture",width:24,height:24})})}),e.jsx("button",{className:`${t.textureOption} ${u==="point"?t.textureOptionActive:""}`,onClick:()=>l("point"),title:"Point Texture",children:e.jsx("img",{src:de,alt:"Point Texture",className:t.texturePreviewImage})}),e.jsx("button",{className:`${t.textureOption} ${u==="x"?t.textureOptionActive:""}`,onClick:()=>l("x"),title:"X Texture",children:e.jsx("img",{src:ue,alt:"X Texture",className:t.texturePreviewImage})})]})}),e.jsx("div",{className:t.colorOptionsContainer,children:D.map(a=>{let N="";const I=a.id==="theme-default";I?N="var(--color-bg-secondary)":N=m?a.gradient:a.solid;const U=!v&&w===a.id;return e.jsx("button",{className:`${t.colorOption} ${U?t.colorOptionActive:""}`,onClick:()=>r(a.id),title:a.name,style:{background:N,display:"flex",alignItems:"center",justifyContent:"center"},children:I&&e.jsx("img",{src:fe,alt:"Default",width:24,height:24,style:{filter:_==="dark"||c&&f==="dark"?"invert(1)":"none"}})},a.id)})}),e.jsx("div",{className:t.wallpaperSection,children:e.jsx(be,{})})]})})]})};export{Ie as SettingsModal};
